<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.57" />
    <meta name="theme" content="VuePress Theme Hope" />
    <title>MySQL è¿›é˜¶ç¯‡ | Java æˆç¥ä¹‹è·¯</title><meta name="description" content="è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ª VuePress ç«™ç‚¹">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-72ee67ce.css" as="style" /><link rel="stylesheet" href="/assets/style-72ee67ce.css" />
    <link rel="modulepreload" href="/assets/app-c593f505.js"><link rel="modulepreload" href="/assets/framework-4ec38622.js"><link rel="modulepreload" href="/assets/mysql-advance.html-b6faea43.js"><link rel="modulepreload" href="/assets/mysql-advance.html-79a57a00.js"><link rel="prefetch" href="/assets/index.html-4e1da2c4.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-alibaba-seate.html-df701e40.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-overview.html-94372eca.js" as="script" /><link rel="prefetch" href="/assets/gitbook.html-432908fc.js" as="script" /><link rel="prefetch" href="/assets/mysql-apply.html-e0982e6c.js" as="script" /><link rel="prefetch" href="/assets/mysql-base.html-15774da0.js" as="script" /><link rel="prefetch" href="/assets/mysql-devops.html-5cee1349.js" as="script" /><link rel="prefetch" href="/assets/redis-base.html-e17677ed.js" as="script" /><link rel="prefetch" href="/assets/redis-cluster.html-8712f49e.js" as="script" /><link rel="prefetch" href="/assets/redis-overview.html-1fca9f7e.js" as="script" /><link rel="prefetch" href="/assets/java-base.html-ca97d2c7.js" as="script" /><link rel="prefetch" href="/assets/java-sql.html-bbe6c4c2.js" as="script" /><link rel="prefetch" href="/assets/java-time.html-ce7c9496.js" as="script" /><link rel="prefetch" href="/assets/java-collection-list.html-8bbef8fd.js" as="script" /><link rel="prefetch" href="/assets/java-collection-map.html-9ee599cf.js" as="script" /><link rel="prefetch" href="/assets/java-collection-overview.html-31570b40.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-base.html-2e26c5a1.js" as="script" /><link rel="prefetch" href="/assets/Java-concurrent-container.html-e5f75933.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-interview.html-d289133d.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-lock.html-cbd95e38.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-pool.html-a9ecee05.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-tools.html-76151b53.js" as="script" /><link rel="prefetch" href="/assets/java-bio.html-d706ae9b.js" as="script" /><link rel="prefetch" href="/assets/java-io-base.html-bb263882.js" as="script" /><link rel="prefetch" href="/assets/java-nio.html-2de47e3f.js" as="script" /><link rel="prefetch" href="/assets/Javaå†…å­˜æ¨¡å‹.html-0e76463e.js" as="script" /><link rel="prefetch" href="/assets/JVMå†…å­˜ç»“æ„.html-b17bcef0.js" as="script" /><link rel="prefetch" href="/assets/JVMåƒåœ¾å›æ”¶.html-ee219a34.js" as="script" /><link rel="prefetch" href="/assets/JVMæ¦‚è§ˆ.html-b4ce8fc6.js" as="script" /><link rel="prefetch" href="/assets/JVMç±»åŠ è½½å™¨.html-dd7f5a89.js" as="script" /><link rel="prefetch" href="/assets/JVMç±»æ–‡ä»¶ç»“æ„.html-8859cd08.js" as="script" /><link rel="prefetch" href="/assets/JVMè°ƒä¼˜.html-0d15b1ba.js" as="script" /><link rel="prefetch" href="/assets/java-servlet.html-c7a54ede.js" as="script" /><link rel="prefetch" href="/assets/java-lambda.html-56b847d2.js" as="script" /><link rel="prefetch" href="/assets/java-stream.html-6167e062.js" as="script" /><link rel="prefetch" href="/assets/HikariCP-base.html-f5a4e8e5.js" as="script" /><link rel="prefetch" href="/assets/HikariCP-source.html-7a2f3fac.js" as="script" /><link rel="prefetch" href="/assets/jackson-overview.html-57cfb768.js" as="script" /><link rel="prefetch" href="/assets/kafka-broker.html-a30f3377.js" as="script" /><link rel="prefetch" href="/assets/kafka-consumer.html-2a1327ac.js" as="script" /><link rel="prefetch" href="/assets/kafka-overview.html-698972bc.js" as="script" /><link rel="prefetch" href="/assets/kafka-producer.html-579ce0f8.js" as="script" /><link rel="prefetch" href="/assets/spring-kafka.html-b1a1e4d1.js" as="script" /><link rel="prefetch" href="/assets/log-framework.html-98a12691.js" as="script" /><link rel="prefetch" href="/assets/1.Hello World.html-4b77eac1.js" as="script" /><link rel="prefetch" href="/assets/2.Global Config.html-bd544474.js" as="script" /><link rel="prefetch" href="/assets/index.html-905c3f62.js" as="script" /><link rel="prefetch" href="/assets/sharding-sphere.html-a30db686.js" as="script" /><link rel="prefetch" href="/assets/shiro-overview.html-fa31ba73.js" as="script" /><link rel="prefetch" href="/assets/tomcat.html-4ad2c770.js" as="script" /><link rel="prefetch" href="/assets/data-structure-list.html-17b01002.js" as="script" /><link rel="prefetch" href="/assets/data-structure-overview.html-44ed6838.js" as="script" /><link rel="prefetch" href="/assets/data-structure-tree.html-c806dd3b.js" as="script" /><link rel="prefetch" href="/assets/design-adapter.html-0e9d816d.js" as="script" /><link rel="prefetch" href="/assets/design-chain.html-bb17cabc.js" as="script" /><link rel="prefetch" href="/assets/design-composite.html-1d475fbf.js" as="script" /><link rel="prefetch" href="/assets/design-decorator.html-4f27f10a.js" as="script" /><link rel="prefetch" href="/assets/design-overview.html-0a940fb3.js" as="script" /><link rel="prefetch" href="/assets/design-proxy.html-100e60b2.js" as="script" /><link rel="prefetch" href="/assets/design-strategy.html-a2df8a49.js" as="script" /><link rel="prefetch" href="/assets/æ»‘åŠ¨çª—å£.html-86771022.js" as="script" /><link rel="prefetch" href="/assets/linux-overview.html-2bd9af93.js" as="script" /><link rel="prefetch" href="/assets/encoding.html-304390cc.js" as="script" /><link rel="prefetch" href="/assets/encryption-algorithm.html-fb0becaa.js" as="script" /><link rel="prefetch" href="/assets/temp.html-ac4ce374.js" as="script" /><link rel="prefetch" href="/assets/BeanPostProcessor-base.html-c6481b26.js" as="script" /><link rel="prefetch" href="/assets/BeanPostProcessor-ConfigurationClassPostProcessor.html-ba0c8ae7.js" as="script" /><link rel="prefetch" href="/assets/spring-source-overview.html-9371e343.js" as="script" /><link rel="prefetch" href="/assets/spring-boot-condition.html-a415267e.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-commons-base.html-f75ee2c9.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-gateway.html-03291875.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-loadbalancer.html-ccdc0547.js" as="script" /><link rel="prefetch" href="/assets/nacos-client-discovery.html-17a81d03.js" as="script" /><link rel="prefetch" href="/assets/nacos-overview.html-539b7085.js" as="script" /><link rel="prefetch" href="/assets/cloud-openfeign-action.html-7761387f.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-openfeign.html-10212321.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-ribbon.html-8669a44d.js" as="script" /><link rel="prefetch" href="/assets/sentinel-source.html-dc297934.js" as="script" /><link rel="prefetch" href="/assets/git.html-cb7e5449.js" as="script" /><link rel="prefetch" href="/assets/gitlab.html-eb2126d8.js" as="script" /><link rel="prefetch" href="/assets/junit4.html-6c786952.js" as="script" /><link rel="prefetch" href="/assets/junit5.html-e36d7d70.js" as="script" /><link rel="prefetch" href="/assets/maven.html-e0151a0f.js" as="script" /><link rel="prefetch" href="/assets/reactor.html-cd44ff8d.js" as="script" /><link rel="prefetch" href="/assets/spring-source-web-init.html-b8105d34.js" as="script" /><link rel="prefetch" href="/assets/spring-source-web-listener.html-7b8c6479.js" as="script" /><link rel="prefetch" href="/assets/404.html-f04ced3e.js" as="script" /><link rel="prefetch" href="/assets/index.html-62ca9f14.js" as="script" /><link rel="prefetch" href="/assets/index.html-fc52137e.js" as="script" /><link rel="prefetch" href="/assets/index.html-ee301928.js" as="script" /><link rel="prefetch" href="/assets/index.html-d0c5f0f0.js" as="script" /><link rel="prefetch" href="/assets/index.html-25bcd8c4.js" as="script" /><link rel="prefetch" href="/assets/index.html-37f2094a.js" as="script" /><link rel="prefetch" href="/assets/index.html-50de9de4.js" as="script" /><link rel="prefetch" href="/assets/index.html-a6bbb2fe.js" as="script" /><link rel="prefetch" href="/assets/index.html-afe963e2.js" as="script" /><link rel="prefetch" href="/assets/index.html-e1231d43.js" as="script" /><link rel="prefetch" href="/assets/index.html-c4d07d46.js" as="script" /><link rel="prefetch" href="/assets/index.html-19c8c7e9.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-alibaba-seate.html-b5da756c.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-overview.html-ff9b794b.js" as="script" /><link rel="prefetch" href="/assets/gitbook.html-5a50abf0.js" as="script" /><link rel="prefetch" href="/assets/mysql-apply.html-b76d628d.js" as="script" /><link rel="prefetch" href="/assets/mysql-base.html-95625c2f.js" as="script" /><link rel="prefetch" href="/assets/mysql-devops.html-74e24111.js" as="script" /><link rel="prefetch" href="/assets/redis-base.html-0c64fcd1.js" as="script" /><link rel="prefetch" href="/assets/redis-cluster.html-d9e53ddd.js" as="script" /><link rel="prefetch" href="/assets/redis-overview.html-d8ed14d9.js" as="script" /><link rel="prefetch" href="/assets/java-base.html-bb254e89.js" as="script" /><link rel="prefetch" href="/assets/java-sql.html-98f87090.js" as="script" /><link rel="prefetch" href="/assets/java-time.html-1149c2e2.js" as="script" /><link rel="prefetch" href="/assets/java-collection-list.html-dcb82f95.js" as="script" /><link rel="prefetch" href="/assets/java-collection-map.html-20b29455.js" as="script" /><link rel="prefetch" href="/assets/java-collection-overview.html-0153adc1.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-base.html-4092d51f.js" as="script" /><link rel="prefetch" href="/assets/Java-concurrent-container.html-f22d5109.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-interview.html-02742a0a.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-lock.html-41872812.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-pool.html-b7de958e.js" as="script" /><link rel="prefetch" href="/assets/java-concurrent-tools.html-b9ad45db.js" as="script" /><link rel="prefetch" href="/assets/java-bio.html-a5769212.js" as="script" /><link rel="prefetch" href="/assets/java-io-base.html-e3ef5e77.js" as="script" /><link rel="prefetch" href="/assets/java-nio.html-a3fa4765.js" as="script" /><link rel="prefetch" href="/assets/Javaå†…å­˜æ¨¡å‹.html-087adb9d.js" as="script" /><link rel="prefetch" href="/assets/JVMå†…å­˜ç»“æ„.html-4bc916e1.js" as="script" /><link rel="prefetch" href="/assets/JVMåƒåœ¾å›æ”¶.html-c6e0e3e0.js" as="script" /><link rel="prefetch" href="/assets/JVMæ¦‚è§ˆ.html-435f6ec8.js" as="script" /><link rel="prefetch" href="/assets/JVMç±»åŠ è½½å™¨.html-0c7f8931.js" as="script" /><link rel="prefetch" href="/assets/JVMç±»æ–‡ä»¶ç»“æ„.html-5afd6d1d.js" as="script" /><link rel="prefetch" href="/assets/JVMè°ƒä¼˜.html-9a1a4154.js" as="script" /><link rel="prefetch" href="/assets/java-servlet.html-f9646dd1.js" as="script" /><link rel="prefetch" href="/assets/java-lambda.html-1db83529.js" as="script" /><link rel="prefetch" href="/assets/java-stream.html-8b490468.js" as="script" /><link rel="prefetch" href="/assets/HikariCP-base.html-d01cd368.js" as="script" /><link rel="prefetch" href="/assets/HikariCP-source.html-27512376.js" as="script" /><link rel="prefetch" href="/assets/jackson-overview.html-ccca046f.js" as="script" /><link rel="prefetch" href="/assets/kafka-broker.html-7cc959b4.js" as="script" /><link rel="prefetch" href="/assets/kafka-consumer.html-35141192.js" as="script" /><link rel="prefetch" href="/assets/kafka-overview.html-b243daf8.js" as="script" /><link rel="prefetch" href="/assets/kafka-producer.html-93a69d00.js" as="script" /><link rel="prefetch" href="/assets/spring-kafka.html-0032d80c.js" as="script" /><link rel="prefetch" href="/assets/log-framework.html-5769500e.js" as="script" /><link rel="prefetch" href="/assets/1.Hello World.html-78e7fc50.js" as="script" /><link rel="prefetch" href="/assets/2.Global Config.html-d3157ebb.js" as="script" /><link rel="prefetch" href="/assets/index.html-44ddef87.js" as="script" /><link rel="prefetch" href="/assets/sharding-sphere.html-2e54e4df.js" as="script" /><link rel="prefetch" href="/assets/shiro-overview.html-e44b2286.js" as="script" /><link rel="prefetch" href="/assets/tomcat.html-653f98cd.js" as="script" /><link rel="prefetch" href="/assets/data-structure-list.html-420dc821.js" as="script" /><link rel="prefetch" href="/assets/data-structure-overview.html-e227421d.js" as="script" /><link rel="prefetch" href="/assets/data-structure-tree.html-752ceeb1.js" as="script" /><link rel="prefetch" href="/assets/design-adapter.html-41aa7652.js" as="script" /><link rel="prefetch" href="/assets/design-chain.html-8685e4e6.js" as="script" /><link rel="prefetch" href="/assets/design-composite.html-4375b033.js" as="script" /><link rel="prefetch" href="/assets/design-decorator.html-2b2ae807.js" as="script" /><link rel="prefetch" href="/assets/design-overview.html-300948fd.js" as="script" /><link rel="prefetch" href="/assets/design-proxy.html-e1813076.js" as="script" /><link rel="prefetch" href="/assets/design-strategy.html-a31637dd.js" as="script" /><link rel="prefetch" href="/assets/æ»‘åŠ¨çª—å£.html-ae330cc5.js" as="script" /><link rel="prefetch" href="/assets/linux-overview.html-8ac20a5d.js" as="script" /><link rel="prefetch" href="/assets/encoding.html-f8e7f158.js" as="script" /><link rel="prefetch" href="/assets/encryption-algorithm.html-bfb3dc64.js" as="script" /><link rel="prefetch" href="/assets/temp.html-ec342781.js" as="script" /><link rel="prefetch" href="/assets/BeanPostProcessor-base.html-a44c5c69.js" as="script" /><link rel="prefetch" href="/assets/BeanPostProcessor-ConfigurationClassPostProcessor.html-edba8ecd.js" as="script" /><link rel="prefetch" href="/assets/spring-source-overview.html-576738e8.js" as="script" /><link rel="prefetch" href="/assets/spring-boot-condition.html-b4e4df1a.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-commons-base.html-39238198.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-gateway.html-7a4e7b1f.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-loadbalancer.html-7a202164.js" as="script" /><link rel="prefetch" href="/assets/nacos-client-discovery.html-1f7ae7f3.js" as="script" /><link rel="prefetch" href="/assets/nacos-overview.html-43d7250d.js" as="script" /><link rel="prefetch" href="/assets/cloud-openfeign-action.html-7559bcf7.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-openfeign.html-47e8c26d.js" as="script" /><link rel="prefetch" href="/assets/spring-cloud-ribbon.html-a27e5c44.js" as="script" /><link rel="prefetch" href="/assets/sentinel-source.html-dc357213.js" as="script" /><link rel="prefetch" href="/assets/git.html-eefdc275.js" as="script" /><link rel="prefetch" href="/assets/gitlab.html-65555382.js" as="script" /><link rel="prefetch" href="/assets/junit4.html-c35363b6.js" as="script" /><link rel="prefetch" href="/assets/junit5.html-bdf5716e.js" as="script" /><link rel="prefetch" href="/assets/maven.html-7c434596.js" as="script" /><link rel="prefetch" href="/assets/reactor.html-f20890c4.js" as="script" /><link rel="prefetch" href="/assets/spring-source-web-init.html-27ad7747.js" as="script" /><link rel="prefetch" href="/assets/spring-source-web-listener.html-2166addd.js" as="script" /><link rel="prefetch" href="/assets/404.html-46b6c18e.js" as="script" /><link rel="prefetch" href="/assets/index.html-ed68d2be.js" as="script" /><link rel="prefetch" href="/assets/index.html-398e9a2c.js" as="script" /><link rel="prefetch" href="/assets/index.html-902245d5.js" as="script" /><link rel="prefetch" href="/assets/index.html-93ba03a9.js" as="script" /><link rel="prefetch" href="/assets/index.html-70956359.js" as="script" /><link rel="prefetch" href="/assets/index.html-f0a732cd.js" as="script" /><link rel="prefetch" href="/assets/index.html-3344b751.js" as="script" /><link rel="prefetch" href="/assets/index.html-6d2a3ffd.js" as="script" /><link rel="prefetch" href="/assets/index.html-a5787a89.js" as="script" /><link rel="prefetch" href="/assets/index.html-440f50d2.js" as="script" /><link rel="prefetch" href="/assets/index.html-a7274cc8.js" as="script" /><link rel="prefetch" href="/assets/clientConfigs-bdea5ab7.js" as="script" /><link rel="prefetch" href="/assets/clientConfigs-bdea5ab7.js" as="script" />
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><!----><!----><span class="site-name">Java æˆç¥ä¹‹è·¯</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Java ç¬”è®°"><span class="title"><!---->Java ç¬”è®°</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java åŸºç¡€</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/java-base/java-base.html" class="nav-link" aria-label="Java åŸºç¡€çŸ¥è¯†"><!---->Java åŸºç¡€çŸ¥è¯†<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java IO</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/java-io/java-io-base.html" class="nav-link" aria-label="Java IO åŸºç¡€çŸ¥è¯†"><!---->Java IO åŸºç¡€çŸ¥è¯†<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java é›†åˆ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/java-collection/java-collection-overview.html" class="nav-link" aria-label="Java é›†åˆæ¦‚è§ˆ"><!---->Java é›†åˆæ¦‚è§ˆ<!----></a></li><li class="dropdown-subitem"><a href="/java/java-collection/java-collection-list.html" class="nav-link" aria-label="Java Listé›†åˆ"><!---->Java Listé›†åˆ<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java å¹¶å‘</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/java-concurrent/java-concurrent-base.html" class="nav-link" aria-label="Java å¹¶å‘åŸºç¡€"><!---->Java å¹¶å‘åŸºç¡€<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>JVM è¯¦è§£</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/java-jvm/JVM%E6%A6%82%E8%A7%88.html" class="nav-link" aria-label="JVMæ¦‚è§ˆ"><!---->JVMæ¦‚è§ˆ<!----></a></li><li class="dropdown-subitem"><a href="/java/java-jvm/JVM%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84.html" class="nav-link" aria-label="JVMå†…å­˜ç»“æ„"><!---->JVMå†…å­˜ç»“æ„<!----></a></li><li class="dropdown-subitem"><a href="/java/java-jvm/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6.html" class="nav-link" aria-label="JVMåƒåœ¾å›æ”¶"><!---->JVMåƒåœ¾å›æ”¶<!----></a></li><li class="dropdown-subitem"><a href="/java/java-jvm/JVM%E7%B1%BB%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84.html" class="nav-link" aria-label="JVMç±»æ–‡ä»¶ç»“æ„"><!---->JVMç±»æ–‡ä»¶ç»“æ„<!----></a></li><li class="dropdown-subitem"><a href="/java/java-jvm/JVM%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8.html" class="nav-link" aria-label="JVMç±»åŠ è½½å™¨"><!---->JVMç±»åŠ è½½å™¨<!----></a></li><li class="dropdown-subitem"><a href="/java/java-jvm/JVMå†…å­˜æ¨¡å‹.html" class="nav-link" aria-label="Javaå†…å­˜æ¨¡å‹"><!---->Javaå†…å­˜æ¨¡å‹<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Spring ç¬”è®°"><span class="title"><!---->Spring ç¬”è®°</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring IOC</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/test02.html" class="nav-link" aria-label="Spring IOCè¯¦è§£"><!---->Spring IOCè¯¦è§£<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring åç½®å¤„ç†å™¨è§£æ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/spring/spring-bean-post-processor/BeanPostProcessor-base.html" class="nav-link" aria-label="Spring åç½®å¤„ç†å™¨æ€»è§ˆ"><!---->Spring åç½®å¤„ç†å™¨æ€»è§ˆ<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Spring Cloud"><span class="title"><!---->Spring Cloud</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/spring-cloud/spring-cloud-overview.html" class="nav-link" aria-label="Spring Cloud Overview"><!---->Spring Cloud Overview<!----></a></li><li class="dropdown-item"><a href="/spring-cloud/spring-cloud-alibaba-nacos.md" class="nav-link" aria-label="Spring Cloud Nacos"><!---->Spring Cloud Nacos<!----></a></li><li class="dropdown-item"><a href="/spring-cloud/spring-cloud-alibaba-sentinel.md" class="nav-link" aria-label="Spring Cloud Sentinel"><!---->Spring Cloud Sentinel<!----></a></li><li class="dropdown-item"><a href="/spring-cloud/spring-cloud-alibaba-seate.html" class="nav-link" aria-label="Spring Cloud Seate"><!---->Spring Cloud Seate<!----></a></li><li class="dropdown-item"><a href="/spring-cloud/spring-cloud-ribbon/spring-cloud-ribbon.html" class="nav-link" aria-label="Spring Cloud Ribbon"><!---->Spring Cloud Ribbon<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ•°æ®åº“"><span class="title"><!---->æ•°æ®åº“</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>MySQL</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/database/mysql/mysql-base.html" class="nav-link" aria-label="MySQL åŸºç¡€ç¯‡"><!---->MySQL åŸºç¡€ç¯‡<!----></a></li><li class="dropdown-subitem"><a aria-current="page" href="/database/mysql/mysql-advance.html" class="router-link-active router-link-exact-active nav-link active" aria-label="MySQL è¿›é˜¶ç¯‡"><!---->MySQL è¿›é˜¶ç¯‡<!----></a></li><li class="dropdown-subitem"><a href="/database/mysql/mysql-devops.html" class="nav-link" aria-label="MySQL è¿ç»´ç¯‡"><!---->MySQL è¿ç»´ç¯‡<!----></a></li><li class="dropdown-subitem"><a href="/database/mysql/mysql-apply.html" class="nav-link" aria-label="MySQL åº”ç”¨ç¯‡"><!---->MySQL åº”ç”¨ç¯‡<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è‡ªæˆ‘ä¿®å…»"><span class="title"><!---->è‡ªæˆ‘ä¿®å…»</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/quality/design-mode/design-overview.html" class="nav-link" aria-label="è®¾è®¡æ¨¡å¼"><!---->è®¾è®¡æ¨¡å¼<!----></a></li><li class="dropdown-item"><a href="/quality/data-structure/data-structure-overview.html" class="nav-link" aria-label="æ•°æ®ç»“æ„"><!---->æ•°æ®ç»“æ„<!----></a></li><li class="dropdown-item"><a href="/quality/linux/linux-overview.html" class="nav-link" aria-label="Linux æ€»ç»“"><!---->Linux æ€»ç»“<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ä¸­é—´ä»¶"><span class="title"><!---->ä¸­é—´ä»¶</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/middleware/tomcat/tomcat.html" class="nav-link" aria-label="Tomcat ä¸“é¢˜"><!---->Tomcat ä¸“é¢˜<!----></a></li><li class="dropdown-item"><a href="/middleware/kafka/kafka-overview.html" class="nav-link" aria-label="Kafka ä¸“é¢˜"><!---->Kafka ä¸“é¢˜<!----></a></li><li class="dropdown-item"><a href="/middleware/redis/redis-overview.md" class="nav-link" aria-label="Redis ä¸“é¢˜"><!---->Redis ä¸“é¢˜<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å·¥å…·åŒ…"><span class="title"><!---->å·¥å…·åŒ…</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Junit æµ‹è¯•æ¡†æ¶</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tools/junit/junit5.html" class="nav-link" aria-label="Junit 5 ä½¿ç”¨æ€»ç»“"><!---->Junit 5 ä½¿ç”¨æ€»ç»“<!----></a></li></ul></li><li class="dropdown-item"><a href="/tools/log/log-framework.md" class="nav-link" aria-label="Java æ—¥å¿—æ¡†æ¶"><!---->Java æ—¥å¿—æ¡†æ¶<!----></a></li><li class="dropdown-item"><a href="/tools/maven/maven.html" class="nav-link" aria-label="Maven ä½¿ç”¨å…¥é—¨"><!---->Maven ä½¿ç”¨å…¥é—¨<!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading active"><!----><span class="title">MySQL</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/database/mysql/mysql-base.html" class="nav-link sidebar-link sidebar-page" aria-label="MySQL åŸºç¡€ç¯‡"><!---->MySQL åŸºç¡€ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/database/mysql/mysql-advance.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="MySQL è¿›é˜¶ç¯‡"><!---->MySQL è¿›é˜¶ç¯‡<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-å­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿›é˜¶ç¯‡-å­˜å‚¨å¼•æ“"><!---->è¿›é˜¶ç¯‡-å­˜å‚¨å¼•æ“<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#mysqlä½“ç³»ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="MySQLä½“ç³»ç»“æ„"><!---->MySQLä½“ç³»ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#mysqlå­˜å‚¨å¼•æ“ä»‹ç»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="MySQLå­˜å‚¨å¼•æ“ä»‹ç»"><!---->MySQLå­˜å‚¨å¼•æ“ä»‹ç»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#å­˜å‚¨å¼•æ“çš„ç‰¹ç‚¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å­˜å‚¨å¼•æ“çš„ç‰¹ç‚¹"><!---->å­˜å‚¨å¼•æ“çš„ç‰¹ç‚¹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#å­˜å‚¨å¼•æ“çš„é€‰æ‹©" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å­˜å‚¨å¼•æ“çš„é€‰æ‹©"><!---->å­˜å‚¨å¼•æ“çš„é€‰æ‹©<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-ç´¢å¼•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿›é˜¶ç¯‡-ç´¢å¼•"><!---->è¿›é˜¶ç¯‡-ç´¢å¼•<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç´¢å¼•ç»“æ„"><!---->ç´¢å¼•ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•åˆ†ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç´¢å¼•åˆ†ç±»"><!---->ç´¢å¼•åˆ†ç±»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•è¯­æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç´¢å¼•è¯­æ³•"><!---->ç´¢å¼•è¯­æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#sqlæ€§èƒ½åˆ†æ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SQLæ€§èƒ½åˆ†æ"><!---->SQLæ€§èƒ½åˆ†æ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•ä½¿ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç´¢å¼•ä½¿ç”¨"><!---->ç´¢å¼•ä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•è®¾è®¡åŸåˆ™" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç´¢å¼•è®¾è®¡åŸåˆ™"><!---->ç´¢å¼•è®¾è®¡åŸåˆ™<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-sqlä¼˜åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿›é˜¶ç¯‡-SQLä¼˜åŒ–"><!---->è¿›é˜¶ç¯‡-SQLä¼˜åŒ–<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#æ’å…¥æ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ’å…¥æ•°æ®"><!---->æ’å…¥æ•°æ®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#å¤§æ‰¹é‡æ’å…¥æ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¤§æ‰¹é‡æ’å…¥æ•°æ®"><!---->å¤§æ‰¹é‡æ’å…¥æ•°æ®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#ä¸»é”®ä¼˜åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸»é”®ä¼˜åŒ–"><!---->ä¸»é”®ä¼˜åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#order-by-ä¼˜åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="order by ä¼˜åŒ–"><!---->order by ä¼˜åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#group-by-ä¼˜åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="group by ä¼˜åŒ–"><!---->group by ä¼˜åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#limitä¼˜åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="limitä¼˜åŒ–"><!---->limitä¼˜åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#countä¼˜åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="countä¼˜åŒ–"><!---->countä¼˜åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#updateä¼˜åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="updateä¼˜åŒ–"><!---->updateä¼˜åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-è§†å›¾-å­˜å‚¨-è§¦å‘å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿›é˜¶ç¯‡-è§†å›¾/å­˜å‚¨/è§¦å‘å™¨"><!---->è¿›é˜¶ç¯‡-è§†å›¾/å­˜å‚¨/è§¦å‘å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-é”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿›é˜¶ç¯‡-é”"><!---->è¿›é˜¶ç¯‡-é”<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#å…¨å±€é”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…¨å±€é”"><!---->å…¨å±€é”<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¡¨çº§é”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¡¨çº§é”"><!---->è¡¨çº§é”<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¡Œçº§é”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¡Œçº§é”"><!---->è¡Œçº§é”<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#é—´éš™é”-ä¸´é”®é”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é—´éš™é”&amp;ä¸´é”®é”"><!---->é—´éš™é”&amp;ä¸´é”®é”<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-innodbå¼•æ“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿›é˜¶ç¯‡-InnoDBå¼•æ“"><!---->è¿›é˜¶ç¯‡-InnoDBå¼•æ“<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#é€»è¾‘å­˜å‚¨ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é€»è¾‘å­˜å‚¨ç»“æ„"><!---->é€»è¾‘å­˜å‚¨ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#æ¶æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¶æ„"><!---->æ¶æ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#äº‹åŠ¡åŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="äº‹åŠ¡åŸç†"><!---->äº‹åŠ¡åŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#mvcc" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="MVCC"><!---->MVCC<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-mysqlç®¡ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿›é˜¶ç¯‡-MySQLç®¡ç†"><!---->è¿›é˜¶ç¯‡-MySQLç®¡ç†<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç³»ç»Ÿæ•°æ®åº“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç³»ç»Ÿæ•°æ®åº“"><!---->ç³»ç»Ÿæ•°æ®åº“<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/database/mysql/mysql-advance.html#å¸¸ç”¨å·¥å…·" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¸¸ç”¨å·¥å…·"><!---->å¸¸ç”¨å·¥å…·<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/database/mysql/mysql-devops.html" class="nav-link sidebar-link sidebar-page" aria-label="MySQL è¿ç»´ç¯‡"><!---->MySQL è¿ç»´ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/database/mysql/mysql-apply.html" class="nav-link sidebar-link sidebar-page" aria-label="MySQL åº”ç”¨ç¯‡"><!---->MySQL åº”ç”¨ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->MySQL è¿›é˜¶ç¯‡</h1><div class="page-info"><!----><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-05-18T01:27:36.000Z"></span><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 86 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT86M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-å­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level2">è¿›é˜¶ç¯‡-å­˜å‚¨å¼•æ“</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#mysqlä½“ç³»ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">MySQLä½“ç³»ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#mysqlå­˜å‚¨å¼•æ“ä»‹ç»" class="router-link-active router-link-exact-active toc-link level3">MySQLå­˜å‚¨å¼•æ“ä»‹ç»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#å­˜å‚¨å¼•æ“çš„ç‰¹ç‚¹" class="router-link-active router-link-exact-active toc-link level3">å­˜å‚¨å¼•æ“çš„ç‰¹ç‚¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#å­˜å‚¨å¼•æ“çš„é€‰æ‹©" class="router-link-active router-link-exact-active toc-link level3">å­˜å‚¨å¼•æ“çš„é€‰æ‹©</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level2">è¿›é˜¶ç¯‡-ç´¢å¼•</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">ç´¢å¼•ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•åˆ†ç±»" class="router-link-active router-link-exact-active toc-link level3">ç´¢å¼•åˆ†ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•è¯­æ³•" class="router-link-active router-link-exact-active toc-link level3">ç´¢å¼•è¯­æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#sqlæ€§èƒ½åˆ†æ" class="router-link-active router-link-exact-active toc-link level3">SQLæ€§èƒ½åˆ†æ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level3">ç´¢å¼•ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç´¢å¼•è®¾è®¡åŸåˆ™" class="router-link-active router-link-exact-active toc-link level3">ç´¢å¼•è®¾è®¡åŸåˆ™</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-sqlä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level2">è¿›é˜¶ç¯‡-SQLä¼˜åŒ–</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#æ’å…¥æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">æ’å…¥æ•°æ®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#å¤§æ‰¹é‡æ’å…¥æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">å¤§æ‰¹é‡æ’å…¥æ•°æ®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#ä¸»é”®ä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level3">ä¸»é”®ä¼˜åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#order-by-ä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level3">order by ä¼˜åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#group-by-ä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level3">group by ä¼˜åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#limitä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level3">limitä¼˜åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#countä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level3">countä¼˜åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#updateä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level3">updateä¼˜åŒ–</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-è§†å›¾-å­˜å‚¨-è§¦å‘å™¨" class="router-link-active router-link-exact-active toc-link level2">è¿›é˜¶ç¯‡-è§†å›¾/å­˜å‚¨/è§¦å‘å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-é”" class="router-link-active router-link-exact-active toc-link level2">è¿›é˜¶ç¯‡-é”</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#å…¨å±€é”" class="router-link-active router-link-exact-active toc-link level3">å…¨å±€é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¡¨çº§é”" class="router-link-active router-link-exact-active toc-link level3">è¡¨çº§é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¡Œçº§é”" class="router-link-active router-link-exact-active toc-link level3">è¡Œçº§é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#é—´éš™é”-ä¸´é”®é”" class="router-link-active router-link-exact-active toc-link level3">é—´éš™é”&amp;ä¸´é”®é”</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-innodbå¼•æ“" class="router-link-active router-link-exact-active toc-link level2">è¿›é˜¶ç¯‡-InnoDBå¼•æ“</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#é€»è¾‘å­˜å‚¨ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">é€»è¾‘å­˜å‚¨ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#æ¶æ„" class="router-link-active router-link-exact-active toc-link level3">æ¶æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#äº‹åŠ¡åŸç†" class="router-link-active router-link-exact-active toc-link level3">äº‹åŠ¡åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#mvcc" class="router-link-active router-link-exact-active toc-link level3">MVCC</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#è¿›é˜¶ç¯‡-mysqlç®¡ç†" class="router-link-active router-link-exact-active toc-link level2">è¿›é˜¶ç¯‡-MySQLç®¡ç†</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#ç³»ç»Ÿæ•°æ®åº“" class="router-link-active router-link-exact-active toc-link level3">ç³»ç»Ÿæ•°æ®åº“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/database/mysql/mysql-advance.html#å¸¸ç”¨å·¥å…·" class="router-link-active router-link-exact-active toc-link level3">å¸¸ç”¨å·¥å…·</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="mysql-è¿›é˜¶ç¯‡" tabindex="-1"><a class="header-anchor" href="#mysql-è¿›é˜¶ç¯‡" aria-hidden="true">#</a> MySQL è¿›é˜¶ç¯‡</h1><h2 id="è¿›é˜¶ç¯‡-å­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶ç¯‡-å­˜å‚¨å¼•æ“" aria-hidden="true">#</a> è¿›é˜¶ç¯‡-å­˜å‚¨å¼•æ“</h2><h3 id="mysqlä½“ç³»ç»“æ„" tabindex="-1"><a class="header-anchor" href="#mysqlä½“ç³»ç»“æ„" aria-hidden="true">#</a> MySQLä½“ç³»ç»“æ„</h3><img src="/assets/image-20220426093437386-a03fbceb.png" alt="image-20220426093437386" style="zoom:50%;"><ul><li>è¿æ¥å±‚</li></ul><p>æœ€ä¸Šå±‚æ˜¯ä¸€äº›å®¢æˆ·ç«¯å’Œé“¾æ¥æœåŠ¡ï¼ŒåŒ…å«æœ¬åœ°sock é€šä¿¡å’Œå¤§å¤šæ•°åŸºäºå®¢æˆ·ç«¯/æœåŠ¡ç«¯å·¥å…·å®ç°çš„ç±»ä¼¼äºTCP/IPçš„é€šä¿¡ã€‚ä¸»è¦å®Œæˆä¸€äº›ç±»ä¼¼äºè¿æ¥å¤„ç†ã€æˆæƒè®¤è¯ã€åŠç›¸å…³çš„å®‰å…¨æ–¹æ¡ˆã€‚åœ¨è¯¥å±‚ä¸Šå¼•å…¥äº†çº¿ç¨‹æ± çš„æ¦‚å¿µï¼Œä¸ºé€šè¿‡è®¤è¯å®‰å…¨æ¥å…¥çš„å®¢æˆ·ç«¯æä¾›çº¿ç¨‹ã€‚åŒæ ·åœ¨è¯¥å±‚ä¸Šå¯ä»¥å®ç°åŸºäºSSLçš„å®‰å…¨é“¾æ¥ã€‚æœåŠ¡å™¨ä¹Ÿä¼šä¸ºå®‰å…¨æ¥å…¥çš„æ¯ä¸ªå®¢æˆ·ç«¯éªŒè¯å®ƒæ‰€å…·æœ‰çš„æ“ä½œæƒé™ã€‚</p><ul><li>æœåŠ¡å±‚</li></ul><p>ç¬¬äºŒå±‚æ¶æ„ä¸»è¦å®Œæˆå¤§å¤šæ•°çš„æ ¸å¿ƒæœåŠ¡åŠŸèƒ½ï¼Œå¦‚SQLæ¥å£ï¼Œå¹¶å®Œæˆç¼“å­˜çš„æŸ¥è¯¢ï¼ŒSQLçš„åˆ†æå’Œä¼˜åŒ–ï¼Œéƒ¨åˆ†å†…ç½®å‡½æ•°çš„æ‰§è¡Œã€‚æ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½ä¹Ÿåœ¨è¿™ä¸€å±‚å®ç°ï¼Œå¦‚ è¿‡ç¨‹ã€å‡½æ•°ç­‰ã€‚åœ¨è¯¥å±‚ï¼ŒæœåŠ¡å™¨ä¼šè§£ææŸ¥è¯¢å¹¶åˆ›å»ºç›¸åº”çš„å†…éƒ¨è§£ææ ‘ï¼Œå¹¶å¯¹å…¶å®Œæˆç›¸åº”çš„ä¼˜åŒ–å¦‚ç¡®å®šè¡¨çš„æŸ¥è¯¢çš„é¡ºåºï¼Œæ˜¯å¦åˆ©ç”¨ç´¢å¼•ç­‰ï¼Œæœ€åç”Ÿæˆç›¸åº”çš„æ‰§è¡Œæ“ä½œã€‚å¦‚æœæ˜¯selectè¯­å¥ï¼ŒæœåŠ¡å™¨è¿˜ä¼šæŸ¥è¯¢å†…éƒ¨çš„ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜ç©ºé—´è¶³å¤Ÿå¤§ï¼Œè¿™æ ·åœ¨è§£å†³å¤§é‡è¯»æ“ä½œçš„ç¯å¢ƒä¸­èƒ½å¤Ÿå¾ˆå¥½çš„æå‡ç³»ç»Ÿçš„æ€§èƒ½ã€‚</p><ul><li>å¼•æ“å±‚</li></ul><p>å­˜å‚¨å¼•æ“å±‚ï¼Œ å­˜å‚¨å¼•æ“çœŸæ­£çš„è´Ÿè´£äº†MySQLä¸­æ•°æ®çš„å­˜å‚¨å’Œæå–ï¼ŒæœåŠ¡å™¨é€šè¿‡APIå’Œå­˜å‚¨å¼•æ“è¿›è¡Œé€šä¿¡ã€‚ä¸åŒçš„å­˜å‚¨å¼•æ“å…·æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦ï¼Œæ¥é€‰å–åˆé€‚çš„å­˜å‚¨å¼•æ“ã€‚æ•°æ®åº“ä¸­çš„ç´¢å¼•æ˜¯åœ¨å­˜å‚¨å¼•æ“å±‚å®ç°çš„ã€‚</p><ul><li>å­˜å‚¨å±‚</li></ul><p>æ•°æ®å­˜å‚¨å±‚ï¼Œ ä¸»è¦æ˜¯å°†æ•°æ®(å¦‚: redologã€undologã€æ•°æ®ã€ç´¢å¼•ã€äºŒè¿›åˆ¶æ—¥å¿—ã€é”™è¯¯æ—¥å¿—ã€æŸ¥è¯¢æ—¥å¿—ã€æ…¢æŸ¥è¯¢æ—¥å¿—ç­‰)å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼Œå¹¶å®Œæˆä¸å­˜å‚¨å¼•æ“çš„äº¤äº’ã€‚</p><h3 id="mysqlå­˜å‚¨å¼•æ“ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#mysqlå­˜å‚¨å¼•æ“ä»‹ç»" aria-hidden="true">#</a> MySQLå­˜å‚¨å¼•æ“ä»‹ç»</h3><p>å­˜å‚¨å¼•æ“å°±æ˜¯å­˜å‚¨æ•°æ®ã€å»ºç«‹ç´¢å¼•ã€æ›´æ–°/æŸ¥è¯¢æ•°æ®ç­‰æŠ€æœ¯çš„å®ç°æ–¹å¼ ã€‚å­˜å‚¨å¼•æ“æ˜¯åŸºäºè¡¨çš„ï¼Œè€Œä¸æ˜¯åŸºäºåº“çš„ï¼Œæ‰€ä»¥å­˜å‚¨å¼•æ“ä¹Ÿå¯è¢«ç§°ä¸ºè¡¨ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œæ¥æŒ‡å®šé€‰æ‹©çš„å­˜å‚¨å¼•æ“ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šå°†è‡ªåŠ¨é€‰æ‹©é»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚MySQL5.5ä¹‹å‰çš„é»˜è®¤å­˜å‚¨å¼•æ“æ˜¯MyISAMï¼Œ5.5ä¹‹åæ”¹ä¸ºäº†InnoDBã€‚</p><p>æŸ¥è¯¢å½“å‰æ•°æ®åº“æ”¯æŒçš„å­˜å‚¨å¼•æ“</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">show</span> engines<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åˆ›å»ºè¡¨æ—¶æŒ‡å®šå­˜å‚¨å¼•æ“</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> name<span class="token punctuation">(</span> 
	å­—æ®µ<span class="token number">1</span> å­—æ®µ<span class="token number">1</span>ç±»å‹ <span class="token punctuation">[</span> <span class="token keyword">COMMENT</span> å­—æ®µ<span class="token number">1</span>æ³¨é‡Š <span class="token punctuation">]</span> <span class="token punctuation">,</span> 
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
	å­—æ®µn å­—æ®µnç±»å‹ <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> å­—æ®µnæ³¨é‡Š <span class="token punctuation">]</span> 
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">INNODB</span> <span class="token punctuation">[</span> <span class="token keyword">COMMENT</span> è¡¨æ³¨é‡Š <span class="token punctuation">]</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å­˜å‚¨å¼•æ“çš„ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#å­˜å‚¨å¼•æ“çš„ç‰¹ç‚¹" aria-hidden="true">#</a> å­˜å‚¨å¼•æ“çš„ç‰¹ç‚¹</h3><p>å¸¸ç”¨å­˜å‚¨å¼•æ“çš„å¯¹æ¯”</p><table><thead><tr><th>ç‰¹ç‚¹</th><th>MyISAM</th><th>InnoDB</th><th>MEMORY</th><th>MERGE</th><th>NDB</th></tr></thead><tbody><tr><td>å­˜å‚¨é™åˆ¶</td><td>æœ‰</td><td>64TB</td><td>æœ‰</td><td>æ²¡æœ‰</td><td>æœ‰</td></tr><tr><td>äº‹åŠ¡å®‰å…¨</td><td></td><td>æ”¯æŒ</td><td></td><td></td><td></td></tr><tr><td>é”æœºåˆ¶</td><td>è¡¨é”</td><td>è¡Œé”</td><td>è¡¨é”</td><td>è¡¨é”</td><td>è¡Œé”</td></tr><tr><td>Bæ ‘ç´¢å¼•</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>å“ˆå¸Œç´¢å¼•</td><td></td><td></td><td>æ”¯æŒ</td><td></td><td>æ”¯æŒ</td></tr><tr><td>å…¨æ–‡ç´¢å¼•</td><td>æ”¯æŒ</td><td></td><td></td><td></td><td></td></tr><tr><td>é›†ç¾¤ç´¢å¼•</td><td></td><td>æ”¯æŒ</td><td></td><td></td><td></td></tr><tr><td>æ•°æ®ç¼“å­˜</td><td></td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td></td><td>æ”¯æŒ</td></tr><tr><td>ç´¢å¼•ç¼“å­˜</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>æ•°æ®å¯å‹ç¼©</td><td>æ”¯æŒ</td><td></td><td></td><td></td><td></td></tr><tr><td>ç©ºé—´ä½¿ç”¨</td><td>ä½</td><td>é«˜</td><td>N/A</td><td>ä½</td><td>ä½</td></tr><tr><td>å†…å­˜ä½¿ç”¨</td><td>ä½</td><td>é«˜</td><td>ä¸­ç™»</td><td>ä½</td><td>é«˜</td></tr><tr><td>æ‰¹é‡æ’å…¥çš„é€Ÿåº¦</td><td>é«˜</td><td>ä½</td><td>é«˜</td><td>é«˜</td><td>é«˜</td></tr><tr><td>æ”¯æŒå¤–é”®</td><td></td><td>æ”¯æŒ</td><td></td><td></td><td></td></tr></tbody></table><h4 id="innodb" tabindex="-1"><a class="header-anchor" href="#innodb" aria-hidden="true">#</a> InnoDB</h4><p>InnoDBæ˜¯ä¸€ç§å…¼é¡¾é«˜å¯é æ€§å’Œé«˜æ€§èƒ½çš„é€šç”¨å­˜å‚¨å¼•æ“ï¼Œåœ¨ MySQL 5.5 ä¹‹åï¼ŒInnoDBæ˜¯é»˜è®¤çš„MySQL å­˜å‚¨å¼•æ“ã€‚</p><h5 id="ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#ç‰¹ç‚¹" aria-hidden="true">#</a> <strong>ç‰¹ç‚¹</strong></h5><ul><li><p>DMLæ“ä½œéµå¾ªACIDæ¨¡å‹ï¼Œæ”¯æŒäº‹åŠ¡ï¼›</p></li><li><p>è¡Œçº§é”ï¼Œæé«˜å¹¶å‘è®¿é—®æ€§èƒ½ï¼›</p></li><li><p>æ”¯æŒå¤–é”®FOREIGN KEYçº¦æŸï¼Œä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œæ­£ç¡®æ€§ï¼›</p></li><li><p>auto_increment è‡ªå¢åˆ—</p></li></ul><h5 id="auto-increment" tabindex="-1"><a class="header-anchor" href="#auto-increment" aria-hidden="true">#</a> AUTO_INCREMENT</h5><p>è‡ªå¢çš„å€¼é»˜è®¤ä»1å¼€å§‹ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‡å®šè¯¥å€¼ï¼Œä½†æŒ‡å®šçš„å€¼æ˜¯ç©ºæˆ–è€…0ï¼Œåˆ™æ‰§è¡Œè‡ªå¢çš„é€»è¾‘ã€‚</p><p>å¯ä»¥ä¿®æ”¹è‡ªå¢çš„åˆå§‹å€¼<code>ALERT TABLE *** AUTO_INCREMENT = n</code>ï¼Œä½†æ˜¯è¿™ä¸ªå€¼æ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­çš„ã€‚é‡å¯åä¼šå¤±æ•ˆã€‚</p><p>åœ¨InnoDBç±»å‹çš„è¡¨ä¸­ï¼Œè‡ªå¢åˆ—å¿…é¡»æ˜¯ç´¢å¼•åˆ—ï¼Œå¦‚æœæ˜¯ç»„åˆç´¢å¼•ï¼Œä¹Ÿå¿…é¡»æ˜¯ç»„åˆç´¢å¼•çš„ç¬¬ä¸€åˆ—ã€‚</p><h5 id="å­˜å‚¨æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#å­˜å‚¨æ–¹å¼" aria-hidden="true">#</a> <strong>å­˜å‚¨æ–¹å¼</strong></h5><p>xxx.ibdï¼šxxxä»£è¡¨çš„æ˜¯è¡¨åï¼ŒinnoDBå¼•æ“çš„æ¯å¼ è¡¨éƒ½ä¼šå¯¹åº”è¿™æ ·ä¸€ä¸ªè¡¨ç©ºé—´æ–‡ä»¶ï¼Œå­˜å‚¨è¯¥è¡¨çš„è¡¨ç»“æ„ï¼ˆfrm-æ—©æœŸçš„ ã€sdi-æ–°ç‰ˆçš„ï¼‰ã€æ•°æ®å’Œç´¢å¼•ã€‚</p><p>å‚æ•°ï¼šinnodb_file_per_table</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>show variables like &#39;innodb_file_per_table&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426095518142-c4c13a30.png" alt="image-20220426095518142" style="zoom:50%;"><p>å¦‚æœè¯¥å‚æ•°å¼€å¯ï¼Œä»£è¡¨å¯¹äºInnoDBå¼•æ“çš„è¡¨ï¼Œæ¯ä¸€å¼ è¡¨éƒ½å¯¹åº”ä¸€ä¸ªibdæ–‡ä»¶ã€‚ æˆ‘ä»¬ç›´æ¥æ‰“å¼€MySQLçš„æ•°æ®å­˜æ”¾ç›®å½•ï¼š C:\ProgramData\MySQL\MySQL Server 8.0\Data ï¼Œ è¿™ä¸ªç›®å½•ä¸‹æœ‰å¾ˆå¤šæ–‡ä»¶å¤¹ï¼Œä¸åŒçš„æ–‡ä»¶å¤¹ä»£è¡¨ä¸åŒçš„æ•°æ®åº“ï¼Œæˆ‘ä»¬ç›´æ¥æ‰“å¼€itcastæ–‡ä»¶å¤¹ã€‚</p><img src="/assets/image-20220426095639059-c6fe43b7.png" alt="image-20220426095639059" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰å¾ˆå¤šçš„ibdæ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªibdæ–‡ä»¶å°±å¯¹åº”ä¸€å¼ è¡¨ï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬æœ‰ä¸€å¼ è¡¨ accountï¼Œå°±æœ‰è¿™æ ·çš„ä¸€ä¸ªaccount.ibdæ–‡ä»¶ï¼Œè€Œåœ¨è¿™ä¸ªibdæ–‡ä»¶ä¸­ä¸ä»…å­˜æ”¾è¡¨ç»“æ„ã€æ•°æ®ï¼Œè¿˜ä¼šå­˜æ”¾è¯¥è¡¨å¯¹åº”çš„ç´¢å¼•ä¿¡æ¯ã€‚ è€Œè¯¥æ–‡ä»¶æ˜¯åŸºäºäºŒè¿›åˆ¶å­˜å‚¨çš„ï¼Œä¸èƒ½ç›´æ¥åŸºäºè®°äº‹æœ¬æ‰“å¼€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨mysqlæä¾›çš„ä¸€ä¸ªæŒ‡ä»¤ ibd2sdi ï¼Œé€šè¿‡è¯¥æŒ‡ä»¤å°±å¯ä»¥ä»ibdæ–‡ä»¶ä¸­æå–sdiä¿¡æ¯ï¼Œè€Œsdiæ•°æ®å­—å…¸ä¿¡æ¯ä¸­å°±åŒ…å«è¯¥è¡¨çš„è¡¨ç»“æ„ã€‚</p><p>æ•°æ®å­˜å‚¨é€»è¾‘å›¾</p><p><img src="/assets/image-20220426095957217-5e470c58.png" alt="image-20220426095957217"></p><ul><li><p><strong>è¡¨ç©ºé—´ :</strong> InnoDBå­˜å‚¨å¼•æ“é€»è¾‘ç»“æ„çš„æœ€é«˜å±‚ï¼Œibdæ–‡ä»¶å…¶å®å°±æ˜¯è¡¨ç©ºé—´æ–‡ä»¶ï¼Œåœ¨è¡¨ç©ºé—´ä¸­å¯ä»¥åŒ…å«å¤šä¸ªSegmentæ®µã€‚</p></li><li><p><strong>æ®µ :</strong> è¡¨ç©ºé—´æ˜¯ç”±å„ä¸ªæ®µç»„æˆçš„ï¼Œ å¸¸è§çš„æ®µæœ‰æ•°æ®æ®µã€ç´¢å¼•æ®µã€å›æ»šæ®µç­‰ã€‚InnoDBä¸­å¯¹äºæ®µçš„ç®¡ç†ï¼Œéƒ½æ˜¯å¼•æ“è‡ªèº«å®Œæˆï¼Œä¸éœ€è¦äººä¸ºå¯¹å…¶æ§åˆ¶ï¼Œä¸€ä¸ªæ®µä¸­åŒ…å«å¤šä¸ªåŒºã€‚</p></li><li><p><strong>åŒº :</strong> åŒºæ˜¯è¡¨ç©ºé—´çš„å•å…ƒç»“æ„ï¼Œæ¯ä¸ªåŒºçš„å¤§å°ä¸º1Mã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œ InnoDBå­˜å‚¨å¼•æ“é¡µå¤§å°ä¸º16Kï¼Œ å³ä¸€ä¸ªåŒºä¸­ä¸€å…±æœ‰64ä¸ªè¿ç»­çš„é¡µã€‚</p></li><li><p><strong>é¡µ :</strong> é¡µæ˜¯ç»„æˆåŒºçš„æœ€å°å•å…ƒï¼Œé¡µä¹Ÿæ˜¯InnoDBå­˜å‚¨å¼•æ“ç£ç›˜ç®¡ç†çš„æœ€å°å•å…ƒï¼Œæ¯ä¸ªé¡µçš„å¤§å°é»˜è®¤ä¸º 16KBã€‚ä¸ºäº†ä¿è¯é¡µçš„è¿ç»­æ€§ï¼ŒInnoDB å­˜å‚¨å¼•æ“æ¯æ¬¡ä»ç£ç›˜ç”³è¯· 4-5 ä¸ªåŒºã€‚</p></li><li><p><strong>è¡Œ :</strong> InnoDB å­˜å‚¨å¼•æ“æ˜¯é¢å‘è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®æ˜¯æŒ‰è¡Œè¿›è¡Œå­˜æ”¾çš„ï¼Œåœ¨æ¯ä¸€è¡Œä¸­é™¤äº†å®šä¹‰è¡¨æ—¶æ‰€æŒ‡å®šçš„å­—æ®µä»¥å¤–ï¼Œè¿˜åŒ…å«ä¸¤ä¸ªéšè—å­—æ®µ</p></li></ul><h4 id="myisam" tabindex="-1"><a class="header-anchor" href="#myisam" aria-hidden="true">#</a> <strong>MyISAM</strong></h4><p>MyISAMæ˜¯MySQLæ—©æœŸçš„é»˜è®¤å­˜å‚¨å¼•æ“ã€‚</p><h5 id="ç‰¹ç‚¹-1" tabindex="-1"><a class="header-anchor" href="#ç‰¹ç‚¹-1" aria-hidden="true">#</a> ç‰¹ç‚¹</h5><p>ä¸æ”¯æŒäº‹åŠ¡ï¼Œä¸æ”¯æŒå¤–é”®ã€‚æ”¯æŒè¡¨é”ï¼Œä¸æ”¯æŒè¡Œé”</p><p>è®¿é—®é€Ÿåº¦å¿«ï¼Œå¯¹äº‹ç‰©æ²¡æœ‰å®Œæ•´æ€§æ²¡æœ‰è¦æ±‚çš„å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¼•æ“æ¥åˆ›å»ºè¡¨ã€‚</p><h5 id="å­˜å‚¨æ–‡ä»¶ç»“æ„" tabindex="-1"><a class="header-anchor" href="#å­˜å‚¨æ–‡ä»¶ç»“æ„" aria-hidden="true">#</a> å­˜å‚¨æ–‡ä»¶ç»“æ„</h5><p>æ¯ä¸ªMyISAMå¼•æ“ç±»å‹çš„è¡¨åœ¨ç£ç›˜ä¸Šå­˜å‚¨æˆ3ä¸ªæ–‡ä»¶ï¼Œå…¨ç§°å¦‚ä¸‹ï¼š</p><ul><li><p>xxx.sdiï¼šå­˜å‚¨è¡¨ç»“æ„ä¿¡æ¯</p></li><li><p>xxx.MYD: å­˜å‚¨æ•°æ®</p></li><li><p>xxx.MYI: å­˜å‚¨ç´¢å¼•</p></li></ul><h4 id="memory" tabindex="-1"><a class="header-anchor" href="#memory" aria-hidden="true">#</a> Memory</h4><p>Memoryå¼•æ“çš„è¡¨æ•°æ®æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œç”±äºå—åˆ°ç¡¬ä»¶é—®é¢˜ã€æˆ–æ–­ç”µé—®é¢˜çš„å½±å“ï¼Œåªèƒ½å°†è¿™äº›è¡¨ä½œä¸ºä¸´æ—¶è¡¨æˆ–ç¼“å­˜ä½¿ç”¨ã€‚</p><h5 id="ç‰¹ç‚¹-2" tabindex="-1"><a class="header-anchor" href="#ç‰¹ç‚¹-2" aria-hidden="true">#</a> ç‰¹ç‚¹</h5><p>æ•°æ®åœ¨å†…å­˜ä¸­å­˜æ”¾ï¼Œé»˜è®¤ä½¿ç”¨hashç´¢å¼•ï¼Œè®¿é—®éå¸¸å¿«ã€‚æœåŠ¡å…³é—­åæ•°æ®ä¸¢å¤±ã€‚</p><h5 id="æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶" aria-hidden="true">#</a> æ–‡ä»¶</h5><p>xxx.sdiï¼šå­˜å‚¨è¡¨ç»“æ„ä¿¡æ¯</p><h4 id="åŒºåˆ«åŠç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#åŒºåˆ«åŠç‰¹ç‚¹" aria-hidden="true">#</a> åŒºåˆ«åŠç‰¹ç‚¹</h4><h3 id="å­˜å‚¨å¼•æ“çš„é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#å­˜å‚¨å¼•æ“çš„é€‰æ‹©" aria-hidden="true">#</a> å­˜å‚¨å¼•æ“çš„é€‰æ‹©</h3><p>åœ¨é€‰æ‹©å­˜å‚¨å¼•æ“æ—¶ï¼Œåº”è¯¥æ ¹æ®åº”ç”¨ç³»ç»Ÿçš„ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„å­˜å‚¨å¼•æ“ã€‚å¯¹äºå¤æ‚çš„åº”ç”¨ç³»ç»Ÿï¼Œè¿˜å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©å¤šç§å­˜å‚¨å¼•æ“è¿›è¡Œç»„åˆã€‚</p><ul><li><p>InnoDB: æ˜¯Mysqlçš„é»˜è®¤å­˜å‚¨å¼•æ“ï¼Œæ”¯æŒäº‹åŠ¡ã€å¤–é”®ã€‚å¦‚æœåº”ç”¨å¯¹äº‹åŠ¡çš„å®Œæ•´æ€§æœ‰æ¯”è¾ƒé«˜çš„è¦æ±‚ï¼Œåœ¨å¹¶å‘æ¡ä»¶ä¸‹è¦æ±‚æ•°æ®çš„ä¸€è‡´æ€§ï¼Œæ•°æ®æ“ä½œé™¤äº†æ’å…¥å’ŒæŸ¥è¯¢ä¹‹å¤–ï¼Œè¿˜åŒ…å«å¾ˆå¤šçš„æ›´æ–°ã€åˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆInnoDBå­˜å‚¨å¼•æ“æ˜¯æ¯”è¾ƒåˆé€‚çš„é€‰æ‹©ã€‚</p></li><li><p>MyISAM ï¼š å¦‚æœåº”ç”¨æ˜¯ä»¥è¯»æ“ä½œå’Œæ’å…¥æ“ä½œä¸ºä¸»ï¼Œåªæœ‰å¾ˆå°‘çš„æ›´æ–°å’Œåˆ é™¤æ“ä½œï¼Œå¹¶ä¸”å¯¹äº‹åŠ¡çš„å®Œæ•´æ€§ã€å¹¶å‘æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜ï¼Œé‚£ä¹ˆé€‰æ‹©è¿™ä¸ªå­˜å‚¨å¼•æ“æ˜¯éå¸¸åˆé€‚çš„ã€‚</p></li><li><p>MEMORYï¼šå°†æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè®¿é—®é€Ÿåº¦å¿«ï¼Œé€šå¸¸ç”¨äºä¸´æ—¶è¡¨åŠç¼“å­˜ã€‚MEMORYçš„ç¼ºé™·å°±æ˜¯å¯¹è¡¨çš„å¤§å°æœ‰é™åˆ¶ï¼Œå¤ªå¤§çš„è¡¨æ— æ³•ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œä¸”æ— æ³•ä¿éšœæ•°æ®çš„å®‰å…¨æ€§ã€‚</p></li></ul><h2 id="è¿›é˜¶ç¯‡-ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶ç¯‡-ç´¢å¼•" aria-hidden="true">#</a> è¿›é˜¶ç¯‡-ç´¢å¼•</h2><p>ç´¢å¼•ï¼ˆindexï¼‰æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„(æœ‰åº)ã€‚åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œ è¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯ç´¢å¼•ã€‚</p><table><thead><tr><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th></tr></thead><tbody><tr><td>æé«˜æ•°æ®æ£€ç´¢çš„æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“çš„IOæˆæœ¬</td><td>ç´¢å¼•åˆ—ä¹Ÿæ˜¯è¦å ç”¨ç©ºé—´çš„ã€‚</td></tr><tr><td>é€šè¿‡ç´¢å¼•åˆ—å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½CPUçš„æ¶ˆè€—ã€‚</td><td>ç´¢å¼•å¤§å¤§æé«˜äº†æŸ¥è¯¢æ•ˆç‡ï¼ŒåŒæ—¶å´ä¹Ÿé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œå¦‚å¯¹è¡¨è¿›è¡ŒINSERTã€UPDATEã€DELETEæ—¶ï¼Œæ•ˆç‡é™ä½ã€‚</td></tr></tbody></table><h3 id="ç´¢å¼•ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•ç»“æ„" aria-hidden="true">#</a> ç´¢å¼•ç»“æ„</h3><p>MySQLçš„ç´¢å¼•æ˜¯åœ¨å­˜å‚¨å¼•æ“å±‚å®ç°çš„ï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“æœ‰ä¸åŒçš„ç´¢å¼•ç»“æ„ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ç§ï¼š</p><table><thead><tr><th><strong>ç´¢å¼•ç»“æ„</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>B+Treeç´¢å¼•</td><td>æœ€å¸¸è§çš„ç´¢å¼•ç±»å‹ï¼Œå¤§éƒ¨åˆ†å¼•æ“éƒ½æ”¯æŒ B+ æ ‘ç´¢å¼•</td></tr><tr><td>Hashç´¢å¼•</td><td>åº•å±‚æ•°æ®ç»“æ„æ˜¯ç”¨å“ˆå¸Œè¡¨å®ç°çš„, åªæœ‰ç²¾ç¡®åŒ¹é…ç´¢å¼•åˆ—çš„æŸ¥è¯¢æ‰æœ‰æ•ˆ, ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢</td></tr><tr><td>R-tree(ç©ºé—´ç´¢å¼•ï¼‰</td><td>ç©ºé—´ç´¢å¼•æ˜¯MyISAMå¼•æ“çš„ä¸€ä¸ªç‰¹æ®Šç´¢å¼•ç±»å‹ï¼Œä¸»è¦ç”¨äºåœ°ç†ç©ºé—´æ•°æ®ç±»å‹ï¼Œé€šå¸¸ä½¿ç”¨è¾ƒå°‘</td></tr><tr><td>Full-text(å…¨æ–‡ç´¢å¼•)</td><td>æ˜¯ä¸€ç§é€šè¿‡å»ºç«‹å€’æ’ç´¢å¼•,å¿«é€ŸåŒ¹é…æ–‡æ¡£çš„æ–¹å¼ã€‚ç±»ä¼¼äºLucene,Solr,ES</td></tr></tbody></table><p>ä¸Šè¿°æ˜¯MySQLä¸­æ‰€æ”¯æŒçš„æ‰€æœ‰çš„ç´¢å¼•ç»“æ„ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ä¸åŒçš„å­˜å‚¨å¼•æ“å¯¹äºç´¢å¼•ç»“æ„çš„æ”¯æŒæƒ…å†µã€‚</p><table><thead><tr><th>ç´¢å¼•</th><th>InnoDB</th><th>MyISAM</th><th>Memory</th></tr></thead><tbody><tr><td>B+treeç´¢å¼•</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>Hashç´¢å¼•</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>R-treeç´¢å¼•</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>Full-text</td><td>5.6ç‰ˆæœ¬ä¹‹åæ”¯æŒ</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr></tbody></table><h4 id="äºŒå‰æ ‘" tabindex="-1"><a class="header-anchor" href="#äºŒå‰æ ‘" aria-hidden="true">#</a> äºŒå‰æ ‘</h4><p>å‡å¦‚è¯´MySQLçš„ç´¢å¼•ç»“æ„é‡‡ç”¨äºŒå‰æ ‘çš„æ•°æ®ç»“æ„ï¼Œæ¯”è¾ƒç†æƒ³çš„ç»“æ„å¦‚ä¸‹ï¼š</p><img src="/assets/image-20220426125410635-ea50920f.png" alt="image-20220426125410635" style="zoom:33%;"><p>å¦‚æœä¸»é”®æ˜¯é¡ºåºæ’å…¥çš„ï¼Œåˆ™ä¼šå½¢æˆä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><img src="/assets/image-20220426125454233-d8bc2366.png" alt="image-20220426125454233" style="zoom:33%;"><p>æ‰€ä»¥ï¼Œå¦‚æœé€‰æ‹©äºŒå‰æ ‘ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œä¼šå­˜åœ¨ä»¥ä¸‹ç¼ºç‚¹ï¼š</p><ul><li><p>é¡ºåºæ’å…¥æ—¶ï¼Œä¼šå½¢æˆä¸€ä¸ªé“¾è¡¨ï¼ŒæŸ¥è¯¢æ€§èƒ½å¤§å¤§é™ä½ã€‚</p></li><li><p>å¤§æ•°æ®é‡æƒ…å†µä¸‹ï¼Œå±‚çº§è¾ƒæ·±ï¼Œæ£€ç´¢é€Ÿåº¦æ…¢ã€‚</p></li></ul><p>æ­¤æ—¶å¤§å®¶å¯èƒ½ä¼šæƒ³åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©çº¢é»‘æ ‘ï¼Œçº¢é»‘æ ‘æ˜¯ä¸€é¢—è‡ªå¹³è¡¡äºŒå‰æ ‘ï¼Œé‚£è¿™æ ·å³ä½¿æ˜¯é¡ºåºæ’å…¥æ•°æ®ï¼Œæœ€ç»ˆå½¢æˆçš„æ•°æ®ç»“æ„ä¹Ÿæ˜¯ä¸€é¢—å¹³è¡¡çš„äºŒå‰æ ‘,ç»“æ„å¦‚ä¸‹:</p><img src="/assets/image-20220426125558905-a88d00ef.png" alt="image-20220426125558905" style="zoom:33%;"><p>ä½†æ˜¯ï¼Œå³ä½¿å¦‚æ­¤ï¼Œç”±äºçº¢é»‘æ ‘ä¹Ÿæ˜¯ä¸€é¢—äºŒå‰æ ‘ï¼Œæ‰€ä»¥ä¹Ÿä¼šå­˜åœ¨ä¸€ä¸ªç¼ºç‚¹ï¼š</p><ul><li>å¤§æ•°æ®é‡æƒ…å†µä¸‹ï¼Œå±‚çº§è¾ƒæ·±ï¼Œæ£€ç´¢é€Ÿåº¦æ…¢ã€‚</li></ul><p>æ‰€ä»¥ï¼Œåœ¨MySQLçš„ç´¢å¼•ç»“æ„ä¸­ï¼Œå¹¶æ²¡æœ‰é€‰æ‹©äºŒå‰æ ‘æˆ–è€…çº¢é»‘æ ‘ï¼Œè€Œé€‰æ‹©çš„æ˜¯B+Treeï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯B+Treeå‘¢ï¼Ÿåœ¨è¯¦è§£B+Treeä¹‹å‰ï¼Œå…ˆæ¥ä»‹ç»ä¸€ä¸ªB-Treeã€‚</p><h4 id="b-tree" tabindex="-1"><a class="header-anchor" href="#b-tree" aria-hidden="true">#</a> B-Tree</h4><p>B-Treeï¼ŒBæ ‘æ˜¯ä¸€ç§å¤šå‰è·¯è¡¡æŸ¥æ‰¾æ ‘ï¼Œç›¸å¯¹äºäºŒå‰æ ‘ï¼ŒBæ ‘æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªåˆ†æ”¯ï¼Œå³å¤šå‰ã€‚ä»¥ä¸€é¢—æœ€å¤§åº¦æ•°ï¼ˆmax-degreeï¼‰ä¸º5(5é˜¶)çš„b-treeä¸ºä¾‹ï¼Œé‚£è¿™ä¸ªBæ ‘æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå­˜å‚¨4ä¸ªkeyï¼Œ5ä¸ªæŒ‡é’ˆï¼š</p><img src="/assets/image-20220426125715435-d617d0d6.png" alt="image-20220426125715435" style="zoom:40%;"><p>ç‰¹ç‚¹ï¼š</p><ul><li><p>5é˜¶çš„Bæ ‘ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹æœ€å¤šå­˜å‚¨4ä¸ªkeyï¼Œå¯¹åº”5ä¸ªæŒ‡é’ˆã€‚</p></li><li><p>ä¸€æ—¦èŠ‚ç‚¹å­˜å‚¨çš„keyæ•°é‡åˆ°è¾¾5ï¼Œå°±ä¼šè£‚å˜ï¼Œä¸­é—´å…ƒç´ å‘ä¸Šåˆ†è£‚ã€‚</p></li><li><p>åœ¨Bæ ‘ä¸­ï¼Œéå¶å­èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹éƒ½ä¼šå­˜æ”¾æ•°æ®ã€‚</p></li></ul><h4 id="b-tree-1" tabindex="-1"><a class="header-anchor" href="#b-tree-1" aria-hidden="true">#</a> B+Tree</h4><p>B+Treeæ˜¯B-Treeçš„å˜ç§ï¼Œæˆ‘ä»¬ä»¥ä¸€é¢—æœ€å¤§åº¦æ•°ï¼ˆmax-degreeï¼‰ä¸º4ï¼ˆ4é˜¶ï¼‰çš„b+treeä¸ºä¾‹ï¼Œæ¥çœ‹ä¸€ä¸‹å…¶ç»“æ„ç¤ºæ„å›¾ï¼š</p><img src="/assets/image-20220426125836198-1638a19c.png" alt="image-20220426125836198" style="zoom:50%;"><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸¤éƒ¨åˆ†ï¼š</p><ul><li><p>ç»¿è‰²æ¡†æ¡†èµ·æ¥çš„éƒ¨åˆ†ï¼Œæ˜¯ç´¢å¼•éƒ¨åˆ†ï¼Œä»…ä»…èµ·åˆ°ç´¢å¼•æ•°æ®çš„ä½œç”¨ï¼Œä¸å­˜å‚¨æ•°æ®ã€‚</p></li><li><p>çº¢è‰²æ¡†æ¡†èµ·æ¥çš„éƒ¨åˆ†ï¼Œæ˜¯æ•°æ®å­˜å‚¨éƒ¨åˆ†ï¼Œåœ¨å…¶å¶å­èŠ‚ç‚¹ä¸­è¦å­˜å‚¨å…·ä½“çš„æ•°æ®ã€‚</p></li></ul><p>æœ€ç»ˆæˆ‘ä»¬çœ‹åˆ°ï¼ŒB+Tree ä¸ B-Treeç›¸æ¯”ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç‚¹åŒºåˆ«ï¼š</p><ul><li><p>æ‰€æœ‰çš„æ•°æ®éƒ½ä¼šå‡ºç°åœ¨å¶å­èŠ‚ç‚¹ã€‚</p></li><li><p>å¶å­èŠ‚ç‚¹å½¢æˆä¸€ä¸ªå•å‘é“¾è¡¨ã€‚</p></li><li><p>éå¶å­èŠ‚ç‚¹ä»…ä»…èµ·åˆ°ç´¢å¼•æ•°æ®ä½œç”¨ï¼Œå…·ä½“çš„æ•°æ®éƒ½æ˜¯åœ¨å¶å­èŠ‚ç‚¹å­˜æ”¾çš„ã€‚</p></li></ul><p>ä¸Šè¿°æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ç»“æ„æ˜¯æ ‡å‡†çš„B+Treeçš„æ•°æ®ç»“æ„ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹MySQLä¸­ä¼˜åŒ–ä¹‹åçš„B+Treeã€‚</p><p>MySQLç´¢å¼•æ•°æ®ç»“æ„å¯¹ç»å…¸çš„B+Treeè¿›è¡Œäº†ä¼˜åŒ–ã€‚åœ¨åŸB+Treeçš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸€ä¸ªæŒ‡å‘ç›¸é‚»å¶å­èŠ‚ç‚¹çš„é“¾è¡¨æŒ‡é’ˆï¼Œå°±å½¢æˆäº†å¸¦æœ‰é¡ºåºæŒ‡é’ˆçš„B+Treeï¼Œæé«˜åŒºé—´è®¿é—®çš„æ€§èƒ½ï¼Œåˆ©äºæ’åºã€‚</p><img src="/assets/image-20220426130002472-a8a1e085.png" alt="image-20220426130002472" style="zoom:50%;"><h4 id="hash" tabindex="-1"><a class="header-anchor" href="#hash" aria-hidden="true">#</a> Hash</h4><p>MySQLä¸­é™¤äº†æ”¯æŒB+Treeç´¢å¼•ï¼Œè¿˜æ”¯æŒä¸€ç§ç´¢å¼•ç±»å‹---Hashç´¢å¼•ã€‚</p><h5 id="ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç»“æ„" aria-hidden="true">#</a> ç»“æ„</h5><p>å“ˆå¸Œç´¢å¼•å°±æ˜¯é‡‡ç”¨ä¸€å®šçš„hashç®—æ³•ï¼Œå°†é”®å€¼æ¢ç®—æˆæ–°çš„hashå€¼ï¼Œæ˜ å°„åˆ°å¯¹åº”çš„æ§½ä½ä¸Šï¼Œç„¶åå­˜å‚¨åœ¨hashè¡¨ä¸­ã€‚</p><img src="/assets/image-20220426130112307-a9ee5735.png" alt="image-20220426130112307" style="zoom:50%;"><p>å¦‚æœä¸¤ä¸ª(æˆ–å¤šä¸ª)é”®å€¼ï¼Œæ˜ å°„åˆ°ä¸€ä¸ªç›¸åŒçš„æ§½ä½ä¸Šï¼Œä»–ä»¬å°±äº§ç”Ÿäº†hashå†²çªï¼ˆä¹Ÿç§°ä¸ºhashç¢°æ’ï¼‰ï¼Œå¯ä»¥é€šè¿‡é“¾è¡¨æ¥è§£å†³ã€‚</p><img src="/assets/image-20220426130147436-9b9b5dce.png" alt="image-20220426130147436" style="zoom:50%;"><h5 id="ç‰¹ç‚¹-3" tabindex="-1"><a class="header-anchor" href="#ç‰¹ç‚¹-3" aria-hidden="true">#</a> ç‰¹ç‚¹</h5><ul><li><p>Hashç´¢å¼•åªèƒ½ç”¨äºå¯¹ç­‰æ¯”è¾ƒ(=ï¼Œin)ï¼Œä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼ˆbetweenï¼Œ&gt;ï¼Œ&lt; ï¼Œ...ï¼‰</p></li><li><p>æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆæ’åºæ“ä½œ</p></li><li><p>æŸ¥è¯¢æ•ˆç‡é«˜ï¼Œé€šå¸¸(ä¸å­˜åœ¨hashå†²çªçš„æƒ…å†µ)åªéœ€è¦ä¸€æ¬¡æ£€ç´¢å°±å¯ä»¥äº†ï¼Œæ•ˆç‡é€šå¸¸è¦é«˜äºB+treeç´¢å¼•</p></li></ul><h5 id="å­˜å‚¨å¼•æ“æ”¯æŒ" tabindex="-1"><a class="header-anchor" href="#å­˜å‚¨å¼•æ“æ”¯æŒ" aria-hidden="true">#</a> å­˜å‚¨å¼•æ“æ”¯æŒ</h5><p>åœ¨MySQLä¸­ï¼Œæ”¯æŒhashç´¢å¼•çš„æ˜¯Memoryå­˜å‚¨å¼•æ“ã€‚ è€ŒInnoDBä¸­å…·æœ‰è‡ªé€‚åº”hashåŠŸèƒ½ï¼Œhashç´¢å¼•æ˜¯InnoDBå­˜å‚¨å¼•æ“æ ¹æ®B+Treeç´¢å¼•åœ¨æŒ‡å®šæ¡ä»¶ä¸‹è‡ªåŠ¨æ„å»ºçš„ã€‚</p><blockquote><p>æ€è€ƒé¢˜ï¼š ä¸ºä»€ä¹ˆInnoDBå­˜å‚¨å¼•æ“é€‰æ‹©ä½¿ç”¨B+treeç´¢å¼•ç»“æ„?</p><ul><li><p>ç›¸å¯¹äºäºŒå‰æ ‘ï¼Œå±‚çº§æ›´å°‘ï¼Œæœç´¢æ•ˆç‡é«˜ï¼›</p></li><li><p>å¯¹äºB-treeï¼Œæ— è®ºæ˜¯å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šä¿å­˜æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´ä¸€é¡µä¸­å­˜å‚¨çš„é”®å€¼å‡å°‘ï¼ŒæŒ‡é’ˆè·Ÿç€å‡å°‘ï¼Œè¦åŒæ ·ä¿å­˜å¤§é‡æ•°æ®ï¼Œåªèƒ½å¢åŠ æ ‘çš„é«˜åº¦ï¼Œå¯¼è‡´æ€§èƒ½é™ä½ï¼›</p></li><li><p>ç›¸å¯¹Hashç´¢å¼•ï¼ŒB+treeæ”¯æŒèŒƒå›´åŒ¹é…åŠæ’åºæ“ä½œï¼›</p></li></ul></blockquote><h3 id="ç´¢å¼•åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•åˆ†ç±»" aria-hidden="true">#</a> ç´¢å¼•åˆ†ç±»</h3><p>åœ¨MySQLæ•°æ®åº“ï¼Œå°†ç´¢å¼•çš„å…·ä½“ç±»å‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼šä¸»é”®ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ã€å¸¸è§„ç´¢å¼•ã€å…¨æ–‡ç´¢å¼•ã€‚</p><table><thead><tr><th>åˆ†ç±»</th><th>å«ä¹‰</th><th>ç‰¹ç‚¹</th><th>å…³é”®å­—</th></tr></thead><tbody><tr><td>ä¸»é”®ç´¢å¼•</td><td>é’ˆå¯¹ä¸è¡¨ä¸­ä¸»é”®ç©¿ä»¶çš„ç´¢å¼•</td><td>é»˜è®¤è‡ªåŠ¨åˆ›å»º, åªèƒ½æœ‰ä¸€ä¸ª</td><td>PRIMARY</td></tr><tr><td>å”¯ä¸€ç´¢å¼•</td><td>é¿å…åŒä¸€ä¸ªè¡¨ä¸­æŸæ•°æ®åˆ—ä¸­çš„å€¼é‡å¤</td><td>å¯ä»¥æœ‰å¤šä¸ª</td><td>UNIQUE</td></tr><tr><td>å¸¸è§„ç´¢å¼•</td><td>å¿«é€Ÿå®šä½ç‰¹å®šæ•°æ®</td><td>å¯ä»¥æœ‰å¤šä¸ª</td><td></td></tr><tr><td>å…¨æ–‡ç´¢å¼•</td><td>å…¨æ–‡ç´¢å¼•æŸ¥æ‰¾çš„æ˜¯æ–‡æœ¬ä¸­çš„å…³é”®è¯ï¼Œè€Œä¸æ˜¯æ¯”è¾ƒç´¢å¼•ä¸­çš„å€¼</td><td>å¯ä»¥æœ‰å¤šä¸ª</td><td>FULLTEXT</td></tr></tbody></table><h4 id="èšé›†ç´¢å¼•-äºŒçº§ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#èšé›†ç´¢å¼•-äºŒçº§ç´¢å¼•" aria-hidden="true">#</a> èšé›†ç´¢å¼•&amp;äºŒçº§ç´¢å¼•</h4><p>è€Œåœ¨åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼Œæ ¹æ®ç´¢å¼•çš„å­˜å‚¨å½¢å¼ï¼Œåˆå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§ï¼š</p><table><thead><tr><th>åˆ†ç±»</th><th>å«æœ‰</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>èšé›†ç´¢å¼•(Clustered Index)</td><td>å°†æ•°æ®å­˜å‚¨ä¸ç´¢å¼•æ”¾åˆ°äº†ä¸€å—ï¼Œç´¢å¼•ç»“æ„çš„å¶å­èŠ‚ç‚¹ä¿å­˜äº†è¡Œæ•°æ®</td><td>å¿…é¡»æœ‰,è€Œä¸”åªæœ‰ä¸€ä¸ª</td></tr><tr><td>äºŒçº§ç´¢å¼•(Secondary Index)</td><td>å°†æ•°æ®ä¸ç´¢å¼•åˆ†å¼€å­˜å‚¨ï¼Œç´¢å¼•ç»“æ„çš„å¶å­èŠ‚ç‚¹å…³è”çš„æ˜¯å¯¹åº”çš„ä¸»é”®</td><td>å¯ä»¥å­˜åœ¨å¤šä¸ª</td></tr></tbody></table><p>èšé›†ç´¢å¼•é€‰å–è§„åˆ™:</p><ul><li>å¦‚æœå­˜åœ¨ä¸»é”®ï¼Œä¸»é”®ç´¢å¼•å°±æ˜¯èšé›†ç´¢å¼•ã€‚</li><li>å¦‚æœä¸å­˜åœ¨ä¸»é”®ï¼Œå°†ä½¿ç”¨ç¬¬ä¸€ä¸ªå”¯ä¸€ï¼ˆUNIQUEï¼‰ç´¢å¼•ä½œä¸ºèšé›†ç´¢å¼•ã€‚</li><li>å¦‚æœè¡¨æ²¡æœ‰ä¸»é”®ï¼Œæˆ–æ²¡æœ‰åˆé€‚çš„å”¯ä¸€ç´¢å¼•ï¼Œåˆ™InnoDBä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªrowidä½œä¸ºéšè—çš„èšé›†ç´¢å¼•ã€‚</li></ul><p>èšé›†ç´¢å¼•å’ŒäºŒçº§ç´¢å¼•çš„å…·ä½“ç»“æ„å¦‚ä¸‹ï¼š</p><img src="/assets/image-20220426132101688-915a67bc.png" alt="image-20220426132101688" style="zoom:50%;"><ul><li><p>èšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸‹æŒ‚çš„æ˜¯è¿™ä¸€è¡Œçš„æ•°æ® ã€‚</p></li><li><p>äºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸‹æŒ‚çš„æ˜¯è¯¥å­—æ®µå€¼å¯¹åº”çš„ä¸»é”®å€¼</p></li></ul><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹çš„SQLè¯­å¥æ—¶ï¼Œå…·ä½“çš„æŸ¥æ‰¾è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</p><img src="/assets/image-20220426132221890-dac67025.png" alt="image-20220426132221890" style="zoom:50%;"><p>å…·ä½“è¿‡ç¨‹å¦‚ä¸‹:</p><p>â‘ . ç”±äºæ˜¯æ ¹æ®nameå­—æ®µè¿›è¡ŒæŸ¥è¯¢ï¼Œæ‰€ä»¥å…ˆæ ¹æ®name=&#39;Arm&#39;åˆ°nameå­—æ®µçš„äºŒçº§ç´¢å¼•ä¸­è¿›è¡ŒåŒ¹é…æŸ¥æ‰¾ã€‚ä½†æ˜¯åœ¨äºŒçº§ç´¢å¼•ä¸­åªèƒ½æŸ¥æ‰¾åˆ° Arm å¯¹åº”çš„ä¸»é”®å€¼ 10ã€‚</p><p>â‘¡. ç”±äºæŸ¥è¯¢è¿”å›çš„æ•°æ®æ˜¯*ï¼Œæ‰€ä»¥æ­¤æ—¶ï¼Œè¿˜éœ€è¦æ ¹æ®ä¸»é”®å€¼10ï¼Œåˆ°èšé›†ç´¢å¼•ä¸­æŸ¥æ‰¾10å¯¹åº”çš„è®°å½•ï¼Œæœ€ç»ˆæ‰¾åˆ°10å¯¹åº”çš„è¡Œrowã€‚</p><p>â‘¢. æœ€ç»ˆæ‹¿åˆ°è¿™ä¸€è¡Œçš„æ•°æ®ï¼Œç›´æ¥è¿”å›å³å¯ã€‚</p><blockquote><p><strong>å›è¡¨æŸ¥è¯¢</strong>ï¼š è¿™ç§å…ˆåˆ°äºŒçº§ç´¢å¼•ä¸­æŸ¥æ‰¾æ•°æ®ï¼Œæ‰¾åˆ°ä¸»é”®å€¼ï¼Œç„¶åå†åˆ°èšé›†ç´¢å¼•ä¸­æ ¹æ®ä¸»é”®å€¼ï¼Œè·å–æ•°æ®çš„æ–¹å¼ï¼Œå°±ç§°ä¹‹ä¸ºå›è¡¨æŸ¥è¯¢ã€‚</p><p><strong>æ€è€ƒé¢˜ï¼š</strong></p><p>ä»¥ä¸‹ä¸¤æ¡SQLè¯­å¥ï¼Œé‚£ä¸ªæ‰§è¡Œæ•ˆç‡é«˜? ä¸ºä»€ä¹ˆ?</p><p>A. select * from user where id = 10 ;</p><p>B. select * from user where name = &#39;Arm&#39; ;</p><p>å¤‡æ³¨: idä¸ºä¸»é”®ï¼Œnameå­—æ®µåˆ›å»ºçš„æœ‰ç´¢å¼•ï¼›</p><p>è§£ç­”ï¼š</p><p>A è¯­å¥çš„æ‰§è¡Œæ€§èƒ½è¦é«˜äºB è¯­å¥ã€‚å› ä¸ºAè¯­å¥ç›´æ¥èµ°èšé›†ç´¢å¼•ï¼Œç›´æ¥è¿”å›æ•°æ®ã€‚ è€ŒBè¯­å¥éœ€è¦å…ˆæŸ¥è¯¢nameå­—æ®µçš„äºŒçº§ç´¢å¼•ï¼Œç„¶åå†æŸ¥è¯¢èšé›†ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯éœ€è¦è¿›è¡Œå›è¡¨æŸ¥è¯¢ã€‚</p><p><strong>æ€è€ƒé¢˜ï¼š</strong></p><p>InnoDBä¸»é”®ç´¢å¼•çš„B+treeé«˜åº¦ä¸ºå¤šé«˜å‘¢?</p><p>å‡è®¾:</p><p>ä¸€è¡Œæ•°æ®å¤§å°ä¸º1kï¼Œä¸€é¡µä¸­å¯ä»¥å­˜å‚¨16è¡Œè¿™æ ·çš„æ•°æ®ã€‚InnoDBçš„æŒ‡é’ˆå ç”¨6ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œä¸»é”®å³ä½¿ä¸ºbigintï¼Œå ç”¨å­—èŠ‚æ•°ä¸º8ã€‚</p><p>é«˜åº¦ä¸º2ï¼š</p><p>n * 8 + (n + 1) * 6 = 16*1024 , ç®—å‡ºnçº¦ä¸º 1170</p><p>1171* 16 = 18736</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ ‘çš„é«˜åº¦ä¸º2ï¼Œåˆ™å¯ä»¥å­˜å‚¨ 18000 å¤šæ¡è®°å½•ã€‚</p><p>é«˜åº¦ä¸º3ï¼š</p><p>1171 * 1171 * 16 = 21939856</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ ‘çš„é«˜åº¦ä¸º3ï¼Œåˆ™å¯ä»¥å­˜å‚¨ 2200w å·¦å³çš„è®°å½•ã€‚</p></blockquote><h3 id="ç´¢å¼•è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•è¯­æ³•" aria-hidden="true">#</a> ç´¢å¼•è¯­æ³•</h3><p>åˆ›å»ºç´¢å¼•</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token punctuation">[</span> <span class="token keyword">UNIQUE</span> <span class="token operator">|</span> FULLTEXT <span class="token punctuation">]</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name <span class="token punctuation">(</span> index_col_name<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æŸ¥çœ‹ç´¢å¼•</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> table_name <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åˆ é™¤ç´¢å¼•</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="sqlæ€§èƒ½åˆ†æ" tabindex="-1"><a class="header-anchor" href="#sqlæ€§èƒ½åˆ†æ" aria-hidden="true">#</a> SQLæ€§èƒ½åˆ†æ</h3><h4 id="sqlæ‰§è¡Œé¢‘ç‡" tabindex="-1"><a class="header-anchor" href="#sqlæ‰§è¡Œé¢‘ç‡" aria-hidden="true">#</a> SQLæ‰§è¡Œé¢‘ç‡</h4><p>MySQL å®¢æˆ·ç«¯è¿æ¥æˆåŠŸåï¼Œé€šè¿‡ show [session|global] status å‘½ä»¤å¯ä»¥æä¾›æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯ã€‚é€šè¿‡å¦‚ä¸‹æŒ‡ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„INSERTã€UPDATEã€DELETEã€SELECTçš„è®¿é—®é¢‘æ¬¡ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- session æ˜¯æŸ¥çœ‹å½“å‰ä¼šè¯,é»˜è®¤æ˜¯æ­¤çº§åˆ«; </span>
<span class="token comment">-- global æ˜¯æŸ¥è¯¢å…¨å±€æ•°æ® ; </span>
<span class="token keyword">SHOW</span> <span class="token keyword">GLOBAL</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">&#39;Com_%&#39;</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220426133035695-99184019.png" alt="image-20220426133035695" style="zoom:50%;"><ul><li><p>Com_delete: åˆ é™¤æ¬¡æ•°</p></li><li><p>Com_insert: æ’å…¥æ¬¡æ•°</p></li><li><p>Com_select: æŸ¥è¯¢æ¬¡æ•°</p></li><li><p>Com_update: æ›´æ–°æ¬¡æ•°</p></li></ul><p>é€šè¿‡ä¸‹é¢ä¸¤ä¸ªå‚æ•°å¯ä»¥äº†è§£äº‹ç‰©çš„æäº¤å’Œå›æ»šæƒ…å†µï¼š</p><ul><li>Com_commit: äº‹ç‰©æäº¤æ¬¡æ•°</li><li>Com_rollback: äº‹ç‰©å›æ»šæ¬¡æ•°</li></ul><p>ä¸‹é¢è¿˜æœ‰å‡ ä¸ªé’ˆå¯¹InnoDBå­˜å‚¨å¼•æ“çš„å‚æ•°å¯ä»¥å‚è€ƒï¼š</p><ul><li>Innodb_row_read: SelectæŸ¥è¯¢è¿”å›çš„è¡Œæ•°</li><li>Innodb_rows_inserted: æ‰§è¡ŒINSERTæ“ä½œæ’å…¥çš„è¡Œæ•°ã€‚</li><li>Innodb_rows_updated: æ‰§è¡ŒUPDATEæ“ä½œæ›´æ–°çš„è¡Œæ•°</li><li>Innodb_rows_deleted: æ‰§è¡ŒDELETEæ“ä½œåˆ é™¤çš„è¡Œæ•°</li></ul><p>é€šè¿‡è¿™å‡ ä¸ªæ“ä½œå¯ä»¥å¾ˆå®¹æ˜“äº†è§£å½“å‰æ•°æ®åº“æ˜¯ä»¥æ’å…¥æ›´æ–°ä¸ºä¸»ï¼Œè¿˜æ˜¯ä»¥æŸ¥è¯¢æ“ä½œä¸ºä¸»ã€‚</p><p>ä»¥ä¸‹å‡ ä¸ªå‚æ•°ç”¨äºäº†è§£æ•°æ®åº“çš„åŸºæœ¬æƒ…å†µï¼š</p><ul><li>Connectionsï¼š è¯•å›¾è¿æ¥MySQLæœåŠ¡å™¨çš„æ¬¡æ•°</li><li>Uptimeï¼š æœåŠ¡å™¨çš„å·¥ä½œæ—¶é—´</li><li>Slow_queries: æ…¢æŸ¥è¯¢çš„æ¬¡æ•°ã€‚</li></ul><h4 id="æ…¢æŸ¥è¯¢æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#æ…¢æŸ¥è¯¢æ—¥å¿—" aria-hidden="true">#</a> æ…¢æŸ¥è¯¢æ—¥å¿—</h4><p>æ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šå‚æ•°ï¼ˆlong_query_timeï¼Œå•ä½ï¼šç§’ï¼Œé»˜è®¤10ç§’ï¼‰çš„æ‰€æœ‰SQLè¯­å¥çš„æ—¥å¿—ã€‚</p><p>MySQLçš„æ…¢æŸ¥è¯¢æ—¥å¿—é»˜è®¤æ²¡æœ‰å¼€å¯ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿå˜é‡ slow_query_logã€‚</p><img src="/assets/image-20220426133244664-627d62dc.png" alt="image-20220426133244664" style="zoom:50%;"><p>å¦‚æœè¦å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦åœ¨MySQLçš„é…ç½®æ–‡ä»¶ï¼ˆ/etc/my.cnfï¼‰ä¸­é…ç½®å¦‚ä¸‹ä¿¡æ¯ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># å¼€å¯MySQLæ…¢æ—¥å¿—æŸ¥è¯¢å¼€å…³ </span>
<span class="token key attr-name">slow_query_log</span><span class="token punctuation">=</span><span class="token value attr-value">1 </span>
<span class="token comment"># è®¾ç½®æ…¢æ—¥å¿—çš„æ—¶é—´ä¸º2ç§’ï¼ŒSQLè¯­å¥æ‰§è¡Œæ—¶é—´è¶…è¿‡2ç§’ï¼Œå°±ä¼šè§†ä¸ºæ…¢æŸ¥è¯¢ï¼Œè®°å½•æ…¢æŸ¥è¯¢æ—¥å¿— </span>
<span class="token key attr-name">long_query_time</span><span class="token punctuation">=</span><span class="token value attr-value">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å®Œæ¯•ä¹‹åï¼Œé€šè¿‡ä»¥ä¸‹æŒ‡ä»¤é‡æ–°å¯åŠ¨MySQLæœåŠ¡å™¨è¿›è¡Œæµ‹è¯•ï¼ŒæŸ¥çœ‹æ…¢æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•çš„ä¿¡æ¯/var/lib/mysql/localhost-slow.logã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl restart mysqld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åï¼Œå†æ¬¡æŸ¥çœ‹å¼€å…³æƒ…å†µï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—å°±å·²ç»æ‰“å¼€äº†ã€‚</p><p><strong>æµ‹è¯•</strong></p><p>æ‰§è¡Œå¦‚ä¸‹SQLè¯­å¥ ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>select * from tb_user; -- è¿™æ¡SQLæ‰§è¡Œæ•ˆç‡æ¯”è¾ƒé«˜, æ‰§è¡Œè€—æ—¶ 0.00sec
select count(*) from tb_sku; -- ç”±äºtb_skuè¡¨ä¸­, é¢„å…ˆå­˜å…¥äº†1000wçš„è®°å½•, countä¸€æ¬¡,è€—æ—¶ 13.35sec
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220426133553213-bd2d91d9.png" alt="image-20220426133553213" style="zoom:50%;"><p><strong>æ£€æŸ¥æ…¢æŸ¥è¯¢æ—¥å¿—</strong></p><p>æœ€ç»ˆæˆ‘ä»¬å‘ç°ï¼Œåœ¨æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ï¼Œåªä¼šè®°å½•æ‰§è¡Œæ—¶é—´è¶…å¤šæˆ‘ä»¬é¢„è®¾æ—¶é—´ï¼ˆ2sï¼‰çš„SQLï¼Œæ‰§è¡Œè¾ƒå¿«çš„SQLæ˜¯ä¸ä¼šè®°å½•çš„ã€‚é‚£è¿™æ ·ï¼Œé€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå°±å¯ä»¥å®šä½å‡ºæ‰§è¡Œæ•ˆç‡æ¯”è¾ƒä½çš„SQLï¼Œä»è€Œæœ‰é’ˆå¯¹æ€§çš„è¿›è¡Œä¼˜åŒ–ã€‚</p><img src="/assets/image-20220426133716953-e6acbe09.png" alt="image-20220426133716953" style="zoom:50%;"><h4 id="profileè¯¦æƒ…" tabindex="-1"><a class="header-anchor" href="#profileè¯¦æƒ…" aria-hidden="true">#</a> profileè¯¦æƒ…</h4><p>show profiles èƒ½å¤Ÿåœ¨åšSQLä¼˜åŒ–æ—¶å¸®åŠ©æˆ‘ä»¬äº†è§£æ—¶é—´éƒ½è€—è´¹åˆ°å“ªé‡Œå»äº†ã€‚é€šè¿‡have_profilingå‚æ•°ï¼Œèƒ½å¤Ÿçœ‹åˆ°å½“å‰MySQLæ˜¯å¦æ”¯æŒprofileæ“ä½œï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> @<span class="token variable">@have_profiling</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426133851894-2e00f48d.png" alt="image-20220426133851894" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“å‰MySQLæ˜¯æ”¯æŒ profileæ“ä½œçš„ï¼Œä½†æ˜¯å¼€å…³æ˜¯å…³é—­çš„ã€‚å¯ä»¥é€šè¿‡setè¯­å¥åœ¨session/globalçº§åˆ«å¼€å¯profilingï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> profiling <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¼€å…³å·²ç»æ‰“å¼€äº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰€æ‰§è¡Œçš„SQLè¯­å¥ï¼Œéƒ½ä¼šè¢«MySQLè®°å½•ï¼Œå¹¶è®°å½•æ‰§è¡Œæ—¶é—´æ¶ˆè€—åˆ°å“ªå„¿å»äº†ã€‚ æˆ‘ä»¬ç›´æ¥æ‰§è¡Œå¦‚ä¸‹çš„SQLè¯­å¥ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user<span class="token punctuation">;</span> 
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;ç™½èµ·&#39;</span><span class="token punctuation">;</span> 
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> tb_sku<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œä¸€ç³»åˆ—çš„ä¸šåŠ¡SQLçš„æ“ä½œï¼Œç„¶åé€šè¿‡å¦‚ä¸‹æŒ‡ä»¤æŸ¥çœ‹æŒ‡ä»¤çš„æ‰§è¡Œè€—æ—¶ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- æŸ¥çœ‹æ¯ä¸€æ¡SQLçš„è€—æ—¶åŸºæœ¬æƒ…å†µ </span>
<span class="token keyword">show</span> profiles<span class="token punctuation">;</span> 
<span class="token comment">-- æŸ¥çœ‹æŒ‡å®šquery_idçš„SQLè¯­å¥å„ä¸ªé˜¶æ®µçš„è€—æ—¶æƒ…å†µ </span>
<span class="token keyword">show</span> profile <span class="token keyword">for</span> query query_id<span class="token punctuation">;</span> 
<span class="token comment">-- æŸ¥çœ‹æŒ‡å®šquery_idçš„SQLè¯­å¥CPUçš„ä½¿ç”¨æƒ…å†µ </span>
<span class="token keyword">show</span> profile cpu <span class="token keyword">for</span> query query_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹æ¯ä¸€æ¡SQLçš„è€—æ—¶æƒ…å†µ:</p><img src="/assets/image-20220426134116001-b2461b53.png" alt="image-20220426134116001" style="zoom:50%;"><p>æŸ¥çœ‹æŒ‡å®šSQLå„ä¸ªé˜¶æ®µçš„è€—æ—¶æƒ…å†µ :</p><img src="/assets/image-20220426134155085-a4d96e07.png" alt="image-20220426134155085" style="zoom:50%;"><p>MySQLæ”¯æŒè¿›ä¸€æ­¥é€‰æ‹©allã€cpuã€block ioã€contextã€switchã€page faultsç­‰æ˜ç»†ç±»å‹æ¥æŸ¥çœ‹MySQLåœ¨ä½¿ç”¨ä»€ä¹ˆèµ„æºä¸Šè€—è´¹äº†è¿‡é«˜çš„æ—¶é—´ã€‚</p><h4 id="explain" tabindex="-1"><a class="header-anchor" href="#explain" aria-hidden="true">#</a> explain</h4><p>EXPLAIN æˆ–è€… DESCå‘½ä»¤è·å– MySQL å¦‚ä½•æ‰§è¡Œ SELECT è¯­å¥çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬åœ¨ SELECT è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­è¡¨å¦‚ä½•è¿æ¥å’Œè¿æ¥çš„é¡ºåºã€‚</p><p>è¯­æ³•:</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- ç›´æ¥åœ¨selectè¯­å¥ä¹‹å‰åŠ ä¸Šå…³é”®å­— explain / desc </span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> å­—æ®µåˆ—è¡¨ <span class="token keyword">FROM</span> è¡¨å <span class="token keyword">WHERE</span> æ¡ä»¶ <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220426134818605-02deedfc.png" alt="image-20220426134818605" style="zoom:50%;"><p>Explain æ‰§è¡Œè®¡åˆ’ä¸­å„ä¸ªå­—æ®µçš„å«ä¹‰:</p><table><thead><tr><th>å­—æ®µ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>id</td><td>selectæŸ¥è¯¢çš„åºåˆ—å·ï¼Œè¡¨ç¤ºæŸ¥è¯¢ä¸­æ‰§è¡Œselectå­å¥æˆ–è€…æ˜¯æ“ä½œè¡¨çš„é¡ºåº(idç›¸åŒï¼Œæ‰§è¡Œé¡ºåºä»ä¸Šåˆ°ä¸‹ï¼›idä¸åŒï¼Œå€¼è¶Šå¤§ï¼Œè¶Šå…ˆæ‰§è¡Œ)ã€‚</td></tr><tr><td>select_type</td><td>è¡¨ç¤º SELECT çš„ç±»å‹ï¼Œå¸¸è§çš„å–å€¼æœ‰ <br>SIMPLEï¼ˆç®€å•è¡¨ï¼Œå³ä¸ä½¿ç”¨è¡¨è¿æ¥æˆ–è€…å­æŸ¥è¯¢ï¼‰ã€<br>PRIMARYï¼ˆä¸»æŸ¥è¯¢ï¼Œå³å¤–å±‚çš„æŸ¥è¯¢ï¼‰ã€<br>UNIONï¼ˆUNION ä¸­çš„ç¬¬äºŒä¸ªæˆ–è€…åé¢çš„æŸ¥è¯¢è¯­å¥ï¼‰ã€<br>SUBQUERYï¼ˆSELECT/WHEREä¹‹ååŒ…å«äº†å­æŸ¥è¯¢ï¼‰ç­‰</td></tr><tr><td>table</td><td>è¾“å‡ºç»“æœé›†çš„è¡¨</td></tr><tr><td>type</td><td>è¡¨ç¤ºMySQLåœ¨è¡¨ä¸­æ‰¾åˆ°æ‰€éœ€è¡Œçš„æ–¹å¼ï¼Œæˆ–è€…å«è®¿é—®ç±»å‹ï¼Œå¸¸è§ç±»å‹å¦‚ä¸‹ï¼š<br>type=ALLï¼š å…¨è¡¨æ‰«æï¼ŒMysqléå†å…¨è¡¨æ¥æ‰¾åˆ°åŒ¹é…è¡Œ<br>type=indexï¼šç´¢å¼•å…¨æ‰«æï¼ŒMysqléå†æ•´ä¸ªç´¢å¼•æ¥æŸ¥è¯¢åŒ¹é…çš„è¡Œï¼Œ<br>type=rangeï¼šç´¢å¼•èŒƒå›´æ‰«æï¼Œå¸¸è§äº&lt;ï¼Œ&lt;=ï¼Œ&gt;ï¼Œ&gt;=ï¼Œbetweenç­‰æ“ä½œã€‚<br>type=refï¼šä½¿ç”¨éå”¯ä¸€ç´¢å¼•(ä¸æ˜¯UNIQUEç±»å‹çš„ç´¢å¼•)æ‰«ææˆ–å”¯ä¸€ç´¢å¼•çš„å‰ç¼€æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„è®°å½•è¡Œã€‚<br>type=eq_refï¼šä½¿ç”¨å”¯ä¸€ç´¢å¼•æ‰«æï¼ˆä¾‹å¦‚ï¼šé”è¡¨è¿æ¥ä¸­ä½¿ç”¨primary keyæˆ–è€…unique keyä½œä¸ºå…³è”æ¡ä»¶ï¼‰<br>type=const/systemï¼šå•è¡¨ä¸­åªæœ‰ä¸€è¡ŒåŒ¹é…ï¼ŒæŸ¥è¯¢éå¸¸è¿…é€Ÿï¼Œä¾‹å¦‚é€šè¿‡primary key æˆ–è€… unique key è¿›è¡ŒæŸ¥è¯¢ã€‚<br>type=NULLï¼šMySQLä¸ç”¨è®¿é—®ç´¢å¼•ï¼Œå°±èƒ½è·å–ç»“æœã€‚</td></tr><tr><td>possible_key</td><td>è¡¨ç¤ºæŸ¥è¯¢æ˜¯å¯èƒ½ä½¿ç”¨çš„ç´¢å¼•</td></tr><tr><td>key</td><td>å®é™…ä½¿ç”¨çš„ç´¢å¼•ï¼Œå¦‚æœä¸ºNULLï¼Œåˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚</td></tr><tr><td>key_len</td><td>è¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œ è¯¥å€¼ä¸ºç´¢å¼•å­—æ®µæœ€å¤§å¯èƒ½é•¿åº¦ï¼Œå¹¶éå®é™…ä½¿ç”¨é•¿åº¦ï¼Œåœ¨ä¸æŸå¤±ç²¾ç¡®æ€§çš„å‰æä¸‹ï¼Œ é•¿åº¦è¶ŠçŸ­è¶Šå¥½ ã€‚</td></tr><tr><td>rows</td><td>MySQLè®¤ä¸ºå¿…é¡»è¦æ‰§è¡ŒæŸ¥è¯¢çš„è¡Œæ•°ï¼Œåœ¨innodbå¼•æ“çš„è¡¨ä¸­ï¼Œæ˜¯ä¸€ä¸ªä¼°è®¡å€¼ï¼Œå¯èƒ½å¹¶ä¸æ€»æ˜¯å‡†ç¡®çš„ã€‚</td></tr><tr><td>filtered</td><td>è¡¨ç¤ºè¿”å›ç»“æœçš„è¡Œæ•°å éœ€è¯»å–è¡Œæ•°çš„ç™¾åˆ†æ¯”ï¼Œ filtered çš„å€¼è¶Šå¤§è¶Šå¥½ã€‚</td></tr></tbody></table><h3 id="ç´¢å¼•ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•ä½¿ç”¨" aria-hidden="true">#</a> ç´¢å¼•ä½¿ç”¨</h3><h4 id="æœ€å·¦å‰ç¼€æ³•åˆ™" tabindex="-1"><a class="header-anchor" href="#æœ€å·¦å‰ç¼€æ³•åˆ™" aria-hidden="true">#</a> æœ€å·¦å‰ç¼€æ³•åˆ™</h4><p>å¦‚æœç´¢å¼•äº†å¤šåˆ—ï¼ˆè”åˆç´¢å¼•ï¼‰ï¼Œè¦éµå®ˆæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚æœ€å·¦å‰ç¼€æ³•åˆ™æŒ‡çš„æ˜¯æŸ¥è¯¢ä»ç´¢å¼•çš„æœ€å·¦åˆ—å¼€å§‹ï¼Œå¹¶ä¸”ä¸è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—ã€‚å¦‚æœè·³è·ƒæŸä¸€åˆ—ï¼Œç´¢å¼•å°†ä¼šéƒ¨åˆ†å¤±æ•ˆ(åé¢çš„å­—æ®µç´¢å¼•å¤±æ•ˆ)ã€‚</p><p>ä»¥ tb_user è¡¨ä¸ºä¾‹ï¼Œæˆ‘ä»¬å…ˆæ¥æŸ¥çœ‹ä¸€ä¸‹ä¹‹å‰ tb_user è¡¨æ‰€åˆ›å»ºçš„ç´¢å¼•ã€‚</p><img src="/assets/image-20220426135255321-c91d6c28.png" alt="image-20220426135255321" style="zoom:50%;"><p>åœ¨ tb_user è¡¨ä¸­ï¼Œæœ‰ä¸€ä¸ªè”åˆç´¢å¼•ï¼Œè¿™ä¸ªè”åˆç´¢å¼•æ¶‰åŠåˆ°ä¸‰ä¸ªå­—æ®µï¼Œé¡ºåºåˆ†åˆ«ä¸ºï¼šprofessionï¼Œageï¼Œstatusã€‚</p><p>å¯¹äºæœ€å·¦å‰ç¼€æ³•åˆ™æŒ‡çš„æ˜¯ï¼ŒæŸ¥è¯¢æ—¶ï¼Œæœ€å·¦è¾¹çš„åˆ—ï¼Œä¹Ÿå°±æ˜¯professionå¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™ç´¢å¼•å…¨éƒ¨å¤±æ•ˆã€‚è€Œä¸”ä¸­é—´ä¸èƒ½è·³è¿‡æŸä¸€åˆ—ï¼Œå¦åˆ™è¯¥åˆ—åé¢çš„å­—æ®µç´¢å¼•å°†å¤±æ•ˆã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æ¼”ç¤ºå‡ ç»„æ¡ˆä¾‹ï¼Œçœ‹ä¸€ä¸‹</p><p>å…·ä½“çš„æ‰§è¡Œè®¡åˆ’ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426135401081-e3b725f4.png" alt="image-20220426135401081" style="zoom:50%;"><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">=</span> <span class="token number">31</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426135541380-cb543dc5.png" alt="image-20220426135541380" style="zoom:50%;"><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426135632221-3afb4a5a.png" alt="image-20220426135632221" style="zoom:50%;"><p>ä»¥ä¸Šçš„è¿™ä¸‰ç»„æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å‘ç°åªè¦è”åˆç´¢å¼•æœ€å·¦è¾¹çš„å­—æ®µ professionå­˜åœ¨ï¼Œç´¢å¼•å°±ä¼šç”Ÿæ•ˆï¼Œåªä¸è¿‡ç´¢å¼•çš„é•¿åº¦ä¸åŒã€‚ è€Œä¸”ç”±ä»¥ä¸Šä¸‰ç»„æµ‹è¯•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ¨æµ‹å‡ºprofessionå­—æ®µç´¢å¼•é•¿åº¦ä¸º47ã€ageå­—æ®µç´¢å¼•é•¿åº¦ä¸º2ã€statuså­—æ®µç´¢å¼•é•¿åº¦ä¸º5ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> age <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426135730402-d47d9cdb.png" alt="image-20220426135730402" style="zoom:50%;"><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426135807560-5be4e5ee.png" alt="image-20220426135807560" style="zoom:50%;"><p>è€Œé€šè¿‡ä¸Šé¢çš„è¿™ä¸¤ç»„æµ‹è¯•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ç´¢å¼•å¹¶æœªç”Ÿæ•ˆï¼ŒåŸå› æ˜¯å› ä¸ºä¸æ»¡è¶³æœ€å·¦å‰ç¼€æ³•åˆ™ï¼Œè”åˆç´¢å¼•æœ€å·¦è¾¹çš„åˆ—professionä¸å­˜åœ¨ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426135900534-6d2d7fc3.png" alt="image-20220426135900534" style="zoom:50%;"><p>ä¸Šè¿°çš„SQLæŸ¥è¯¢æ—¶ï¼Œå­˜åœ¨professionå­—æ®µï¼Œæœ€å·¦è¾¹çš„åˆ—æ˜¯å­˜åœ¨çš„ï¼Œç´¢å¼•æ»¡è¶³æœ€å·¦å‰ç¼€æ³•åˆ™çš„åŸºæœ¬æ¡ä»¶ã€‚ä½†æ˜¯æŸ¥è¯¢æ—¶ï¼Œè·³è¿‡äº†ageè¿™ä¸ªåˆ—ï¼Œæ‰€ä»¥åé¢çš„åˆ—ç´¢å¼•æ˜¯ä¸ä¼šä½¿ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•éƒ¨åˆ†ç”Ÿæ•ˆï¼Œæ‰€ä»¥ç´¢å¼•çš„é•¿åº¦å°±æ˜¯47ã€‚</p><blockquote><p>æ€è€ƒé¢˜ï¼š</p><p>å½“æ‰§è¡ŒSQLè¯­å¥: explain select * from tb_user where age = 31 and status = &#39;0&#39; and profession = &#39;è½¯ä»¶å·¥ç¨‹&#39;ï¼› æ—¶ï¼Œæ˜¯å¦æ»¡è¶³æœ€å·¦å‰ç¼€æ³•åˆ™ï¼Œèµ°ä¸èµ°ä¸Šè¿°çš„è”åˆç´¢å¼•ï¼Œç´¢å¼•é•¿åº¦ï¼Ÿ</p><img src="/assets/image-20220426140032442-a644aab8.png" alt="image-20220426140032442" style="zoom:50%;"><p>å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯å®Œå…¨æ»¡è¶³æœ€å·¦å‰ç¼€æ³•åˆ™çš„ï¼Œç´¢å¼•é•¿åº¦54ï¼Œè”åˆç´¢å¼•æ˜¯ç”Ÿæ•ˆçš„ã€‚</p><p>æ³¨æ„ ï¼š æœ€å·¦å‰ç¼€æ³•åˆ™ä¸­æŒ‡çš„æœ€å·¦è¾¹çš„åˆ—ï¼Œæ˜¯æŒ‡åœ¨æŸ¥è¯¢æ—¶ï¼Œè”åˆç´¢å¼•çš„æœ€å·¦è¾¹çš„å­—æ®µ(å³æ˜¯ç¬¬ä¸€ä¸ªå­—æ®µ)å¿…é¡»å­˜åœ¨ï¼Œä¸æˆ‘ä»¬ç¼–å†™SQLæ—¶ï¼Œæ¡ä»¶ç¼–å†™çš„å…ˆåé¡ºåºæ— å…³ã€‚</p></blockquote><h4 id="èŒƒå›´æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#èŒƒå›´æŸ¥è¯¢" aria-hidden="true">#</a> èŒƒå›´æŸ¥è¯¢</h4><p>è”åˆç´¢å¼•ä¸­ï¼Œå‡ºç°èŒƒå›´æŸ¥è¯¢(&gt;,&lt;)ï¼ŒèŒƒå›´æŸ¥è¯¢å³ä¾§çš„åˆ—ç´¢å¼•å¤±æ•ˆã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">&gt;</span> <span class="token number">30</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426140210209-2045af22.png" alt="image-20220426140210209" style="zoom:50%;"><p>å½“èŒƒå›´æŸ¥è¯¢ä½¿ç”¨&gt; æˆ– &lt; æ—¶ï¼Œèµ°è”åˆç´¢å¼•äº†ï¼Œä½†æ˜¯ç´¢å¼•çš„é•¿åº¦ä¸º49ï¼Œå°±è¯´æ˜èŒƒå›´æŸ¥è¯¢å³è¾¹çš„statuså­—æ®µæ˜¯æ²¡æœ‰èµ°ç´¢å¼•çš„ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">&gt;=</span> <span class="token number">30</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ‰€ä»¥ï¼Œåœ¨ä¸šåŠ¡å…è®¸çš„æƒ…å†µä¸‹ï¼Œå°½å¯èƒ½çš„ä½¿ç”¨ç±»ä¼¼äº &gt;= æˆ– &lt;= è¿™ç±»çš„èŒƒå›´æŸ¥è¯¢ï¼Œè€Œé¿å…ä½¿ç”¨ &gt; æˆ– &lt; ã€‚</p><h4 id="ç´¢å¼•å¤±æ•ˆæƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•å¤±æ•ˆæƒ…å†µ" aria-hidden="true">#</a> ç´¢å¼•å¤±æ•ˆæƒ…å†µ</h4><h5 id="ç´¢å¼•åˆ—è¿ç®—" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•åˆ—è¿ç®—" aria-hidden="true">#</a> ç´¢å¼•åˆ—è¿ç®—</h5><p>ä¸è¦åœ¨ç´¢å¼•åˆ—ä¸Šè¿›è¡Œè¿ç®—æ“ä½œï¼Œ ç´¢å¼•å°†å¤±æ•ˆã€‚</p><p>åœ¨tb_userè¡¨ä¸­ï¼Œé™¤äº†å‰é¢ä»‹ç»çš„è”åˆç´¢å¼•ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªç´¢å¼•ï¼Œæ˜¯phoneå­—æ®µçš„å•åˆ—ç´¢å¼•ã€‚</p><p>å½“æ ¹æ®phoneå­—æ®µè¿›è¡Œç­‰å€¼åŒ¹é…æŸ¥è¯¢æ—¶, ç´¢å¼•ç”Ÿæ•ˆã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> phone <span class="token operator">=</span> <span class="token string">&#39;17799990015&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426140525159-119b00fc.png" alt="image-20220426140525159" style="zoom:50%;"><p>å½“æ ¹æ®phoneå­—æ®µè¿›è¡Œå‡½æ•°è¿ç®—æ“ä½œä¹‹åï¼Œç´¢å¼•å¤±æ•ˆã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>explain select * from tb_user where substring(phone,10,2) = &#39;15&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426140602887-29ac60d7.png" alt="image-20220426140602887" style="zoom:50%;"><h5 id="å­—ç¬¦ä¸²ä¸åŠ å¼•å·" tabindex="-1"><a class="header-anchor" href="#å­—ç¬¦ä¸²ä¸åŠ å¼•å·" aria-hidden="true">#</a> å­—ç¬¦ä¸²ä¸åŠ å¼•å·</h5><p>å­—ç¬¦ä¸²ç±»å‹å­—æ®µä½¿ç”¨æ—¶ï¼Œä¸åŠ å¼•å·ï¼Œç´¢å¼•å°†å¤±æ•ˆã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡ä¸¤ç»„ç¤ºä¾‹ï¼Œæ¥çœ‹çœ‹å¯¹äºå­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µï¼ŒåŠ å•å¼•å·ä¸ä¸åŠ å•å¼•å·çš„åŒºåˆ«ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">;</span> 
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220426140707371-96cff37b.png" alt="image-20220426140707371" style="zoom:50%;"><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> phone <span class="token operator">=</span> <span class="token string">&#39;17799990015&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> phone <span class="token operator">=</span> <span class="token number">17799990015</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220426140843786-252895ee.png" alt="image-20220426140843786" style="zoom:50%;"><p>ç»è¿‡ä¸Šé¢ä¸¤ç»„ç¤ºä¾‹ï¼Œæˆ‘ä»¬ä¼šæ˜æ˜¾çš„å‘ç°ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸åŠ å•å¼•å·ï¼Œå¯¹äºæŸ¥è¯¢ç»“æœï¼Œæ²¡ä»€ä¹ˆå½±å“ï¼Œä½†æ˜¯æ•°æ®åº“å­˜åœ¨éšå¼ç±»å‹è½¬æ¢ï¼Œç´¢å¼•å°†å¤±æ•ˆã€‚</p><h5 id="æ¨¡ç³ŠæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#æ¨¡ç³ŠæŸ¥è¯¢" aria-hidden="true">#</a> æ¨¡ç³ŠæŸ¥è¯¢</h5><p>å¦‚æœä»…ä»…æ˜¯å°¾éƒ¨æ¨¡ç³ŠåŒ¹é…ï¼Œç´¢å¼•ä¸ä¼šå¤±æ•ˆã€‚å¦‚æœæ˜¯å¤´éƒ¨æ¨¡ç³ŠåŒ¹é…ï¼Œç´¢å¼•å¤±æ•ˆã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸‰æ¡SQLè¯­å¥çš„æ‰§è¡Œæ•ˆæœï¼ŒæŸ¥çœ‹ä¸€ä¸‹å…¶æ‰§è¡Œè®¡åˆ’ï¼š</p><p>ç”±äºä¸‹é¢æŸ¥è¯¢è¯­å¥ä¸­ï¼Œéƒ½æ˜¯æ ¹æ®professionå­—æ®µæŸ¥è¯¢ï¼Œç¬¦åˆæœ€å·¦å‰ç¼€æ³•åˆ™ï¼Œè”åˆç´¢å¼•æ˜¯å¯ä»¥ç”Ÿæ•ˆçš„ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹ä¸€ä¸‹ï¼Œæ¨¡ç³ŠæŸ¥è¯¢æ—¶ï¼Œ%åŠ åœ¨å…³é”®å­—ä¹‹å‰ï¼Œå’ŒåŠ åœ¨å…³é”®å­—ä¹‹åçš„å½±å“ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">like</span> <span class="token string">&#39;è½¯ä»¶%&#39;</span><span class="token punctuation">;</span> 
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">like</span> <span class="token string">&#39;%å·¥ç¨‹&#39;</span><span class="token punctuation">;</span> 
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">like</span> <span class="token string">&#39;%å·¥%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220426141016243-35069dbc.png" alt="image-20220426141016243" style="zoom:50%;"><p>ç»è¿‡ä¸Šè¿°çš„æµ‹è¯•ï¼Œæˆ‘ä»¬å‘ç°ï¼Œåœ¨likeæ¨¡ç³ŠæŸ¥è¯¢ä¸­ï¼Œåœ¨å…³é”®å­—åé¢åŠ %ï¼Œç´¢å¼•å¯ä»¥ç”Ÿæ•ˆã€‚è€Œå¦‚æœåœ¨å…³é”®å­—å‰é¢åŠ äº†%ï¼Œç´¢å¼•å°†ä¼šå¤±æ•ˆã€‚</p><h5 id="orè¿æ¥æ¡ä»¶" tabindex="-1"><a class="header-anchor" href="#orè¿æ¥æ¡ä»¶" aria-hidden="true">#</a> orè¿æ¥æ¡ä»¶</h5><p>ç”¨oråˆ†å‰²å¼€çš„æ¡ä»¶ï¼Œ å¦‚æœorå‰çš„æ¡ä»¶ä¸­çš„åˆ—æœ‰ç´¢å¼•ï¼Œè€Œåé¢çš„åˆ—ä¸­æ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆæ¶‰åŠçš„ç´¢å¼•éƒ½ä¸ä¼šè¢«ç”¨åˆ°ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">or</span> age <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span> 
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> phone <span class="token operator">=</span> <span class="token string">&#39;17799990017&#39;</span> <span class="token operator">or</span> age <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220426141147408-593d6ad5.png" alt="image-20220426141147408" style="zoom:50%;"><p>ç”±äºageæ²¡æœ‰ç´¢å¼•ï¼Œæ‰€ä»¥å³ä½¿idã€phoneæœ‰ç´¢å¼•ï¼Œç´¢å¼•ä¹Ÿä¼šå¤±æ•ˆã€‚æ‰€ä»¥éœ€è¦é’ˆå¯¹äºageä¹Ÿè¦å»ºç«‹ç´¢å¼•ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ageå­—æ®µå»ºç«‹ç´¢å¼•ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">index</span> idx_user_age <span class="token keyword">on</span> tb_user<span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å»ºç«‹äº†ç´¢å¼•ä¹‹åï¼Œæˆ‘ä»¬å†æ¬¡æ‰§è¡Œä¸Šè¿°çš„SQLè¯­å¥ï¼Œçœ‹çœ‹å‰åæ‰§è¡Œè®¡åˆ’çš„å˜åŒ–ã€‚</p><img src="/assets/image-20220426141312971-d634e89f.png" alt="image-20220426141312971" style="zoom:50%;"><p>æœ€ç»ˆï¼Œæˆ‘ä»¬å‘ç°ï¼Œå½“orè¿æ¥çš„æ¡ä»¶ï¼Œå·¦å³ä¸¤ä¾§å­—æ®µéƒ½æœ‰ç´¢å¼•æ—¶ï¼Œç´¢å¼•æ‰ä¼šç”Ÿæ•ˆã€‚</p><h5 id="æ•°æ®åˆ†å¸ƒå½±å“" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åˆ†å¸ƒå½±å“" aria-hidden="true">#</a> æ•°æ®åˆ†å¸ƒå½±å“</h5><p>å¦‚æœMySQLè¯„ä¼°ä½¿ç”¨ç´¢å¼•æ¯”å…¨è¡¨æ›´æ…¢ï¼Œåˆ™ä¸ä½¿ç”¨ç´¢å¼•ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> phone <span class="token operator">&gt;=</span> <span class="token string">&#39;17799990005&#39;</span><span class="token punctuation">;</span> 
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> phone <span class="token operator">&gt;=</span> <span class="token string">&#39;17799990015&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220426141420100-69b88a8e.png" alt="image-20220426141420100" style="zoom:50%;"><p>ç»è¿‡æµ‹è¯•æˆ‘ä»¬å‘ç°ï¼Œç›¸åŒçš„SQLè¯­å¥ï¼Œåªæ˜¯ä¼ å…¥çš„å­—æ®µå€¼ä¸åŒï¼Œæœ€ç»ˆçš„æ‰§è¡Œè®¡åˆ’ä¹Ÿå®Œå…¨ä¸ä¸€æ ·ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å°±æ˜¯å› ä¸ºMySQLåœ¨æŸ¥è¯¢æ—¶ï¼Œä¼šè¯„ä¼°ä½¿ç”¨ç´¢å¼•çš„æ•ˆç‡ä¸èµ°å…¨è¡¨æ‰«æçš„æ•ˆç‡ï¼Œå¦‚æœèµ°å…¨è¡¨æ‰«ææ›´å¿«ï¼Œåˆ™æ”¾å¼ƒç´¢å¼•ï¼Œèµ°å…¨è¡¨æ‰«æã€‚ å› ä¸ºç´¢å¼•æ˜¯ç”¨æ¥ç´¢å¼•å°‘é‡æ•°æ®çš„ï¼Œå¦‚æœé€šè¿‡ç´¢å¼•æŸ¥è¯¢è¿”å›å¤§æ‰¹é‡çš„æ•°æ®ï¼Œåˆ™è¿˜ä¸å¦‚èµ°å…¨è¡¨æ‰«ææ¥çš„å¿«ï¼Œæ­¤æ—¶ç´¢å¼•å°±ä¼šå¤±æ•ˆã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ is null ä¸ is not null æ“ä½œæ˜¯å¦èµ°ç´¢å¼•ã€‚</p><p>æ‰§è¡Œå¦‚ä¸‹ä¸¤æ¡è¯­å¥ ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span> 
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220426141550959-db102ee6.png" alt="image-20220426141550959" style="zoom:50%;"><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åšä¸€ä¸ªæ“ä½œå°†professionå­—æ®µå€¼å…¨éƒ¨æ›´æ–°ä¸ºnullã€‚ç„¶åï¼Œå†æ¬¡æ‰§è¡Œä¸Šè¿°çš„ä¸¤æ¡SQLï¼ŒæŸ¥çœ‹SQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’ã€‚</p><img src="/assets/image-20220426141639442-d6582ad9.png" alt="image-20220426141639442" style="zoom:50%;"><p>æœ€ç»ˆæˆ‘ä»¬çœ‹åˆ°ï¼Œä¸€æ¨¡ä¸€æ ·çš„SQLè¯­å¥ï¼Œå…ˆåæ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œç»“æœæŸ¥è¯¢è®¡åˆ’æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§ç°è±¡ï¼Œè¿™æ˜¯å’Œæ•°æ®åº“çš„æ•°æ®åˆ†å¸ƒæœ‰å…³ç³»ã€‚æŸ¥è¯¢æ—¶MySQLä¼šè¯„ä¼°ï¼Œèµ°ç´¢å¼•å¿«ï¼Œè¿˜æ˜¯å…¨è¡¨æ‰«æå¿«ï¼Œå¦‚æœå…¨è¡¨æ‰«ææ›´å¿«ï¼Œåˆ™æ”¾å¼ƒç´¢å¼•èµ°å…¨è¡¨æ‰«æã€‚ å› æ­¤ï¼Œis null ã€is not nullæ˜¯å¦èµ°ç´¢å¼•ï¼Œå¾—å…·ä½“æƒ…å†µå…·ä½“åˆ†æï¼Œå¹¶ä¸æ˜¯å›ºå®šçš„ã€‚</p><h4 id="sqlæç¤º" tabindex="-1"><a class="header-anchor" href="#sqlæç¤º" aria-hidden="true">#</a> SQLæç¤º</h4><p>ç›®å‰tb_userè¡¨çš„æ•°æ®æƒ…å†µå¦‚ä¸‹:</p><img src="/assets/image-20220426142000554-132d7559.png" alt="image-20220426142000554" style="zoom:50%;"><p>ç´¢å¼•æƒ…å†µå¦‚ä¸‹:</p><img src="/assets/image-20220426142104568-74064a72.png" alt="image-20220426142104568" style="zoom:50%;"><p>æŠŠä¸Šè¿°çš„ idx_user_age, idx_email è¿™ä¸¤ä¸ªä¹‹å‰æµ‹è¯•ä½¿ç”¨è¿‡çš„ç´¢å¼•ç›´æ¥åˆ é™¤ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>drop index idx_user_age on tb_user; 
drop index idx_email on tb_user;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡ŒSQL : explain select * from tb_user where profession = &#39;è½¯ä»¶å·¥ç¨‹&#39;;</p><img src="/assets/image-20220426144116562-0dd4e247.png" alt="image-20220426144116562" style="zoom:50%;"><p>æŸ¥è¯¢èµ°äº†è”åˆç´¢å¼•ã€‚</p><p>æ‰§è¡ŒSQLï¼Œåˆ›å»ºprofessionçš„å•åˆ—ç´¢å¼•ï¼šcreate index idx_user_pro on tb_user(profession);</p><p>åˆ›å»ºå•åˆ—ç´¢å¼•åï¼Œå†æ¬¡æ‰§è¡ŒAä¸­çš„SQLè¯­å¥ï¼ŒæŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ï¼Œçœ‹çœ‹åˆ°åº•èµ°å“ªä¸ªç´¢å¼•ã€‚</p><img src="/assets/image-20220426144253275-ea7317c4.png" alt="image-20220426144253275" style="zoom:50%;"><p>æµ‹è¯•ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œpossible_keysä¸­ idx_user_pro_age_sta,idx_user_pro è¿™ä¸¤ä¸ªç´¢å¼•éƒ½å¯èƒ½ç”¨åˆ°ï¼Œæœ€ç»ˆMySQLé€‰æ‹©äº†idx_user_pro_age_staç´¢å¼•ã€‚è¿™æ˜¯MySQLè‡ªåŠ¨é€‰æ‹©çš„ç»“æœã€‚</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½åœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œè‡ªå·±æ¥æŒ‡å®šä½¿ç”¨å“ªä¸ªç´¢å¼•å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæ­¤æ—¶å°±å¯ä»¥å€ŸåŠ©äºMySQLçš„SQLæç¤ºæ¥å®Œæˆã€‚ æ¥ä¸‹æ¥ï¼Œä»‹ç»ä¸€ä¸‹SQLæç¤ºã€‚</p><p>SQLæç¤ºï¼Œæ˜¯ä¼˜åŒ–æ•°æ®åº“çš„ä¸€ä¸ªé‡è¦æ‰‹æ®µï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨SQLè¯­å¥ä¸­åŠ å…¥ä¸€äº›äººä¸ºçš„æç¤ºæ¥è¾¾åˆ°ä¼˜åŒ–æ“ä½œçš„ç›®çš„ã€‚</p><p>1). use index ï¼š å»ºè®®MySQLä½¿ç”¨å“ªä¸€ä¸ªç´¢å¼•å®Œæˆæ­¤æ¬¡æŸ¥è¯¢ï¼ˆä»…ä»…æ˜¯å»ºè®®ï¼Œmysqlå†…éƒ¨è¿˜ä¼šå†æ¬¡è¿›è¡Œè¯„ä¼°ï¼‰ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">use</span> <span class="token keyword">index</span><span class="token punctuation">(</span>idx_user_pro<span class="token punctuation">)</span> <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2). ignore index ï¼š å¿½ç•¥æŒ‡å®šçš„ç´¢å¼•ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">ignore</span> <span class="token keyword">index</span><span class="token punctuation">(</span>idx_user_pro<span class="token punctuation">)</span> <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>3). force index ï¼š å¼ºåˆ¶ä½¿ç”¨ç´¢å¼•ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">force</span> <span class="token keyword">index</span><span class="token punctuation">(</span>idx_user_pro<span class="token punctuation">)</span> <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="è¦†ç›–ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#è¦†ç›–ç´¢å¼•" aria-hidden="true">#</a> è¦†ç›–ç´¢å¼•</h4><p>å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œå‡å°‘select *ã€‚ é‚£ä¹ˆä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•å‘¢ï¼Ÿ è¦†ç›–ç´¢å¼•æ˜¯æŒ‡ æŸ¥è¯¢ä½¿ç”¨äº†ç´¢å¼•ï¼Œå¹¶ä¸”éœ€è¦è¿”å›çš„åˆ—ï¼Œåœ¨è¯¥ç´¢å¼•ä¸­å·²ç»å…¨éƒ¨èƒ½å¤Ÿæ‰¾åˆ° ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ç»„SQLçš„æ‰§è¡Œè®¡åˆ’ï¼Œçœ‹çœ‹æ‰§è¡Œè®¡åˆ’çš„å·®åˆ«ï¼Œç„¶åå†æ¥å…·ä½“åšä¸€ä¸ªè§£æã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span> profession <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span> <span class="token punctuation">;</span> 
<span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>profession<span class="token punctuation">,</span>age<span class="token punctuation">,</span> <span class="token keyword">status</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span> <span class="token punctuation">;</span> 
<span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>profession<span class="token punctuation">,</span>age<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">,</span> name <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span> <span class="token punctuation">;</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tb_user <span class="token keyword">where</span> profession <span class="token operator">=</span> <span class="token string">&#39;è½¯ä»¶å·¥ç¨‹&#39;</span> <span class="token operator">and</span> age <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">and</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¿°è¿™å‡ æ¡SQLçš„æ‰§è¡Œç»“æœä¸º:</p><img src="/assets/image-20220426144634023-53f3c7ab.png" alt="image-20220426144634023" style="zoom:50%;"><p>ä»ä¸Šè¿°çš„æ‰§è¡Œè®¡åˆ’æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™å››æ¡SQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’å‰é¢æ‰€æœ‰çš„æŒ‡æ ‡éƒ½æ˜¯ä¸€æ ·çš„ï¼Œçœ‹ä¸å‡ºæ¥å·®å¼‚ã€‚ä½†æ˜¯æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯åé¢çš„Extraï¼Œå‰é¢ä¸¤å¤©SQLçš„ç»“æœä¸º Using where; UsingIndex ; è€Œåé¢ä¸¤æ¡SQLçš„ç»“æœä¸º: Using index condition ã€‚</p><table><thead><tr><th><strong>Extra</strong></th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>Using where; Using Index</td><td>æŸ¥æ‰¾ä½¿ç”¨äº†ç´¢å¼•ï¼Œä½†æ˜¯éœ€è¦çš„æ•°æ®éƒ½åœ¨ç´¢å¼•åˆ—ä¸­èƒ½æ‰¾åˆ°ï¼Œæ‰€ä»¥ä¸éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®</td></tr><tr><td>Using index condition</td><td>æŸ¥æ‰¾ä½¿ç”¨äº†ç´¢å¼•ï¼Œä½†æ˜¯éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®</td></tr></tbody></table><p>å› ä¸ºï¼Œåœ¨tb_userè¡¨ä¸­æœ‰ä¸€ä¸ªè”åˆç´¢å¼• idx_user_pro_age_staï¼Œè¯¥ç´¢å¼•å…³è”äº†ä¸‰ä¸ªå­—æ®µprofessionã€ageã€statusï¼Œè€Œè¿™ä¸ªç´¢å¼•ä¹Ÿæ˜¯ä¸€ä¸ªäºŒçº§ç´¢å¼•ï¼Œæ‰€ä»¥å¶å­èŠ‚ç‚¹ä¸‹é¢æŒ‚çš„æ˜¯è¿™ä¸€è¡Œçš„ä¸»é”®idã€‚ æ‰€ä»¥å½“æˆ‘ä»¬æŸ¥è¯¢è¿”å›çš„æ•°æ®åœ¨ idã€professionã€ageã€status ä¹‹ä¸­ï¼Œåˆ™ç›´æ¥èµ°äºŒçº§ç´¢å¼•ç›´æ¥è¿”å›æ•°æ®äº†ã€‚ å¦‚æœè¶…å‡ºè¿™ä¸ªèŒƒå›´ï¼Œå°±éœ€è¦æ‹¿åˆ°ä¸»é”®idï¼Œå†å»æ‰«æèšé›†ç´¢å¼•ï¼Œå†è·å–é¢å¤–çš„æ•°æ®äº†ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å›è¡¨ã€‚ è€Œæˆ‘ä»¬å¦‚æœä¸€ç›´ä½¿ç”¨select * æŸ¥è¯¢è¿”å›æ‰€æœ‰å­—æ®µå€¼ï¼Œå¾ˆå®¹æ˜“å°±ä¼šé€ æˆå›è¡¨æŸ¥è¯¢ï¼ˆé™¤éæ˜¯æ ¹æ®ä¸»é”®æŸ¥è¯¢ï¼Œæ­¤æ—¶åªä¼šæ‰«æèšé›†ç´¢å¼•ï¼‰ã€‚</p><p>ä¸ºäº†å¤§å®¶æ›´æ¸…æ¥šçš„ç†è§£ï¼Œä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•ï¼Œä»€ä¹ˆæ˜¯å›è¡¨æŸ¥è¯¢ï¼Œæˆ‘ä»¬ä¸€èµ·å†æ¥çœ‹ä¸‹é¢çš„è¿™ç»„SQLçš„æ‰§è¡Œè¿‡ç¨‹ã€‚</p><p>A. è¡¨ç»“æ„åŠç´¢å¼•ç¤ºæ„å›¾:</p><p>idæ˜¯ä¸»é”®ï¼Œæ˜¯ä¸€ä¸ªèšé›†ç´¢å¼•ã€‚ nameå­—æ®µå»ºç«‹äº†æ™®é€šç´¢å¼•ï¼Œæ˜¯ä¸€ä¸ªäºŒçº§ç´¢å¼•ï¼ˆè¾…åŠ©ç´¢å¼•ï¼‰ã€‚</p><img src="/assets/image-20220426144946484-c3a2929c.png" alt="image-20220426144946484" style="zoom:50%;"><p>B. æ‰§è¡ŒSQL : select * from tb_user where id = 2;</p><p>æ ¹æ®idæŸ¥è¯¢ï¼Œç›´æ¥èµ°èšé›†ç´¢å¼•æŸ¥è¯¢ï¼Œä¸€æ¬¡ç´¢å¼•æ‰«æï¼Œç›´æ¥è¿”å›æ•°æ®ï¼Œæ€§èƒ½é«˜ã€‚</p><img src="/assets/image-20220426145016039-f5f5cdd3.png" alt="image-20220426145016039" style="zoom:50%;"><p>C. æ‰§è¡ŒSQLï¼šselet id,name from tb_user where name = &#39;Arm&#39;;</p><p>è™½ç„¶æ˜¯æ ¹æ®nameå­—æ®µæŸ¥è¯¢ï¼ŒæŸ¥è¯¢äºŒçº§ç´¢å¼•ï¼Œä½†æ˜¯ç”±äºæŸ¥è¯¢è¿”å›åœ¨å­—æ®µä¸º idï¼Œnameï¼Œåœ¨nameçš„äºŒçº§ç´¢å¼•ä¸­ï¼Œè¿™ä¸¤ä¸ªå€¼éƒ½æ˜¯å¯ä»¥ç›´æ¥è·å–åˆ°çš„ï¼Œå› ä¸ºè¦†ç›–ç´¢å¼•ï¼Œæ‰€ä»¥ä¸éœ€è¦å›è¡¨æŸ¥è¯¢ï¼Œæ€§èƒ½é«˜ã€‚</p><img src="/assets/image-20220426145143737-8d5a8400.png" alt="image-20220426145143737" style="zoom:50%;"><p>D. æ‰§è¡ŒSQLï¼šselet id,name,gender from tb_user where name = &#39;Arm&#39;;</p><p>ç”±äºåœ¨nameçš„äºŒçº§ç´¢å¼•ä¸­ï¼Œä¸åŒ…å«genderï¼Œæ‰€ä»¥ï¼Œéœ€è¦ä¸¤æ¬¡ç´¢å¼•æ‰«æï¼Œä¹Ÿå°±æ˜¯éœ€è¦å›è¡¨æŸ¥è¯¢ï¼Œæ€§èƒ½ç›¸å¯¹è¾ƒå·®ä¸€ç‚¹ã€‚</p><img src="/assets/image-20220426145216169-bee7dd1f.png" alt="image-20220426145216169" style="zoom:50%;"><blockquote><p>æ€è€ƒé¢˜ï¼š</p><p>ä¸€å¼ è¡¨, æœ‰å››ä¸ªå­—æ®µ(id, username, password, status), ç”±äºæ•°æ®é‡å¤§, éœ€è¦å¯¹ä»¥ä¸‹SQLè¯­å¥è¿›è¡Œä¼˜åŒ–, è¯¥å¦‚ä½•è¿›è¡Œæ‰æ˜¯æœ€ä¼˜æ–¹æ¡ˆ:</p><p>select id,username,password from tb_user where username =&#39;itcast&#39;;</p><p>ç­”æ¡ˆ: é’ˆå¯¹äº username, passwordå»ºç«‹è”åˆç´¢å¼•, sqlä¸º: create index</p><p>idx_user_name_pass on tb_user(username,password);</p><p>è¿™æ ·å¯ä»¥é¿å…ä¸Šè¿°çš„SQLè¯­å¥ï¼Œåœ¨æŸ¥è¯¢çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°å›è¡¨æŸ¥è¯¢ã€‚</p></blockquote><h4 id="å‰ç¼€ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#å‰ç¼€ç´¢å¼•" aria-hidden="true">#</a> å‰ç¼€ç´¢å¼•</h4><p>å½“å­—æ®µç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼ˆvarcharï¼Œtextï¼Œlongtextç­‰ï¼‰æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦ç´¢å¼•å¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¼šè®©ç´¢å¼•å˜å¾—å¾ˆå¤§ï¼ŒæŸ¥è¯¢æ—¶ï¼Œæµªè´¹å¤§é‡çš„ç£ç›˜IOï¼Œ å½±å“æŸ¥è¯¢æ•ˆç‡ã€‚æ­¤æ—¶å¯ä»¥åªå°†å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†å‰ç¼€ï¼Œå»ºç«‹ç´¢å¼•ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§èŠ‚çº¦ç´¢å¼•ç©ºé—´ï¼Œä»è€Œæé«˜ç´¢å¼•æ•ˆç‡ã€‚</p><p><strong>åˆ›å»ºå‰ç¼€ç´¢å¼•çš„è¯­æ³•ï¼š</strong></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>create index idx_xxxx on table_name(column(n)) ;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>å‰ç¼€é•¿åº¦</strong></p><p>å¯ä»¥æ ¹æ®ç´¢å¼•çš„é€‰æ‹©æ€§æ¥å†³å®šï¼Œè€Œé€‰æ‹©æ€§æ˜¯æŒ‡ä¸é‡å¤çš„ç´¢å¼•å€¼ï¼ˆåŸºæ•°ï¼‰å’Œæ•°æ®è¡¨çš„è®°å½•æ€»æ•°çš„æ¯”å€¼ï¼Œç´¢å¼•é€‰æ‹©æ€§è¶Šé«˜åˆ™æŸ¥è¯¢æ•ˆç‡è¶Šé«˜ï¼Œ å”¯ä¸€ç´¢å¼•çš„é€‰æ‹©æ€§æ˜¯1ï¼Œè¿™æ˜¯æœ€å¥½çš„ç´¢å¼•é€‰æ‹©æ€§ï¼Œæ€§èƒ½ä¹Ÿæ˜¯æœ€å¥½çš„ã€‚</p><p><strong>å‰ç¼€ç´¢å¼•çš„æŸ¥è¯¢æµç¨‹</strong></p><img src="/assets/image-20220426145536751-ae0fd661.png" alt="image-20220426145536751" style="zoom:50%;"><h4 id="å•åˆ—ç´¢å¼•ä¸è”åˆç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#å•åˆ—ç´¢å¼•ä¸è”åˆç´¢å¼•" aria-hidden="true">#</a> å•åˆ—ç´¢å¼•ä¸è”åˆç´¢å¼•</h4><p>å•åˆ—ç´¢å¼•ï¼šå³ä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ã€‚</p><p>è”åˆç´¢å¼•ï¼šå³ä¸€ä¸ªç´¢å¼•åŒ…å«äº†å¤šä¸ªåˆ—ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ tb_user è¡¨ä¸­ç›®å‰çš„ç´¢å¼•æƒ…å†µ:</p><img src="/assets/image-20220426145743018-a6dfafde.png" alt="image-20220426145743018" style="zoom:50%;"><p>åœ¨æŸ¥è¯¢å‡ºæ¥çš„ç´¢å¼•ä¸­ï¼Œæ—¢æœ‰å•åˆ—ç´¢å¼•ï¼Œåˆæœ‰è”åˆç´¢å¼•ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æ‰§è¡Œä¸€æ¡SQLè¯­å¥ï¼Œçœ‹çœ‹å…¶æ‰§è¡Œè®¡åˆ’ï¼š</p><img src="/assets/image-20220426145819299-bdbf044f.png" alt="image-20220426145819299" style="zoom:50%;"><p>é€šè¿‡ä¸Šè¿°æ‰§è¡Œè®¡åˆ’æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨andè¿æ¥çš„ä¸¤ä¸ªå­—æ®µ phoneã€nameä¸Šéƒ½æ˜¯æœ‰å•åˆ—ç´¢å¼•çš„ï¼Œä½†æ˜¯æœ€ç»ˆmysqlåªä¼šé€‰æ‹©ä¸€ä¸ªç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªèƒ½èµ°ä¸€ä¸ªå­—æ®µçš„ç´¢å¼•ï¼Œæ­¤æ—¶æ˜¯ä¼šå›è¡¨æŸ¥è¯¢çš„ã€‚</p><p>ç´§æ¥ç€ï¼Œæˆ‘ä»¬å†æ¥åˆ›å»ºä¸€ä¸ªphoneå’Œnameå­—æ®µçš„è”åˆç´¢å¼•æ¥æŸ¥è¯¢ä¸€ä¸‹æ‰§è¡Œè®¡åˆ’ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>create unique index idx_user_phone_name on tb_user(phone,name);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426145904194-90b849d7.png" alt="image-20220426145904194" style="zoom:50%;"><p>æ­¤æ—¶ï¼ŒæŸ¥è¯¢æ—¶ï¼Œå°±èµ°äº†è”åˆç´¢å¼•ï¼Œè€Œåœ¨è”åˆç´¢å¼•ä¸­åŒ…å« phoneã€nameçš„ä¿¡æ¯ï¼Œåœ¨å¶å­èŠ‚ç‚¹ä¸‹æŒ‚çš„æ˜¯å¯¹åº”çš„ä¸»é”®idï¼Œæ‰€ä»¥æŸ¥è¯¢æ˜¯æ— éœ€å›è¡¨æŸ¥è¯¢çš„ã€‚</p><p>å¦‚æœæŸ¥è¯¢ä½¿ç”¨çš„æ˜¯è”åˆç´¢å¼•ï¼Œå…·ä½“çš„ç»“æ„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><img src="/assets/image-20220426145933220-0ff220d2.png" alt="image-20220426145933220" style="zoom:50%;"><h3 id="ç´¢å¼•è®¾è®¡åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•è®¾è®¡åŸåˆ™" aria-hidden="true">#</a> ç´¢å¼•è®¾è®¡åŸåˆ™</h3><p>1). é’ˆå¯¹äºæ•°æ®é‡è¾ƒå¤§ï¼Œä¸”æŸ¥è¯¢æ¯”è¾ƒé¢‘ç¹çš„è¡¨å»ºç«‹ç´¢å¼•ã€‚</p><p>2). é’ˆå¯¹äºå¸¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼ˆwhereï¼‰ã€æ’åºï¼ˆorder byï¼‰ã€åˆ†ç»„ï¼ˆgroup byï¼‰æ“ä½œçš„å­—æ®µå»ºç«‹ç´¢å¼•ã€‚</p><p>3). å°½é‡é€‰æ‹©åŒºåˆ†åº¦é«˜çš„åˆ—ä½œä¸ºç´¢å¼•ï¼Œå°½é‡å»ºç«‹å”¯ä¸€ç´¢å¼•ï¼ŒåŒºåˆ†åº¦è¶Šé«˜ï¼Œä½¿ç”¨ç´¢å¼•çš„æ•ˆç‡è¶Šé«˜ã€‚</p><p>4). å¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µï¼Œå­—æ®µçš„é•¿åº¦è¾ƒé•¿ï¼Œå¯ä»¥é’ˆå¯¹äºå­—æ®µçš„ç‰¹ç‚¹ï¼Œå»ºç«‹å‰ç¼€ç´¢å¼•ã€‚</p><p>5). å°½é‡ä½¿ç”¨è”åˆç´¢å¼•ï¼Œå‡å°‘å•åˆ—ç´¢å¼•ï¼ŒæŸ¥è¯¢æ—¶ï¼Œè”åˆç´¢å¼•å¾ˆå¤šæ—¶å€™å¯ä»¥è¦†ç›–ç´¢å¼•ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œé¿å…å›è¡¨ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p><p>6). è¦æ§åˆ¶ç´¢å¼•çš„æ•°é‡ï¼Œç´¢å¼•å¹¶ä¸æ˜¯å¤šå¤šç›Šå–„ï¼Œç´¢å¼•è¶Šå¤šï¼Œç»´æŠ¤ç´¢å¼•ç»“æ„çš„ä»£ä»·ä¹Ÿå°±è¶Šå¤§ï¼Œä¼šå½±å“å¢åˆ æ”¹çš„æ•ˆç‡ã€‚</p><p>7). å¦‚æœç´¢å¼•åˆ—ä¸èƒ½å­˜å‚¨NULLå€¼ï¼Œè¯·åœ¨åˆ›å»ºè¡¨æ—¶ä½¿ç”¨NOT NULLçº¦æŸå®ƒã€‚å½“ä¼˜åŒ–å™¨çŸ¥é“æ¯åˆ—æ˜¯å¦åŒ…å«NULLå€¼æ—¶ï¼Œå¯ä»¥æ›´å¥½åœ°ç¡®å®šå“ªä¸ªç´¢å¼•æœ€æœ‰æ•ˆåœ°ç”¨äºæŸ¥è¯¢ã€‚</p><h2 id="è¿›é˜¶ç¯‡-sqlä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶ç¯‡-sqlä¼˜åŒ–" aria-hidden="true">#</a> è¿›é˜¶ç¯‡-SQLä¼˜åŒ–</h2><h3 id="æ’å…¥æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ’å…¥æ•°æ®" aria-hidden="true">#</a> <strong>æ’å…¥æ•°æ®</strong></h3><p>ä¸€æ¬¡æ€§æ’å…¥å¤šæ¡è®°å½•ï¼Œå¯ä»¥ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢è¿›è¡Œä¼˜åŒ–</p><ul><li>æ‰¹é‡æ’å…¥æ•°æ®</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">Insert</span> <span class="token keyword">into</span> tb_test <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&#39;Tom&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&#39;Cat&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&#39;Jerry&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>æ‰‹åŠ¨æ§åˆ¶äº‹åŠ¡</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> tb_test <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&#39;Tom&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&#39;Cat&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&#39;Jerry&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> tb_test <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">&#39;Tom&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">&#39;Cat&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">&#39;Jerry&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> tb_test <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">&#39;Tom&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">&#39;Cat&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">&#39;Jerry&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä¸»é”®é¡ºåºæ’å…¥ï¼Œæ€§èƒ½è¦é«˜äºä¹±åºæ’å…¥ã€‚</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ä¸»é”®ä¹±åºæ’å…¥ : 8 1 9 21 88 2 4 15 89 5 7 3 
ä¸»é”®é¡ºåºæ’å…¥ : 1 2 3 4 5 7 8 9 15 21 88 89
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¤§æ‰¹é‡æ’å…¥æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å¤§æ‰¹é‡æ’å…¥æ•°æ®" aria-hidden="true">#</a> å¤§æ‰¹é‡æ’å…¥æ•°æ®</h3><p>å¦‚æœä¸€æ¬¡æ€§éœ€è¦æ’å…¥å¤§æ‰¹é‡æ•°æ®(æ¯”å¦‚: å‡ ç™¾ä¸‡çš„è®°å½•)ï¼Œä½¿ç”¨insertè¯­å¥æ’å…¥æ€§èƒ½è¾ƒä½ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨MySQLæ•°æ®åº“æä¾›çš„loadæŒ‡ä»¤è¿›è¡Œæ’å…¥ã€‚æ“ä½œå¦‚ä¸‹ï¼š</p><img src="/assets/image-20220426150616520-951037ed.png" alt="image-20220426150616520" style="zoom:50%;"><p>å¯ä»¥æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼Œå°†æ•°æ®è„šæœ¬æ–‡ä»¶ä¸­çš„æ•°æ®åŠ è½½åˆ°è¡¨ç»“æ„ä¸­ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- å®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯æ—¶ï¼ŒåŠ ä¸Šå‚æ•° -â€“local-infile </span>
mysql â€“<span class="token operator">-</span><span class="token keyword">local</span><span class="token operator">-</span><span class="token keyword">infile</span> <span class="token operator">-</span>u root <span class="token operator">-</span>p 
<span class="token comment">-- è®¾ç½®å…¨å±€å‚æ•°local_infileä¸º1ï¼Œå¼€å¯ä»æœ¬åœ°åŠ è½½æ–‡ä»¶å¯¼å…¥æ•°æ®çš„å¼€å…³ </span>
<span class="token keyword">set</span> <span class="token keyword">global</span> local_infile <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token comment">-- æ‰§è¡ŒloadæŒ‡ä»¤å°†å‡†å¤‡å¥½çš„æ•°æ®ï¼ŒåŠ è½½åˆ°è¡¨ç»“æ„ä¸­ </span>
<span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> <span class="token keyword">infile</span> <span class="token string">&#39;/root/sql1.log&#39;</span> <span class="token keyword">into</span> <span class="token keyword">table</span> tb_user <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">&#39;,&#39;</span> <span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">&#39;\n&#39;</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¸»é”®ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#ä¸»é”®ä¼˜åŒ–" aria-hidden="true">#</a> ä¸»é”®ä¼˜åŒ–</h3><p>åœ¨ä¸Šä¸€å°èŠ‚ï¼Œæˆ‘ä»¬æåˆ°ï¼Œä¸»é”®é¡ºåºæ’å…¥çš„æ€§èƒ½æ˜¯è¦é«˜äºä¹±åºæ’å…¥çš„ã€‚ è¿™ä¸€å°èŠ‚ï¼Œå°±æ¥ä»‹ç»ä¸€ä¸‹å…·ä½“çš„åŸå› ï¼Œç„¶åå†åˆ†æä¸€ä¸‹ä¸»é”®åˆè¯¥å¦‚ä½•è®¾è®¡ã€‚</p><h4 id="æ•°æ®ç»„ç»‡æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#æ•°æ®ç»„ç»‡æ–¹å¼" aria-hidden="true">#</a> æ•°æ®ç»„ç»‡æ–¹å¼</h4><p>åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼Œè¡¨æ•°æ®éƒ½æ˜¯æ ¹æ®ä¸»é”®é¡ºåºç»„ç»‡å­˜æ”¾çš„ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼çš„è¡¨ç§°ä¸ºç´¢å¼•ç»„ç»‡è¡¨(index organized table IOT)ã€‚</p><img src="/assets/image-20220426150834107-e9fccca2.png" alt="image-20220426150834107" style="zoom:50%;"><p>è¡Œæ•°æ®ï¼Œéƒ½æ˜¯å­˜å‚¨åœ¨èšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šçš„ã€‚è€Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿè®²è§£è¿‡InnoDBçš„é€»è¾‘ç»“æ„å›¾ï¼š</p><img src="/assets/image-20220426150905721-f9df9cb9.png" alt="image-20220426150905721" style="zoom:50%;"><p>åœ¨InnoDBå¼•æ“ä¸­ï¼Œæ•°æ®è¡Œæ˜¯è®°å½•åœ¨é€»è¾‘ç»“æ„ page é¡µä¸­çš„ï¼Œè€Œæ¯ä¸€ä¸ªé¡µçš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œé»˜è®¤16Kã€‚é‚£ä¹Ÿå°±æ„å‘³ç€ï¼Œ ä¸€ä¸ªé¡µä¸­æ‰€å­˜å‚¨çš„è¡Œä¹Ÿæ˜¯æœ‰é™çš„ï¼Œå¦‚æœæ’å…¥çš„æ•°æ®è¡Œrowåœ¨è¯¥é¡µå­˜å‚¨ä¸å°ï¼Œå°†ä¼šå­˜å‚¨åˆ°ä¸‹ä¸€ä¸ªé¡µä¸­ï¼Œé¡µä¸é¡µä¹‹é—´ä¼šé€šè¿‡æŒ‡é’ˆè¿æ¥ã€‚</p><h4 id="é¡µåˆ†è£‚" tabindex="-1"><a class="header-anchor" href="#é¡µåˆ†è£‚" aria-hidden="true">#</a> é¡µåˆ†è£‚</h4><p>é¡µå¯ä»¥ä¸ºç©ºï¼Œä¹Ÿå¯ä»¥å¡«å……ä¸€åŠï¼Œä¹Ÿå¯ä»¥å¡«å……100%ã€‚æ¯ä¸ªé¡µåŒ…å«äº†2-Nè¡Œæ•°æ®(å¦‚æœä¸€è¡Œæ•°æ®è¿‡å¤§ï¼Œä¼šè¡Œæº¢å‡º)ï¼Œæ ¹æ®ä¸»é”®æ’åˆ—ã€‚</p><h5 id="a-ä¸»é”®é¡ºåºæ’å…¥æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#a-ä¸»é”®é¡ºåºæ’å…¥æ•ˆæœ" aria-hidden="true">#</a> A. ä¸»é”®é¡ºåºæ’å…¥æ•ˆæœ</h5><p>â‘ . ä»ç£ç›˜ä¸­ç”³è¯·é¡µï¼Œ ä¸»é”®é¡ºåºæ’å…¥</p><img src="/assets/image-20220426151017038-dbbffc7d.png" alt="image-20220426151017038" style="zoom:50%;"><p>â‘¡. ç¬¬ä¸€ä¸ªé¡µæ²¡æœ‰æ»¡ï¼Œç»§ç»­å¾€ç¬¬ä¸€é¡µæ’å…¥</p><img src="/assets/image-20220426151103028-b4a8100a.png" alt="image-20220426151103028" style="zoom:50%;"><p>â‘¢. å½“ç¬¬ä¸€ä¸ªä¹Ÿå†™æ»¡ä¹‹åï¼Œå†å†™å…¥ç¬¬äºŒä¸ªé¡µï¼Œé¡µä¸é¡µä¹‹é—´ä¼šé€šè¿‡æŒ‡é’ˆè¿æ¥</p><img src="/assets/image-20220426151138823-c5d45d8e.png" alt="image-20220426151138823" style="zoom:50%;"><p>â‘£. å½“ç¬¬äºŒé¡µå†™æ»¡äº†ï¼Œå†å¾€ç¬¬ä¸‰é¡µå†™å…¥</p><img src="/assets/image-20220426151214000-e393c61c.png" alt="image-20220426151214000" style="zoom:50%;"><h5 id="b-ä¸»é”®ä¹±åºæ’å…¥æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#b-ä¸»é”®ä¹±åºæ’å…¥æ•ˆæœ" aria-hidden="true">#</a> B. ä¸»é”®ä¹±åºæ’å…¥æ•ˆæœ</h5><p>â‘ . åŠ å…¥1#,2#é¡µéƒ½å·²ç»å†™æ»¡äº†ï¼Œå­˜æ”¾äº†å¦‚å›¾æ‰€ç¤ºçš„æ•°æ®</p><img src="/assets/image-20220426151343299-ced1e706.png" alt="image-20220426151343299" style="zoom:50%;"><p>â‘¡. æ­¤æ—¶å†æ’å…¥idä¸º50çš„è®°å½•ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆç°è±¡ï¼Œä¼šå†æ¬¡å¼€å¯ä¸€ä¸ªé¡µï¼Œå†™å…¥æ–°çš„é¡µä¸­å—ï¼Ÿ</p><img src="/assets/image-20220426151436767-83d462d3.png" alt="image-20220426151436767" style="zoom:50%;"><p>ä¸ä¼šã€‚å› ä¸ºï¼Œç´¢å¼•ç»“æ„çš„å¶å­èŠ‚ç‚¹æ˜¯æœ‰é¡ºåºçš„ã€‚æŒ‰ç…§é¡ºåºï¼Œåº”è¯¥å­˜å‚¨åœ¨47ä¹‹åã€‚</p><img src="/assets/image-20220426151507616-63aa8459.png" alt="image-20220426151507616" style="zoom:50%;"><p>ä½†æ˜¯47æ‰€åœ¨çš„1#é¡µï¼Œå·²ç»å†™æ»¡äº†ï¼Œå­˜å‚¨ä¸äº†50å¯¹åº”çš„æ•°æ®äº†ã€‚ é‚£ä¹ˆæ­¤æ—¶ä¼šå¼€è¾Ÿä¸€ä¸ªæ–°çš„é¡µ 3#ã€‚</p><img src="/assets/image-20220426151533629-3220c05c.png" alt="image-20220426151533629" style="zoom:50%;"><p>ä½†æ˜¯å¹¶ä¸ä¼šç›´æ¥å°†50å­˜å…¥3#é¡µï¼Œè€Œæ˜¯ä¼šå°†1#é¡µåä¸€åŠçš„æ•°æ®ï¼Œç§»åŠ¨åˆ°3#é¡µï¼Œç„¶ååœ¨3#é¡µï¼Œæ’å…¥50ã€‚</p><img src="/assets/image-20220426151559527-bbeb5d30.png" alt="image-20220426151559527" style="zoom:50%;"><p>ç§»åŠ¨æ•°æ®ï¼Œå¹¶æ’å…¥idä¸º50çš„æ•°æ®ä¹‹åï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œè¿™ä¸‰ä¸ªé¡µä¹‹é—´çš„æ•°æ®é¡ºåºæ˜¯æœ‰é—®é¢˜çš„ã€‚ 1#çš„ä¸‹ä¸€ä¸ªé¡µï¼Œåº”è¯¥æ˜¯3#ï¼Œ 3#çš„ä¸‹ä¸€ä¸ªé¡µæ˜¯2#ã€‚ æ‰€ä»¥ï¼Œæ­¤æ—¶ï¼Œéœ€è¦é‡æ–°è®¾ç½®é“¾è¡¨æŒ‡é’ˆã€‚</p><img src="/assets/image-20220426151629960-575e6bc9.png" alt="image-20220426151629960" style="zoom:50%;"><p>ä¸Šè¿°çš„è¿™ç§ç°è±¡ï¼Œç§°ä¹‹ä¸º &quot;é¡µåˆ†è£‚&quot;ï¼Œæ˜¯æ¯”è¾ƒè€—è´¹æ€§èƒ½çš„æ“ä½œã€‚</p><h4 id="é¡µåˆå¹¶" tabindex="-1"><a class="header-anchor" href="#é¡µåˆå¹¶" aria-hidden="true">#</a> é¡µåˆå¹¶</h4><p>ç›®å‰è¡¨ä¸­å·²æœ‰æ•°æ®çš„ç´¢å¼•ç»“æ„(å¶å­èŠ‚ç‚¹)å¦‚ä¸‹ï¼š</p><img src="/assets/image-20220426151753238-b4f59af9.png" alt="image-20220426151753238" style="zoom:50%;"><p>å½“æˆ‘ä»¬å¯¹å·²æœ‰æ•°æ®è¿›è¡Œåˆ é™¤æ—¶ï¼Œå…·ä½“çš„æ•ˆæœå¦‚ä¸‹:</p><p>å½“åˆ é™¤ä¸€è¡Œè®°å½•æ—¶ï¼Œå®é™…ä¸Šè®°å½•å¹¶æ²¡æœ‰è¢«ç‰©ç†åˆ é™¤ï¼Œåªæ˜¯è®°å½•è¢«æ ‡è®°ï¼ˆflagedï¼‰ä¸ºåˆ é™¤å¹¶ä¸”å®ƒçš„ç©ºé—´å˜å¾—å…è®¸è¢«å…¶ä»–è®°å½•å£°æ˜ä½¿ç”¨ã€‚</p><img src="/assets/image-20220426151816649-5ce2d8ab.png" alt="image-20220426151816649" style="zoom:50%;"><p>å½“æˆ‘ä»¬ç»§ç»­åˆ é™¤2#çš„æ•°æ®è®°å½•</p><img src="/assets/image-20220426151833513-9a94535b.png" alt="image-20220426151833513" style="zoom:50%;"><p>å½“é¡µä¸­åˆ é™¤çš„è®°å½•è¾¾åˆ° MERGE_THRESHOLDï¼ˆé»˜è®¤ä¸ºé¡µçš„50%ï¼‰ï¼ŒInnoDBä¼šå¼€å§‹å¯»æ‰¾æœ€é è¿‘çš„é¡µï¼ˆå‰æˆ–åï¼‰çœ‹çœ‹æ˜¯å¦å¯ä»¥å°†ä¸¤ä¸ªé¡µåˆå¹¶ä»¥ä¼˜åŒ–ç©ºé—´ä½¿ç”¨ã€‚</p><img src="/assets/image-20220426151913875-6dedd36f.png" alt="image-20220426151913875" style="zoom:50%;"><p>åˆ é™¤æ•°æ®ï¼Œå¹¶å°†é¡µåˆå¹¶ä¹‹åï¼Œå†æ¬¡æ’å…¥æ–°çš„æ•°æ®21ï¼Œåˆ™ç›´æ¥æ’å…¥3#é¡µ</p><img src="/assets/image-20220426151931681-83e53da2.png" alt="image-20220426151931681" style="zoom:50%;"><p>è¿™ä¸ªé‡Œé¢æ‰€å‘ç”Ÿçš„åˆå¹¶é¡µçš„è¿™ä¸ªç°è±¡ï¼Œå°±ç§°ä¹‹ä¸º &quot;é¡µåˆå¹¶&quot;ã€‚</p><blockquote><p>çŸ¥è¯†å°è´´å£«ï¼š</p><p>MERGE_THRESHOLDï¼šåˆå¹¶é¡µçš„é˜ˆå€¼ï¼Œå¯ä»¥è‡ªå·±è®¾ç½®ï¼Œåœ¨åˆ›å»ºè¡¨æˆ–è€…åˆ›å»ºç´¢å¼•æ—¶æŒ‡å®šã€‚</p></blockquote><h4 id="ç´¢å¼•è®¾è®¡åŸåˆ™-1" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•è®¾è®¡åŸåˆ™-1" aria-hidden="true">#</a> ç´¢å¼•è®¾è®¡åŸåˆ™</h4><ul><li><p>æ»¡è¶³ä¸šåŠ¡éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œå°½é‡é™ä½ä¸»é”®çš„é•¿åº¦ã€‚</p></li><li><p>æ’å…¥æ•°æ®æ—¶ï¼Œå°½é‡é€‰æ‹©é¡ºåºæ’å…¥ï¼Œé€‰æ‹©ä½¿ç”¨AUTO_INCREMENTè‡ªå¢ä¸»é”®ã€‚</p></li><li><p>å°½é‡ä¸è¦ä½¿ç”¨UUIDåšä¸»é”®æˆ–è€…æ˜¯å…¶ä»–è‡ªç„¶ä¸»é”®ï¼Œå¦‚èº«ä»½è¯å·ã€‚</p></li><li><p>ä¸šåŠ¡æ“ä½œæ—¶ï¼Œé¿å…å¯¹ä¸»é”®çš„ä¿®æ”¹ã€‚</p></li></ul><img src="/assets/image-20220426152045680-9a51fd9d.png" alt="image-20220426152045680" style="zoom:50%;"><h3 id="order-by-ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#order-by-ä¼˜åŒ–" aria-hidden="true">#</a> order by ä¼˜åŒ–</h3><p>MySQLçš„æ’åºï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p><strong>Using filesort :</strong> é€šè¿‡è¡¨çš„ç´¢å¼•æˆ–å…¨è¡¨æ‰«æï¼Œè¯»å–æ»¡è¶³æ¡ä»¶çš„æ•°æ®è¡Œï¼Œç„¶ååœ¨æ’åºç¼“å†²åŒºsort bufferä¸­å®Œæˆæ’åºæ“ä½œï¼Œæ‰€æœ‰ä¸æ˜¯é€šè¿‡ç´¢å¼•ç›´æ¥è¿”å›æ’åºç»“æœçš„æ’åºéƒ½å« FileSort æ’åºã€‚</p><p><strong>Using index :</strong> é€šè¿‡æœ‰åºç´¢å¼•é¡ºåºæ‰«æç›´æ¥è¿”å›æœ‰åºæ•°æ®ï¼Œè¿™ç§æƒ…å†µå³ä¸º using indexï¼Œä¸éœ€è¦é¢å¤–æ’åºï¼Œæ“ä½œæ•ˆç‡é«˜ã€‚</p><p>å¯¹äºä»¥ä¸Šçš„ä¸¤ç§æ’åºæ–¹å¼ï¼ŒUsing indexçš„æ€§èƒ½é«˜ï¼Œè€ŒUsing filesortçš„æ€§èƒ½ä½ï¼Œæˆ‘ä»¬åœ¨ä¼˜åŒ–æ’åºæ“ä½œæ—¶ï¼Œå°½é‡è¦ä¼˜åŒ–ä¸º Using indexã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥åšä¸€ä¸ªæµ‹è¯•ï¼š</p><h4 id="æŸ¥çœ‹ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹ç´¢å¼•" aria-hidden="true">#</a> æŸ¥çœ‹ç´¢å¼•</h4><img src="/assets/image-20220426152313693-98b76006.png" alt="image-20220426152313693" style="zoom:50%;"><h4 id="æ‰§è¡Œæ’åºsql" tabindex="-1"><a class="header-anchor" href="#æ‰§è¡Œæ’åºsql" aria-hidden="true">#</a> æ‰§è¡Œæ’åºSQL</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>age<span class="token punctuation">,</span>phone <span class="token keyword">from</span> tb_user <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426152358277-fab69bc9.png" alt="image-20220426152358277" style="zoom:50%;"><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>age<span class="token punctuation">,</span>phone <span class="token keyword">from</span> tb_user <span class="token keyword">order</span> <span class="token keyword">by</span> age<span class="token punctuation">,</span> phone <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426152439578-b012ce00.png" alt="image-20220426152439578" style="zoom:50%;"><p>ç”±äº age, phone éƒ½æ²¡æœ‰ç´¢å¼•ï¼Œæ‰€ä»¥æ­¤æ—¶å†æ’åºæ—¶ï¼Œå‡ºç°Using filesortï¼Œ æ’åºæ€§èƒ½è¾ƒä½ã€‚</p><h4 id="åˆ›å»ºç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºç´¢å¼•" aria-hidden="true">#</a> åˆ›å»ºç´¢å¼•</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- åˆ›å»ºç´¢å¼• </span>
<span class="token keyword">create</span> <span class="token keyword">index</span> idx_user_age_phone_aa <span class="token keyword">on</span> tb_user<span class="token punctuation">(</span>age<span class="token punctuation">,</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ‰§è¡Œå‡åºæ’åº" tabindex="-1"><a class="header-anchor" href="#æ‰§è¡Œå‡åºæ’åº" aria-hidden="true">#</a> æ‰§è¡Œå‡åºæ’åº</h4><p>åˆ›å»ºç´¢å¼•åï¼Œæ ¹æ®age, phoneè¿›è¡Œå‡åºæ’åº</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>age<span class="token punctuation">,</span>phone <span class="token keyword">from</span> tb_user <span class="token keyword">order</span> <span class="token keyword">by</span> age<span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426153204338-0040b11e.png" alt="image-20220426153204338" style="zoom:50%;"><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>age<span class="token punctuation">,</span>phone <span class="token keyword">from</span> tb_user <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token punctuation">,</span> phone<span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426153230444-623dd994.png" alt="image-20220426153230444" style="zoom:50%;"><p>å»ºç«‹ç´¢å¼•ä¹‹åï¼Œå†æ¬¡è¿›è¡Œæ’åºæŸ¥è¯¢ï¼Œå°±ç”±åŸæ¥çš„Using filesortï¼Œ å˜ä¸ºäº† Using indexï¼Œæ€§èƒ½å°±æ˜¯æ¯”è¾ƒé«˜çš„äº†ã€‚</p><h4 id="è¿›è¡Œé™åºæ’åº" tabindex="-1"><a class="header-anchor" href="#è¿›è¡Œé™åºæ’åº" aria-hidden="true">#</a> è¿›è¡Œé™åºæ’åº</h4><p>åˆ›å»ºç´¢å¼•åï¼Œæ ¹æ®age, phoneè¿›è¡Œé™åºæ’åº</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>age<span class="token punctuation">,</span>phone <span class="token keyword">from</span> tb_user <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token keyword">desc</span> <span class="token punctuation">,</span> phone <span class="token keyword">desc</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426153351875-33c2723d.png" alt="image-20220426153351875" style="zoom:50%;"><p>ä¹Ÿå‡ºç° Using indexï¼Œ ä½†æ˜¯æ­¤æ—¶Extraä¸­å‡ºç°äº† Backward index scanï¼Œè¿™ä¸ªä»£è¡¨åå‘æ‰«æç´¢å¼•ï¼Œå› ä¸ºåœ¨MySQLä¸­æˆ‘ä»¬åˆ›å»ºçš„ç´¢å¼•ï¼Œé»˜è®¤ç´¢å¼•çš„å¶å­èŠ‚ç‚¹æ˜¯ä»å°åˆ°å¤§æ’åºçš„ï¼Œè€Œæ­¤æ—¶æˆ‘ä»¬æŸ¥è¯¢æ’åºæ—¶ï¼Œæ˜¯ä»å¤§åˆ°å°ï¼Œæ‰€ä»¥ï¼Œåœ¨æ‰«ææ—¶ï¼Œå°±æ˜¯åå‘æ‰«æï¼Œå°±ä¼šå‡ºç° Backward index scanã€‚ åœ¨MySQL8ç‰ˆæœ¬ä¸­ï¼Œæ”¯æŒé™åºç´¢å¼•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºé™åºç´¢å¼•ã€‚</p><h4 id="å¤±æ•ˆæƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#å¤±æ•ˆæƒ…å†µ" aria-hidden="true">#</a> å¤±æ•ˆæƒ…å†µ</h4><p>æ ¹æ®phoneï¼Œageè¿›è¡Œå‡åºæ’åºï¼Œphoneåœ¨å‰ï¼Œageåœ¨åã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>age<span class="token punctuation">,</span>phone <span class="token keyword">from</span> tb_user <span class="token keyword">order</span> <span class="token keyword">by</span> phone <span class="token punctuation">,</span> age<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426153508957-bbbfc419.png" alt="image-20220426153508957" style="zoom:50%;"><p>æ’åºæ—¶,ä¹Ÿéœ€è¦æ»¡è¶³æœ€å·¦å‰ç¼€æ³•åˆ™,å¦åˆ™ä¹Ÿä¼šå‡ºç° filesortã€‚å› ä¸ºåœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™ï¼Œ ageæ˜¯ç¬¬ä¸€ä¸ªå­—æ®µï¼Œphoneæ˜¯ç¬¬äºŒä¸ªå­—æ®µï¼Œæ‰€ä»¥æ’åºæ—¶ï¼Œä¹Ÿå°±è¯¥æŒ‰ç…§è¿™ä¸ªé¡ºåºæ¥ï¼Œå¦åˆ™å°±ä¼šå‡ºç° Using filesortã€‚</p><p>æ ¹æ®age, phoneè¿›è¡Œé™åºä¸€ä¸ªå‡åºï¼Œä¸€ä¸ªé™åº</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>age<span class="token punctuation">,</span>phone <span class="token keyword">from</span> tb_user <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token keyword">asc</span> <span class="token punctuation">,</span> phone <span class="token keyword">desc</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426153619040-9062fd65.png" alt="image-20220426153619040" style="zoom:50%;"><p>å› ä¸ºåˆ›å»ºç´¢å¼•æ—¶ï¼Œå¦‚æœæœªæŒ‡å®šé¡ºåºï¼Œé»˜è®¤éƒ½æ˜¯æŒ‰ç…§å‡åºæ’åºçš„ï¼Œè€ŒæŸ¥è¯¢æ—¶ï¼Œä¸€ä¸ªå‡åºï¼Œä¸€ä¸ªé™åºï¼Œæ­¤æ—¶å°±ä¼šå‡ºç°Using filesortã€‚</p><p>ä¸ºäº†è§£å†³ä¸Šè¿°çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œè¿™ä¸ªè”åˆç´¢å¼•ä¸­ age å‡åºæ’åºï¼Œphone å€’åºæ’åºã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">index</span> idx_user_age_phone_ad <span class="token keyword">on</span> tb_user<span class="token punctuation">(</span>age <span class="token keyword">asc</span> <span class="token punctuation">,</span>phone <span class="token keyword">desc</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å‡åº/é™åºè”åˆç´¢å¼•ç»“æ„å›¾ç¤º:</p><img src="/assets/image-20220426153729688-340b4932.png" alt="image-20220426153729688" style="zoom:50%;"><img src="/assets/image-20220426153740747-b56a2288.png" alt="image-20220426153740747" style="zoom:50%;"><h4 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h4><p>ç”±ä¸Šè¿°çš„æµ‹è¯•,æˆ‘ä»¬å¾—å‡ºorder byä¼˜åŒ–åŸåˆ™:</p><p>A. æ ¹æ®æ’åºå­—æ®µå»ºç«‹åˆé€‚çš„ç´¢å¼•ï¼Œå¤šå­—æ®µæ’åºæ—¶ï¼Œä¹Ÿéµå¾ªæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚</p><p>B. å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•ã€‚</p><p>C. å¤šå­—æ®µæ’åº, ä¸€ä¸ªå‡åºä¸€ä¸ªé™åºï¼Œæ­¤æ—¶éœ€è¦æ³¨æ„è”åˆç´¢å¼•åœ¨åˆ›å»ºæ—¶çš„è§„åˆ™ï¼ˆASC/DESCï¼‰ã€‚</p><p>D. å¦‚æœä¸å¯é¿å…çš„å‡ºç°filesortï¼Œå¤§æ•°æ®é‡æ’åºæ—¶ï¼Œå¯ä»¥é€‚å½“å¢å¤§æ’åºç¼“å†²åŒºå¤§å°sort_buffer_size(é»˜è®¤256k)ã€‚</p><h3 id="group-by-ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#group-by-ä¼˜åŒ–" aria-hidden="true">#</a> group by ä¼˜åŒ–</h3><p>åˆ†ç»„æ“ä½œï¼Œæˆ‘ä»¬ä¸»è¦æ¥çœ‹çœ‹ç´¢å¼•å¯¹äºåˆ†ç»„æ“ä½œçš„å½±å“ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å…ˆå°† tb_user è¡¨çš„ç´¢å¼•å…¨éƒ¨åˆ é™¤æ‰ ã€‚</p><img src="/assets/image-20220426154028829-1c0199fe.png" alt="image-20220426154028829" style="zoom:50%;"><p>æ¥ä¸‹æ¥ï¼Œåœ¨æ²¡æœ‰ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œå¦‚ä¸‹SQLï¼ŒæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> profession <span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> tb_user <span class="token keyword">group</span> <span class="token keyword">by</span> profession <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426154100621-970563c5.png" alt="image-20220426154100621" style="zoom:50%;"><p>ç„¶åï¼Œæˆ‘ä»¬åœ¨é’ˆå¯¹äº profession ï¼Œ ageï¼Œ status åˆ›å»ºä¸€ä¸ªè”åˆç´¢å¼•ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">index</span> idx_user_pro_age_sta <span class="token keyword">on</span> tb_user<span class="token punctuation">(</span>profession <span class="token punctuation">,</span> age <span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç´§æ¥ç€ï¼Œå†æ‰§è¡Œå‰é¢ç›¸åŒçš„SQLæŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">select</span> profession <span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> tb_user <span class="token keyword">group</span> <span class="token keyword">by</span> profession <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220426154150695-62c16642.png" alt="image-20220426154150695" style="zoom:50%;"><img src="/assets/image-20220426154257324-2ec9fa27.png" alt="image-20220426154257324" style="zoom:50%;"><img src="/assets/image-20220426154316395-2136ce3d.png" alt="image-20220426154316395" style="zoom:50%;"><p>æˆ‘ä»¬å‘ç°ï¼Œå¦‚æœä»…ä»…æ ¹æ®ageåˆ†ç»„ï¼Œå°±ä¼šå‡ºç° Using temporary ï¼›è€Œå¦‚æœæ˜¯ æ ¹æ®profession,ageä¸¤ä¸ªå­—æ®µåŒæ—¶åˆ†ç»„ï¼Œåˆ™ä¸ä¼šå‡ºç° Using temporaryã€‚åŸå› æ˜¯å› ä¸ºå¯¹äºåˆ†ç»„æ“ä½œï¼Œåœ¨è”åˆç´¢å¼•ä¸­ï¼Œä¹Ÿæ˜¯ç¬¦åˆæœ€å·¦å‰ç¼€æ³•åˆ™çš„ã€‚</p><h5 id="æ€»ç»“-1" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“-1" aria-hidden="true">#</a> æ€»ç»“ï¼š</h5><p>æ‰€ä»¥ï¼Œåœ¨åˆ†ç»„æ“ä½œä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ä»¥ä¸‹ä¸¤ç‚¹è¿›è¡Œä¼˜åŒ–ï¼Œä»¥æå‡æ€§èƒ½ï¼š</p><ul><li><p>åœ¨åˆ†ç»„æ“ä½œæ—¶ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•æ¥æé«˜æ•ˆç‡ã€‚</p></li><li><p>åˆ†ç»„æ“ä½œæ—¶ï¼Œç´¢å¼•çš„ä½¿ç”¨ä¹Ÿæ˜¯æ»¡è¶³æœ€å·¦å‰ç¼€æ³•åˆ™çš„ã€‚</p></li></ul><h3 id="limitä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#limitä¼˜åŒ–" aria-hidden="true">#</a> limitä¼˜åŒ–</h3><p>åœ¨æ•°æ®é‡æ¯”è¾ƒå¤§æ—¶ï¼Œå¦‚æœè¿›è¡Œlimitåˆ†é¡µæŸ¥è¯¢ï¼Œåœ¨æŸ¥è¯¢æ—¶ï¼Œè¶Šå¾€åï¼Œåˆ†é¡µæŸ¥è¯¢æ•ˆç‡è¶Šä½ã€‚</p><p>æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹æ‰§è¡Œlimitåˆ†é¡µæŸ¥è¯¢è€—æ—¶å¯¹æ¯”ï¼š</p><img src="/assets/image-20220426154659445-d1ecc663.png" alt="image-20220426154659445" style="zoom:50%;"><p>é€šè¿‡æµ‹è¯•æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œè¶Šå¾€åï¼Œåˆ†é¡µæŸ¥è¯¢æ•ˆç‡è¶Šä½ï¼Œè¿™å°±æ˜¯åˆ†é¡µæŸ¥è¯¢çš„é—®é¢˜æ‰€åœ¨ã€‚</p><p>å› ä¸ºï¼Œå½“åœ¨è¿›è¡Œåˆ†é¡µæŸ¥è¯¢æ—¶ï¼Œå¦‚æœæ‰§è¡Œ limit 2000000,10 ï¼Œæ­¤æ—¶éœ€è¦MySQLæ’åºå‰2000010 è®°å½•ï¼Œä»…ä»…è¿”å› 2000000 - 2000010 çš„è®°å½•ï¼Œå…¶ä»–è®°å½•ä¸¢å¼ƒï¼ŒæŸ¥è¯¢æ’åºçš„ä»£ä»·éå¸¸å¤§ ã€‚</p><p>ä¼˜åŒ–æ€è·¯: ä¸€èˆ¬åˆ†é¡µæŸ¥è¯¢æ—¶ï¼Œé€šè¿‡åˆ›å»º è¦†ç›–ç´¢å¼• èƒ½å¤Ÿæ¯”è¾ƒå¥½åœ°æé«˜æ€§èƒ½ï¼Œå¯ä»¥é€šè¿‡è¦†ç›–ç´¢å¼•åŠ å­æŸ¥è¯¢å½¢å¼è¿›è¡Œä¼˜åŒ–ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>explain select * from tb_sku t , (select id from tb_sku order by id limit 2000000,10) a where t.id = a.id;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="countä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#countä¼˜åŒ–" aria-hidden="true">#</a> countä¼˜åŒ–</h3><p>åœ¨æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœæ•°æ®é‡å¾ˆå¤§ï¼Œåœ¨æ‰§è¡Œcountæ“ä½œæ—¶ï¼Œæ˜¯éå¸¸è€—æ—¶çš„ã€‚</p><ul><li><p>MyISAM å¼•æ“æŠŠä¸€ä¸ªè¡¨çš„æ€»è¡Œæ•°å­˜åœ¨äº†ç£ç›˜ä¸Šï¼Œå› æ­¤æ‰§è¡Œ count(*) çš„æ—¶å€™ä¼šç›´æ¥è¿”å›è¿™ä¸ªæ•°ï¼Œæ•ˆç‡å¾ˆé«˜ï¼› ä½†æ˜¯å¦‚æœæ˜¯å¸¦æ¡ä»¶çš„countï¼ŒMyISAMä¹Ÿæ…¢ã€‚</p></li><li><p>InnoDB å¼•æ“å°±éº»çƒ¦äº†ï¼Œå®ƒæ‰§è¡Œ count(*) çš„æ—¶å€™ï¼Œéœ€è¦æŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œåœ°ä»å¼•æ“é‡Œé¢è¯»å‡ºæ¥ï¼Œç„¶åç´¯ç§¯è®¡æ•°ã€‚</p></li></ul><p>å¦‚æœè¯´è¦å¤§å¹…åº¦æå‡InnoDBè¡¨çš„countæ•ˆç‡ï¼Œä¸»è¦çš„ä¼˜åŒ–æ€è·¯ï¼šè‡ªå·±è®¡æ•°(å¯ä»¥å€ŸåŠ©äºredisè¿™æ ·çš„æ•°æ®åº“è¿›è¡Œ,ä½†æ˜¯å¦‚æœæ˜¯å¸¦æ¡ä»¶çš„countåˆæ¯”è¾ƒéº»çƒ¦äº†)ã€‚</p><h4 id="countç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#countç”¨æ³•" aria-hidden="true">#</a> countç”¨æ³•</h4><p>count() æ˜¯ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œå¯¹äºè¿”å›çš„ç»“æœé›†ï¼Œä¸€è¡Œè¡Œåœ°åˆ¤æ–­ï¼Œå¦‚æœ count å‡½æ•°çš„å‚æ•°ä¸æ˜¯NULLï¼Œç´¯è®¡å€¼å°±åŠ  1ï¼Œå¦åˆ™ä¸åŠ ï¼Œæœ€åè¿”å›ç´¯è®¡å€¼ã€‚</p><p>ç”¨æ³•ï¼šcountï¼ˆ*ï¼‰ã€countï¼ˆä¸»é”®ï¼‰ã€countï¼ˆå­—æ®µï¼‰ã€countï¼ˆæ•°å­—ï¼‰</p><table><thead><tr><th>countç”¨æ³•</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>count(ä¸»é”®)</td><td>InnoDB å¼•æ“ä¼šéå†æ•´å¼ è¡¨ï¼ŒæŠŠæ¯ä¸€è¡Œçš„ ä¸»é”®id å€¼éƒ½å–å‡ºæ¥ï¼Œè¿”å›ç»™æœåŠ¡å±‚ã€‚æœåŠ¡å±‚æ‹¿åˆ°ä¸»é”®åï¼Œç›´æ¥æŒ‰è¡Œè¿›è¡Œç´¯åŠ (ä¸»é”®ä¸å¯èƒ½ä¸ºnull)</td></tr><tr><td>count(å­—æ®µ)</td><td>æ²¡æœ‰not null çº¦æŸ : InnoDB å¼•æ“ä¼šéå†æ•´å¼ è¡¨æŠŠæ¯ä¸€è¡Œçš„å­—æ®µå€¼éƒ½å–å‡ºæ¥ï¼Œè¿”å›ç»™æœåŠ¡å±‚ï¼ŒæœåŠ¡å±‚åˆ¤æ–­æ˜¯å¦ä¸ºnullï¼Œä¸ä¸ºnullï¼Œè®¡æ•°ç´¯åŠ ã€‚æœ‰not null çº¦æŸï¼šInnoDB å¼•æ“ä¼šéå†æ•´å¼ è¡¨æŠŠæ¯ä¸€è¡Œçš„å­—æ®µå€¼éƒ½å–å‡ºæ¥ï¼Œè¿”å›ç»™æœåŠ¡å±‚ï¼Œç›´æ¥æŒ‰è¡Œè¿›è¡Œç´¯åŠ ã€‚</td></tr><tr><td>count(æ•°å­—)</td><td>InnoDB å¼•æ“éå†æ•´å¼ è¡¨ï¼Œä½†ä¸å–å€¼ã€‚æœåŠ¡å±‚å¯¹äºè¿”å›çš„æ¯ä¸€è¡Œï¼Œæ”¾ä¸€ä¸ªæ•°å­—â€œ1â€è¿›å»ï¼Œç›´æ¥æŒ‰è¡Œè¿›è¡Œç´¯åŠ ã€‚</td></tr><tr><td>count(*)</td><td>InnoDBå¼•æ“å¹¶ä¸ä¼šæŠŠå…¨éƒ¨å­—æ®µå–å‡ºæ¥ï¼Œè€Œæ˜¯ä¸“é—¨åšäº†ä¼˜åŒ–ï¼Œä¸å–å€¼ï¼ŒæœåŠ¡å±‚ç›´æ¥æŒ‰è¡Œè¿›è¡Œç´¯åŠ ã€‚</td></tr></tbody></table><blockquote><p>æŒ‰ç…§æ•ˆç‡æ’åºçš„è¯ï¼Œcount(å­—æ®µ) &lt; count(ä¸»é”® id) &lt; count(1) â‰ˆ count(*)ï¼Œ</p><p>æ‰€ä»¥å°½é‡ä½¿ç”¨ count(*)ã€‚</p></blockquote><h3 id="updateä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#updateä¼˜åŒ–" aria-hidden="true">#</a> updateä¼˜åŒ–</h3><p>æˆ‘ä»¬ä¸»è¦éœ€è¦æ³¨æ„ä¸€ä¸‹updateè¯­å¥æ‰§è¡Œæ—¶çš„æ³¨æ„äº‹é¡¹ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>update course set name = &#39;javaEE&#39; where id = 1 ;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å½“æˆ‘ä»¬åœ¨æ‰§è¡Œåˆ é™¤çš„SQLè¯­å¥æ—¶ï¼Œä¼šé”å®šidä¸º1è¿™ä¸€è¡Œçš„æ•°æ®ï¼Œç„¶åäº‹åŠ¡æäº¤ä¹‹åï¼Œè¡Œé”é‡Šæ”¾ã€‚</p><p>ä½†æ˜¯å½“æˆ‘ä»¬åœ¨æ‰§è¡Œå¦‚ä¸‹SQLæ—¶ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>update course set name = &#39;SpringBoot&#39; where name = &#39;PHP&#39; ;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å½“æˆ‘ä»¬å¼€å¯å¤šä¸ªäº‹åŠ¡ï¼Œåœ¨æ‰§è¡Œä¸Šè¿°çš„SQLæ—¶ï¼Œæˆ‘ä»¬å‘ç°è¡Œé”å‡çº§ä¸ºäº†è¡¨é”ã€‚ å¯¼è‡´è¯¥updateè¯­å¥çš„æ€§èƒ½å¤§å¤§é™ä½ã€‚</p><blockquote><p>InnoDBçš„è¡Œé”æ˜¯é’ˆå¯¹ç´¢å¼•åŠ çš„é”ï¼Œä¸æ˜¯é’ˆå¯¹è®°å½•åŠ çš„é” ,å¹¶ä¸”è¯¥ç´¢å¼•ä¸èƒ½å¤±æ•ˆï¼Œå¦åˆ™ä¼šä»è¡Œé”å‡çº§ä¸ºè¡¨é” ã€‚</p></blockquote><h2 id="è¿›é˜¶ç¯‡-è§†å›¾-å­˜å‚¨-è§¦å‘å™¨" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶ç¯‡-è§†å›¾-å­˜å‚¨-è§¦å‘å™¨" aria-hidden="true">#</a> è¿›é˜¶ç¯‡-è§†å›¾/å­˜å‚¨/è§¦å‘å™¨</h2><p>TODO</p><h2 id="è¿›é˜¶ç¯‡-é”" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶ç¯‡-é”" aria-hidden="true">#</a> è¿›é˜¶ç¯‡-é”</h2><p>é”æ˜¯è®¡ç®—æœºåè°ƒå¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹å¹¶å‘è®¿é—®æŸä¸€èµ„æºçš„æœºåˆ¶ã€‚åœ¨æ•°æ®åº“ä¸­ï¼Œé™¤ä¼ ç»Ÿçš„è®¡ç®—èµ„æºï¼ˆCPUã€RAMã€I/Oï¼‰çš„äº‰ç”¨ä»¥å¤–ï¼Œæ•°æ®ä¹Ÿæ˜¯ä¸€ç§ä¾›è®¸å¤šç”¨æˆ·å…±äº«çš„èµ„æºã€‚å¦‚ä½•ä¿è¯æ•°æ®å¹¶å‘è®¿é—®çš„ä¸€è‡´æ€§ã€æœ‰æ•ˆæ€§æ˜¯æ‰€æœ‰æ•°æ®åº“å¿…é¡»è§£å†³çš„ä¸€ä¸ªé—®é¢˜ï¼Œé”å†²çªä¹Ÿæ˜¯å½±å“æ•°æ®åº“å¹¶å‘è®¿é—®æ€§èƒ½çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚ä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼Œé”å¯¹æ•°æ®åº“è€Œè¨€æ˜¾å¾—å°¤å…¶é‡è¦ï¼Œä¹Ÿæ›´åŠ å¤æ‚ã€‚</p><p>MySQLä¸­çš„é”ï¼ŒæŒ‰ç…§é”çš„ç²’åº¦åˆ†ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š</p><ul><li><p>å…¨å±€é”ï¼šé”å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ã€‚</p></li><li><p>è¡¨çº§é”ï¼šæ¯æ¬¡æ“ä½œé”ä½æ•´å¼ è¡¨ã€‚</p></li><li><p>è¡Œçº§é”ï¼šæ¯æ¬¡æ“ä½œé”ä½å¯¹åº”çš„è¡Œæ•°æ®ã€‚</p></li></ul><h3 id="å…¨å±€é”" tabindex="-1"><a class="header-anchor" href="#å…¨å±€é”" aria-hidden="true">#</a> å…¨å±€é”</h3><p>å…¨å±€é”å°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ï¼ŒåŠ é”åæ•´ä¸ªå®ä¾‹å°±å¤„äºåªè¯»çŠ¶æ€ï¼Œåç»­çš„DMLçš„å†™è¯­å¥ï¼ŒDDLè¯­å¥ï¼Œå·²ç»æ›´æ–°æ“ä½œçš„äº‹åŠ¡æäº¤è¯­å¥éƒ½å°†è¢«é˜»å¡ã€‚</p><p>å…¶å…¸å‹çš„ä½¿ç”¨åœºæ™¯æ˜¯åšå…¨åº“çš„é€»è¾‘å¤‡ä»½ï¼Œå¯¹æ‰€æœ‰çš„è¡¨è¿›è¡Œé”å®šï¼Œä»è€Œè·å–ä¸€è‡´æ€§è§†å›¾ï¼Œä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚</p><p>ä¸ºä»€ä¹ˆå…¨åº“é€»è¾‘å¤‡ä»½ï¼Œå°±éœ€è¦åŠ å…¨å°±é”å‘¢ï¼Ÿ</p><p><strong>A. æˆ‘ä»¬ä¸€èµ·å…ˆæ¥åˆ†æä¸€ä¸‹ä¸åŠ å…¨å±€é”ï¼Œå¯èƒ½å­˜åœ¨çš„é—®é¢˜ã€‚</strong></p><p>å‡è®¾åœ¨æ•°æ®åº“ä¸­å­˜åœ¨è¿™æ ·ä¸‰å¼ è¡¨: tb_stock åº“å­˜è¡¨ï¼Œtb_order è®¢å•è¡¨ï¼Œtb_orderlog è®¢å•æ—¥å¿—è¡¨ã€‚</p><img src="/assets/image-20220426155608697-89860da3.png" alt="image-20220426155608697" style="zoom:50%;"><ul><li><p>åœ¨è¿›è¡Œæ•°æ®å¤‡ä»½æ—¶ï¼Œå…ˆå¤‡ä»½äº†tb_stockåº“å­˜è¡¨ã€‚</p></li><li><p>ç„¶åæ¥ä¸‹æ¥ï¼Œåœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œæ‰§è¡Œäº†ä¸‹å•æ“ä½œï¼Œæ‰£å‡åº“å­˜ï¼Œç”Ÿæˆè®¢å•ï¼ˆæ›´æ–°tb_stockè¡¨ï¼Œæ’å…¥tb_orderè¡¨ï¼‰ã€‚</p></li><li><p>ç„¶åå†æ‰§è¡Œå¤‡ä»½ tb_orderè¡¨çš„é€»è¾‘ã€‚</p></li><li><p>ä¸šåŠ¡ä¸­æ‰§è¡Œæ’å…¥è®¢å•æ—¥å¿—æ“ä½œã€‚</p></li><li><p>æœ€åï¼Œåˆå¤‡ä»½äº†tb_orderlogè¡¨ã€‚</p></li></ul><p>æ­¤æ—¶å¤‡ä»½å‡ºæ¥çš„æ•°æ®ï¼Œæ˜¯å­˜åœ¨é—®é¢˜çš„ã€‚å› ä¸ºå¤‡ä»½å‡ºæ¥çš„æ•°æ®ï¼Œtb_stockè¡¨ä¸tb_orderè¡¨çš„æ•°æ®ä¸ä¸€è‡´(æœ‰æœ€æ–°æ“ä½œçš„è®¢å•ä¿¡æ¯,ä½†æ˜¯åº“å­˜æ•°æ²¡å‡)ã€‚</p><p>é‚£å¦‚ä½•æ¥è§„é¿è¿™ç§é—®é¢˜å‘¢? æ­¤æ—¶å°±å¯ä»¥å€ŸåŠ©äºMySQLçš„å…¨å±€é”æ¥è§£å†³ã€‚</p><p><strong>B. å†æ¥åˆ†æä¸€ä¸‹åŠ äº†å…¨å±€é”åçš„æƒ…å†µ</strong></p><img src="/assets/image-20220426155839152-90ba3d30.png" alt="image-20220426155839152" style="zoom:50%;"><p>å¯¹æ•°æ®åº“è¿›è¡Œè¿›è¡Œé€»è¾‘å¤‡ä»½ä¹‹å‰ï¼Œå…ˆå¯¹æ•´ä¸ªæ•°æ®åº“åŠ ä¸Šå…¨å±€é”ï¼Œä¸€æ—¦åŠ äº†å…¨å±€é”ä¹‹åï¼Œå…¶ä»–çš„DDLã€DMLå…¨éƒ¨éƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡ŒDQLè¯­å¥ï¼Œä¹Ÿå°±æ˜¯å¤„äºåªè¯»çŠ¶æ€ï¼Œè€Œæ•°æ®å¤‡ä»½å°±æ˜¯æŸ¥è¯¢æ“ä½œã€‚é‚£ä¹ˆæ•°æ®åœ¨è¿›è¡Œé€»è¾‘å¤‡ä»½çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®åº“ä¸­çš„æ•°æ®å°±æ˜¯ä¸ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼Œè¿™æ ·å°±ä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚</p><h4 id="è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•" aria-hidden="true">#</a> è¯­æ³•</h4><p>1). åŠ å…¨å±€é”</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>flush tables with read lock ;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2). æ•°æ®å¤‡ä»½</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mysqldump -uroot â€“p1234 itcast &gt; itcast.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ•°æ®å¤‡ä»½çš„ç›¸å…³æŒ‡ä»¤, åœ¨åé¢MySQLç®¡ç†ç« èŠ‚, è¿˜ä¼šè¯¦ç»†è®²è§£.</p><p>3). é‡Šæ”¾é”</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>unlock tables ;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="ç‰¹ç‚¹-4" tabindex="-1"><a class="header-anchor" href="#ç‰¹ç‚¹-4" aria-hidden="true">#</a> ç‰¹ç‚¹</h4><p>æ•°æ®åº“ä¸­åŠ å…¨å±€é”ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒé‡çš„æ“ä½œï¼Œå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li><p>å¦‚æœåœ¨ä¸»åº“ä¸Šå¤‡ä»½ï¼Œé‚£ä¹ˆåœ¨å¤‡ä»½æœŸé—´éƒ½ä¸èƒ½æ‰§è¡Œæ›´æ–°ï¼Œä¸šåŠ¡åŸºæœ¬ä¸Šå°±å¾—åœæ‘†ã€‚</p></li><li><p>å¦‚æœåœ¨ä»åº“ä¸Šå¤‡ä»½ï¼Œé‚£ä¹ˆåœ¨å¤‡ä»½æœŸé—´ä»åº“ä¸èƒ½æ‰§è¡Œä¸»åº“åŒæ­¥è¿‡æ¥çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinlogï¼‰ï¼Œä¼šå¯¼è‡´ä¸»ä»å»¶è¿Ÿã€‚</p></li></ul><p>åœ¨InnoDBå¼•æ“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¤‡ä»½æ—¶åŠ ä¸Šå‚æ•° --single-transaction å‚æ•°æ¥å®Œæˆä¸åŠ é”çš„ä¸€è‡´æ€§æ•°æ®å¤‡ä»½ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mysqldump --single-transaction -uroot â€“p123456 itcast &gt; itcast.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="è¡¨çº§é”" tabindex="-1"><a class="header-anchor" href="#è¡¨çº§é”" aria-hidden="true">#</a> è¡¨çº§é”</h3><p>è¡¨çº§é”ï¼Œæ¯æ¬¡æ“ä½œé”ä½æ•´å¼ è¡¨ã€‚é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ã€‚åº”ç”¨åœ¨MyISAMã€InnoDBã€BDBç­‰å­˜å‚¨å¼•æ“ä¸­ã€‚</p><p>å¯¹äºè¡¨çº§é”ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š</p><ul><li><p>è¡¨é”</p></li><li><p>å…ƒæ•°æ®é”ï¼ˆmeta data lockï¼ŒMDLï¼‰</p></li><li><p>æ„å‘é”</p></li></ul><h4 id="è¡¨é”" tabindex="-1"><a class="header-anchor" href="#è¡¨é”" aria-hidden="true">#</a> è¡¨é”</h4><p>å¯¹äºè¡¨é”ï¼Œåˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li><p>è¡¨å…±äº«è¯»é”ï¼ˆread lockï¼‰</p></li><li><p>è¡¨ç‹¬å å†™é”ï¼ˆwrite lockï¼‰</p></li></ul><p><strong>è¯­æ³•ï¼š</strong></p><ul><li><p>åŠ é”ï¼šlock tables è¡¨å... read/writeã€‚</p></li><li><p>é‡Šæ”¾é”ï¼šunlock tables / å®¢æˆ·ç«¯æ–­å¼€è¿æ¥ ã€‚</p></li></ul><p><strong>ç‰¹ç‚¹:</strong></p><p>A. è¯»é”</p><p>å·¦ä¾§ä¸ºå®¢æˆ·ç«¯ä¸€ï¼Œå¯¹æŒ‡å®šè¡¨åŠ äº†è¯»é”ï¼Œä¸ä¼šå½±å“å³ä¾§å®¢æˆ·ç«¯äºŒçš„è¯»ï¼Œä½†æ˜¯ä¼šé˜»å¡å³ä¾§å®¢æˆ·ç«¯çš„å†™ã€‚</p><img src="/assets/image-20220426160414695-94a956b3.png" alt="image-20220426160414695" style="zoom:50%;"><p>B. å†™é”</p><p>å·¦ä¾§ä¸ºå®¢æˆ·ç«¯ä¸€ï¼Œå¯¹æŒ‡å®šè¡¨åŠ äº†å†™é”ï¼Œä¼šé˜»å¡å³ä¾§å®¢æˆ·ç«¯çš„è¯»å’Œå†™ã€‚</p><img src="/assets/image-20220426160456612-9186c762.png" alt="image-20220426160456612" style="zoom:50%;"><blockquote><p>ç»“è®º: è¯»é”ä¸ä¼šé˜»å¡å…¶ä»–å®¢æˆ·ç«¯çš„è¯»ï¼Œä½†æ˜¯ä¼šé˜»å¡å†™ã€‚å†™é”æ—¢ä¼šé˜»å¡å…¶ä»–å®¢æˆ·ç«¯çš„è¯»ï¼Œåˆä¼šé˜»å¡å…¶ä»–å®¢æˆ·ç«¯çš„å†™ã€‚</p></blockquote><h4 id="å…ƒæ•°æ®é”" tabindex="-1"><a class="header-anchor" href="#å…ƒæ•°æ®é”" aria-hidden="true">#</a> å…ƒæ•°æ®é”</h4><p>meta data lock , å…ƒæ•°æ®é”ï¼Œç®€å†™MDLã€‚</p><p>MDLåŠ é”è¿‡ç¨‹æ˜¯ç³»ç»Ÿè‡ªåŠ¨æ§åˆ¶ï¼Œæ— éœ€æ˜¾å¼ä½¿ç”¨ï¼Œåœ¨è®¿é—®ä¸€å¼ è¡¨çš„æ—¶å€™ä¼šè‡ªåŠ¨åŠ ä¸Šã€‚MDLé”ä¸»è¦ä½œç”¨æ˜¯ç»´æŠ¤è¡¨å…ƒæ•°æ®çš„æ•°æ®ä¸€è‡´æ€§ï¼Œåœ¨è¡¨ä¸Šæœ‰æ´»åŠ¨äº‹åŠ¡çš„æ—¶å€™ï¼Œä¸å¯ä»¥å¯¹å…ƒæ•°æ®è¿›è¡Œå†™å…¥æ“ä½œã€‚ä¸ºäº†é¿å…DMLä¸DDLå†²çªï¼Œä¿è¯è¯»å†™çš„æ­£ç¡®æ€§ã€‚</p><p>è¿™é‡Œçš„å…ƒæ•°æ®ï¼Œå¤§å®¶å¯ä»¥ç®€å•ç†è§£ä¸ºå°±æ˜¯ä¸€å¼ è¡¨çš„è¡¨ç»“æ„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŸä¸€å¼ è¡¨æ¶‰åŠåˆ°æœªæäº¤çš„äº‹åŠ¡æ—¶ï¼Œæ˜¯ä¸èƒ½å¤Ÿä¿®æ”¹è¿™å¼ è¡¨çš„è¡¨ç»“æ„çš„ã€‚</p><p>åœ¨MySQL5.5ä¸­å¼•å…¥äº†MDLï¼Œå½“å¯¹ä¸€å¼ è¡¨è¿›è¡Œå¢åˆ æ”¹æŸ¥çš„æ—¶å€™ï¼ŒåŠ MDLè¯»é”(å…±äº«)ï¼›å½“å¯¹è¡¨ç»“æ„è¿›è¡Œå˜æ›´æ“ä½œçš„æ—¶å€™ï¼ŒåŠ MDLå†™é”(æ’ä»–)ã€‚</p><p>å¸¸è§çš„SQLæ“ä½œæ—¶ï¼Œæ‰€æ·»åŠ çš„å…ƒæ•°æ®é”ï¼š</p><table><thead><tr><th>å¯¹åº”SQL</th><th>é”ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>lock tables xxx read /write</td><td>SHARED_READ_ONLY /SHARED_NO_READ_WRITE</td><td></td></tr><tr><td>select ã€select ... lock in share mode</td><td>SHARED_READ</td><td>ä¸SHARED_READã€SHARED_WRITEå…¼å®¹ï¼Œä¸EXCLUSIVEäº’æ–¥</td></tr><tr><td>insert ã€updateã€deleteã€select ... for update</td><td>SHARED_WRITE</td><td>ä¸SHARED_READã€SHARED_WRITEå…¼å®¹ï¼Œä¸EXCLUSIVEäº’æ–¥</td></tr><tr><td>alter table ...</td><td>EXCLUSIVE</td><td>ä¸å…¶ä»–çš„MDLéƒ½äº’æ–¥</td></tr></tbody></table><h4 id="æ„å‘é”" tabindex="-1"><a class="header-anchor" href="#æ„å‘é”" aria-hidden="true">#</a> æ„å‘é”</h4><p>ä¸ºäº†é¿å…DMLåœ¨æ‰§è¡Œæ—¶ï¼ŒåŠ çš„è¡Œé”ä¸è¡¨é”çš„å†²çªï¼Œåœ¨InnoDBä¸­å¼•å…¥äº†æ„å‘é”ï¼Œä½¿å¾—è¡¨é”ä¸ç”¨æ£€æŸ¥æ¯è¡Œæ•°æ®æ˜¯å¦åŠ é”ï¼Œä½¿ç”¨æ„å‘é”æ¥å‡å°‘è¡¨é”çš„æ£€æŸ¥ã€‚</p><p>å‡å¦‚æ²¡æœ‰æ„å‘é”ï¼Œå®¢æˆ·ç«¯ä¸€å¯¹è¡¨åŠ äº†è¡Œé”åï¼Œå®¢æˆ·ç«¯äºŒå¦‚ä½•ç»™è¡¨åŠ è¡¨é”å‘¢ï¼Œæ¥é€šè¿‡ç¤ºæ„å›¾ç®€å•åˆ†æä¸€ä¸‹ï¼š</p><p>é¦–å…ˆå®¢æˆ·ç«¯ä¸€ï¼Œå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œç„¶åæ‰§è¡ŒDMLæ“ä½œï¼Œåœ¨æ‰§è¡ŒDMLè¯­å¥æ—¶ï¼Œä¼šå¯¹æ¶‰åŠåˆ°çš„è¡ŒåŠ è¡Œé”ã€‚</p><img src="/assets/image-20220426161203823-1bf97155.png" alt="image-20220426161203823" style="zoom:50%;"><p>å½“å®¢æˆ·ç«¯äºŒï¼Œæƒ³å¯¹è¿™å¼ è¡¨åŠ è¡¨é”æ—¶ï¼Œä¼šæ£€æŸ¥å½“å‰è¡¨æ˜¯å¦æœ‰å¯¹åº”çš„è¡Œé”ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æ·»åŠ è¡¨é”ï¼Œæ­¤æ—¶å°±ä¼šä»ç¬¬ä¸€è¡Œæ•°æ®ï¼Œæ£€æŸ¥åˆ°æœ€åä¸€è¡Œæ•°æ®ï¼Œæ•ˆç‡è¾ƒä½ã€‚</p><img src="/assets/image-20220426161235688-f790d98b.png" alt="image-20220426161235688" style="zoom:50%;"><p>æœ‰äº†æ„å‘é”ä¹‹å :</p><p>å®¢æˆ·ç«¯ä¸€ï¼Œåœ¨æ‰§è¡ŒDMLæ“ä½œæ—¶ï¼Œä¼šå¯¹æ¶‰åŠçš„è¡ŒåŠ è¡Œé”ï¼ŒåŒæ—¶ä¹Ÿä¼šå¯¹è¯¥è¡¨åŠ ä¸Šæ„å‘é”ã€‚</p><img src="/assets/image-20220426161359156-15ca2d76.png" alt="image-20220426161359156" style="zoom:50%;"><p>è€Œå…¶ä»–å®¢æˆ·ç«¯ï¼Œåœ¨å¯¹è¿™å¼ è¡¨åŠ è¡¨é”çš„æ—¶å€™ï¼Œä¼šæ ¹æ®è¯¥è¡¨ä¸Šæ‰€åŠ çš„æ„å‘é”æ¥åˆ¤å®šæ˜¯å¦å¯ä»¥æˆåŠŸåŠ è¡¨é”ï¼Œè€Œä¸ç”¨é€è¡Œåˆ¤æ–­è¡Œé”æƒ…å†µäº†ã€‚</p><img src="/assets/image-20220426161508026-6d1116a4.png" alt="image-20220426161508026" style="zoom:50%;"><p>æ€»ç»“ï¼š</p><ul><li><p>æ„å‘å…±äº«é”(IS): ç”±è¯­å¥select ... lock in share modeæ·»åŠ  ã€‚ ä¸ è¡¨é”å…±äº«é”(read)å…¼å®¹ï¼Œä¸è¡¨é”æ’ä»–é”(write)äº’æ–¥ã€‚</p></li><li><p>æ„å‘æ’ä»–é”(IX): ç”±insertã€updateã€deleteã€select...for updateæ·»åŠ  ã€‚ä¸è¡¨é”å…±äº«é”(read)åŠæ’ä»–é”(write)éƒ½äº’æ–¥ï¼Œæ„å‘é”ä¹‹é—´ä¸ä¼šäº’æ–¥ã€‚</p></li></ul><blockquote><p>ä¸€æ—¦äº‹åŠ¡æäº¤äº†ï¼Œæ„å‘å…±äº«é”ã€æ„å‘æ’ä»–é”ï¼Œéƒ½ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚</p></blockquote><h3 id="è¡Œçº§é”" tabindex="-1"><a class="header-anchor" href="#è¡Œçº§é”" aria-hidden="true">#</a> è¡Œçº§é”</h3><p>è¡Œçº§é”ï¼Œæ¯æ¬¡æ“ä½œé”ä½å¯¹åº”çš„è¡Œæ•°æ®ã€‚é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œå¹¶å‘åº¦æœ€é«˜ã€‚åº”ç”¨åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ã€‚</p><p>InnoDBçš„æ•°æ®æ˜¯åŸºäºç´¢å¼•ç»„ç»‡çš„ï¼Œè¡Œé”æ˜¯é€šè¿‡å¯¹ç´¢å¼•ä¸Šçš„ç´¢å¼•é¡¹åŠ é”æ¥å®ç°çš„ï¼Œè€Œä¸æ˜¯å¯¹è®°å½•åŠ çš„é”ã€‚å¯¹äºè¡Œçº§é”ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š</p><ul><li><p>è¡Œé”ï¼ˆRecord Lockï¼‰ï¼šé”å®šå•ä¸ªè¡Œè®°å½•çš„é”ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ­¤è¡Œè¿›è¡Œupdateå’Œdeleteã€‚åœ¨RCã€RRéš”ç¦»çº§åˆ«ä¸‹éƒ½æ”¯æŒã€‚</p><img src="/assets/image-20220426161744776-71c69df1.png" alt="image-20220426161744776" style="zoom:50%;"></li><li><p>é—´éš™é”ï¼ˆGap Lockï¼‰ï¼šé”å®šç´¢å¼•è®°å½•é—´éš™ï¼ˆä¸å«è¯¥è®°å½•ï¼‰ï¼Œç¡®ä¿ç´¢å¼•è®°å½•é—´éš™ä¸å˜ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡åœ¨è¿™ä¸ªé—´éš™è¿›è¡Œinsertï¼Œäº§ç”Ÿå¹»è¯»ã€‚åœ¨RRéš”ç¦»çº§åˆ«ä¸‹éƒ½æ”¯æŒã€‚</p></li></ul><img src="/assets/image-20220426161827629-0fcaa899.png" alt="image-20220426161827629" style="zoom:50%;"><ul><li>ä¸´é”®é”ï¼ˆNext-Key Lockï¼‰ï¼šè¡Œé”å’Œé—´éš™é”ç»„åˆï¼ŒåŒæ—¶é”ä½æ•°æ®ï¼Œå¹¶é”ä½æ•°æ®å‰é¢çš„é—´éš™Gapã€‚ åœ¨RRéš”ç¦»çº§åˆ«ä¸‹æ”¯æŒã€‚</li></ul><img src="/assets/image-20220426161908510-a3da96a4.png" alt="image-20220426161908510" style="zoom:50%;"><h4 id="è¡Œé”" tabindex="-1"><a class="header-anchor" href="#è¡Œé”" aria-hidden="true">#</a> è¡Œé”</h4><p>InnoDBå®ç°äº†ä»¥ä¸‹ä¸¤ç§ç±»å‹çš„è¡Œé”ï¼š</p><ul><li><p>å…±äº«é”ï¼ˆSï¼‰ï¼šå…è®¸ä¸€ä¸ªäº‹åŠ¡å»è¯»ä¸€è¡Œï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡è·å¾—ç›¸åŒæ•°æ®é›†çš„æ’å®ƒé”ã€‚</p></li><li><p>æ’ä»–é”ï¼ˆXï¼‰ï¼šå…è®¸è·å–æ’ä»–é”çš„äº‹åŠ¡æ›´æ–°æ•°æ®ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡è·å¾—ç›¸åŒæ•°æ®é›†çš„å…±äº«é”å’Œæ’ä»–é”</p></li></ul><p>ä¸¤ç§è¡Œé”çš„å…¼å®¹æƒ…å†µå¦‚ä¸‹:</p><img src="/assets/image-20220426162017022-9a6d2c1b.png" alt="image-20220426162017022" style="zoom:50%;"><p>å¸¸è§çš„SQLè¯­å¥ï¼Œåœ¨æ‰§è¡Œæ—¶ï¼Œæ‰€åŠ çš„è¡Œé”å¦‚ä¸‹ï¼š</p><table><thead><tr><th>SQL</th><th>è¡Œé”ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>INSERT ...</td><td>æ’ä»–é”</td><td>è‡ªåŠ¨åŠ é”</td></tr><tr><td>UPDATE ...</td><td>æ’ä»–é”</td><td>è‡ªåŠ¨åŠ é”</td></tr><tr><td>DELETE ...</td><td>æ’ä»–é”</td><td>è‡ªåŠ¨åŠ é”</td></tr><tr><td>SELECTï¼ˆæ­£å¸¸ï¼‰</td><td>ä¸åŠ ä»»ä½•é”</td><td></td></tr><tr><td>SELECT ... LOCK IN SHARE MODE</td><td>å…±äº«é”</td><td>éœ€è¦æ‰‹åŠ¨åœ¨SELECTä¹‹ååŠ LOCK IN SHARE MODE</td></tr><tr><td>SELECT ... FOR UPDATE</td><td>æ’ä»–é”</td><td>éœ€è¦æ‰‹åŠ¨åœ¨SELECTä¹‹ååŠ FOR UPDATE</td></tr></tbody></table><p><strong>æ¼”ç¤º</strong></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒInnoDBåœ¨ REPEATABLE READäº‹åŠ¡éš”ç¦»çº§åˆ«è¿è¡Œï¼ŒInnoDBä½¿ç”¨ next-key é”è¿›è¡Œæœç´¢å’Œç´¢å¼•æ‰«æï¼Œä»¥é˜²æ­¢å¹»è¯»ã€‚</p><ul><li><p>é’ˆå¯¹å”¯ä¸€ç´¢å¼•è¿›è¡Œæ£€ç´¢æ—¶ï¼Œå¯¹å·²å­˜åœ¨çš„è®°å½•è¿›è¡Œç­‰å€¼åŒ¹é…æ—¶ï¼Œå°†ä¼šè‡ªåŠ¨ä¼˜åŒ–ä¸ºè¡Œé”ã€‚</p></li><li><p>InnoDBçš„è¡Œé”æ˜¯é’ˆå¯¹äºç´¢å¼•åŠ çš„é”ï¼Œä¸é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œé‚£ä¹ˆInnoDBå°†å¯¹è¡¨ä¸­çš„æ‰€æœ‰è®°å½•åŠ é”ï¼Œæ­¤æ—¶å°±ä¼šå‡çº§ä¸ºè¡¨é”ã€‚</p></li></ul><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹SQLï¼ŒæŸ¥çœ‹æ„å‘é”åŠè¡Œé”çš„åŠ é”æƒ…å†µï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> object_schema<span class="token punctuation">,</span>object_name<span class="token punctuation">,</span>index_name<span class="token punctuation">,</span>lock_type<span class="token punctuation">,</span>lock_mode<span class="token punctuation">,</span>lock_data <span class="token keyword">from</span> performance_schema<span class="token punctuation">.</span>data_locks<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="é—´éš™é”-ä¸´é”®é”" tabindex="-1"><a class="header-anchor" href="#é—´éš™é”-ä¸´é”®é”" aria-hidden="true">#</a> é—´éš™é”&amp;ä¸´é”®é”</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒInnoDBåœ¨ REPEATABLE READäº‹åŠ¡éš”ç¦»çº§åˆ«è¿è¡Œï¼ŒInnoDBä½¿ç”¨ next-key é”è¿›è¡Œæœç´¢å’Œç´¢å¼•æ‰«æï¼Œä»¥é˜²æ­¢å¹»è¯»ã€‚</p><ul><li><p>ç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢(å”¯ä¸€ç´¢å¼•)ï¼Œç»™ä¸å­˜åœ¨çš„è®°å½•åŠ é”æ—¶, ä¼˜åŒ–ä¸ºé—´éš™é” ã€‚</p></li><li><p>ç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢(éå”¯ä¸€æ™®é€šç´¢å¼•)ï¼Œå‘å³éå†æ—¶æœ€åä¸€ä¸ªå€¼ä¸æ»¡è¶³æŸ¥è¯¢éœ€æ±‚æ—¶ï¼Œnext-keylock é€€åŒ–ä¸ºé—´éš™é”ã€‚</p></li><li><p>ç´¢å¼•ä¸Šçš„èŒƒå›´æŸ¥è¯¢(å”¯ä¸€ç´¢å¼•)--ä¼šè®¿é—®åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå€¼ä¸ºæ­¢ã€‚</p></li></ul><blockquote><p>æ³¨æ„ï¼šé—´éš™é”å”¯ä¸€ç›®çš„æ˜¯é˜²æ­¢å…¶ä»–äº‹åŠ¡æ’å…¥é—´éš™ã€‚é—´éš™é”å¯ä»¥å…±å­˜ï¼Œä¸€ä¸ªäº‹åŠ¡é‡‡ç”¨çš„é—´éš™é”ä¸ä¼šé˜»æ­¢å¦ä¸€ä¸ªäº‹åŠ¡åœ¨åŒä¸€é—´éš™ä¸Šé‡‡ç”¨é—´éš™é”ã€‚</p></blockquote><p>A. ç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢(å”¯ä¸€ç´¢å¼•)ï¼Œç»™ä¸å­˜åœ¨çš„è®°å½•åŠ é”æ—¶, ä¼˜åŒ–ä¸ºé—´éš™é” ã€‚</p><img src="/assets/image-20220426163450919-16447d9a.png" alt="image-20220426163450919" style="zoom:50%;"><p>B. ç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢(éå”¯ä¸€æ™®é€šç´¢å¼•)ï¼Œå‘å³éå†æ—¶æœ€åä¸€ä¸ªå€¼ä¸æ»¡è¶³æŸ¥è¯¢éœ€æ±‚æ—¶ï¼Œnext-keylock é€€åŒ–ä¸ºé—´éš™é”ã€‚</p><p>ä»‹ç»åˆ†æä¸€ä¸‹ï¼š</p><p>æˆ‘ä»¬çŸ¥é“InnoDBçš„B+æ ‘ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹æ˜¯æœ‰åºçš„åŒå‘é“¾è¡¨ã€‚ å‡å¦‚ï¼Œæˆ‘ä»¬è¦æ ¹æ®è¿™ä¸ªäºŒçº§ç´¢å¼•æŸ¥è¯¢å€¼ä¸º18çš„æ•°æ®ï¼Œå¹¶åŠ ä¸Šå…±äº«é”ï¼Œæˆ‘ä»¬æ˜¯åªé”å®š18è¿™ä¸€è¡Œå°±å¯ä»¥äº†å—ï¼Ÿ å¹¶ä¸æ˜¯ï¼Œå› ä¸ºæ˜¯éå”¯ä¸€ç´¢å¼•ï¼Œè¿™ä¸ªç»“æ„ä¸­å¯èƒ½æœ‰å¤šä¸ª18çš„å­˜åœ¨ï¼Œæ‰€ä»¥ï¼Œåœ¨åŠ é”æ—¶ä¼šç»§ç»­å¾€åæ‰¾ï¼Œæ‰¾åˆ°ä¸€ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„å€¼ï¼ˆå½“å‰æ¡ˆä¾‹ä¸­ä¹Ÿå°±æ˜¯29ï¼‰ã€‚æ­¤æ—¶ä¼šå¯¹18åŠ ä¸´é”®é”ï¼Œå¹¶å¯¹29ä¹‹å‰çš„é—´éš™åŠ é”ã€‚</p><img src="/assets/image-20220426163540635-985a876c.png" alt="image-20220426163540635" style="zoom:50%;"><img src="/assets/image-20220426163601381-85421f32.png" alt="image-20220426163601381" style="zoom:50%;"><p>C. ç´¢å¼•ä¸Šçš„èŒƒå›´æŸ¥è¯¢(å”¯ä¸€ç´¢å¼•)--ä¼šè®¿é—®åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå€¼ä¸ºæ­¢ã€‚</p><img src="/assets/image-20220426163645003-b45ca480.png" alt="image-20220426163645003" style="zoom:50%;"><p>æŸ¥è¯¢çš„æ¡ä»¶ä¸ºid&gt;=19ï¼Œå¹¶æ·»åŠ å…±äº«é”ã€‚ æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ ¹æ®æ•°æ®åº“è¡¨ä¸­ç°æœ‰çš„æ•°æ®ï¼Œå°†æ•°æ®åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><p>[19]</p><p>(19,25]</p><p>(25,+âˆ]</p><p>æ‰€ä»¥æ•°æ®åº“æ•°æ®åœ¨åŠ é”æ˜¯ï¼Œå°±æ˜¯å°†19åŠ äº†è¡Œé”ï¼Œ25çš„ä¸´é”®é”ï¼ˆåŒ…å«25åŠ25ä¹‹å‰çš„é—´éš™ï¼‰ï¼Œæ­£æ— ç©·çš„ä¸´é”®é”(æ­£æ— ç©·åŠä¹‹å‰çš„é—´éš™)ã€‚</p><h2 id="è¿›é˜¶ç¯‡-innodbå¼•æ“" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶ç¯‡-innodbå¼•æ“" aria-hidden="true">#</a> è¿›é˜¶ç¯‡-InnoDBå¼•æ“</h2><h3 id="é€»è¾‘å­˜å‚¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#é€»è¾‘å­˜å‚¨ç»“æ„" aria-hidden="true">#</a> é€»è¾‘å­˜å‚¨ç»“æ„</h3><p>InnoDBçš„é€»è¾‘å­˜å‚¨ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤º:</p><img src="/assets/image-20220427080239097-1f042658.png" alt="image-20220427080239097" style="zoom:50%;"><p>**è¡¨ç©ºé—´ ï¼š**è¡¨ç©ºé—´æ˜¯InnoDBå­˜å‚¨å¼•æ“é€»è¾‘ç»“æ„çš„æœ€é«˜å±‚ï¼Œ å¦‚æœç”¨æˆ·å¯ç”¨äº†å‚æ•° innodb_file_per_table(åœ¨8.0ç‰ˆæœ¬ä¸­é»˜è®¤å¼€å¯) ï¼Œåˆ™æ¯å¼ è¡¨éƒ½ä¼šæœ‰ä¸€ä¸ªè¡¨ç©ºé—´ï¼ˆxxx.ibdï¼‰ï¼Œä¸€ä¸ªmysqlå®ä¾‹å¯ä»¥å¯¹åº”å¤šä¸ªè¡¨ç©ºé—´ï¼Œç”¨äºå­˜å‚¨è®°å½•ã€ç´¢å¼•ç­‰æ•°æ®ã€‚</p><p>**æ®µï¼š**åˆ†ä¸ºæ•°æ®æ®µï¼ˆLeaf node segmentï¼‰ã€ç´¢å¼•æ®µï¼ˆNon-leaf node segmentï¼‰ã€å›æ»šæ®µï¼ˆRollback segmentï¼‰ï¼ŒInnoDBæ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼Œæ•°æ®æ®µå°±æ˜¯B+æ ‘çš„å¶å­èŠ‚ç‚¹ï¼Œ ç´¢å¼•æ®µå³ä¸ºB+æ ‘çš„éå¶å­èŠ‚ç‚¹ã€‚æ®µç”¨æ¥ç®¡ç†å¤šä¸ªExtentï¼ˆåŒºï¼‰ã€‚</p><p>**åŒºï¼š**è¡¨ç©ºé—´çš„å•å…ƒç»“æ„ï¼Œæ¯ä¸ªåŒºçš„å¤§å°ä¸º1Mã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œ InnoDBå­˜å‚¨å¼•æ“é¡µå¤§å°ä¸º16Kï¼Œ å³ä¸€ä¸ªåŒºä¸­ä¸€å…±æœ‰64ä¸ªè¿ç»­çš„é¡µã€‚</p><p>**é¡µï¼š**æ˜¯InnoDB å­˜å‚¨å¼•æ“ç£ç›˜ç®¡ç†çš„æœ€å°å•å…ƒï¼Œæ¯ä¸ªé¡µçš„å¤§å°é»˜è®¤ä¸º 16KBã€‚ä¸ºäº†ä¿è¯é¡µçš„è¿ç»­æ€§ï¼ŒInnoDB å­˜å‚¨å¼•æ“æ¯æ¬¡ä»ç£ç›˜ç”³è¯· 4-5 ä¸ªåŒºã€‚</p><p>**è¡Œï¼š**InnoDB å­˜å‚¨å¼•æ“æ•°æ®æ˜¯æŒ‰è¡Œè¿›è¡Œå­˜æ”¾çš„ã€‚åœ¨è¡Œä¸­ï¼Œé»˜è®¤æœ‰ä¸¤ä¸ªéšè—å­—æ®µï¼š</p><ul><li><p>Trx_idï¼šæ¯æ¬¡å¯¹æŸæ¡è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œéƒ½ä¼šæŠŠå¯¹åº”çš„äº‹åŠ¡idèµ‹å€¼ç»™trx_idéšè—åˆ—ã€‚</p></li><li><p>Roll_pointerï¼šæ¯æ¬¡å¯¹æŸæ¡å¼•è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œéƒ½ä¼šæŠŠæ—§çš„ç‰ˆæœ¬å†™å…¥åˆ°undoæ—¥å¿—ä¸­ï¼Œç„¶åè¿™ä¸ªéšè—åˆ—å°±ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥æ‰¾åˆ°è¯¥è®°å½•ä¿®æ”¹å‰çš„ä¿¡æ¯ã€‚</p></li></ul><h3 id="æ¶æ„" tabindex="-1"><a class="header-anchor" href="#æ¶æ„" aria-hidden="true">#</a> æ¶æ„</h3><p>MySQL5.5 ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤ä½¿ç”¨InnoDBå­˜å‚¨å¼•æ“ï¼Œå®ƒæ“…é•¿äº‹åŠ¡å¤„ç†ï¼Œå…·æœ‰å´©æºƒæ¢å¤ç‰¹æ€§ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨éå¸¸å¹¿æ³›ã€‚ä¸‹é¢æ˜¯InnoDBæ¶æ„å›¾ï¼Œå·¦ä¾§ä¸ºå†…å­˜ç»“æ„ï¼Œå³ä¾§ä¸ºç£ç›˜ç»“æ„ã€‚</p><img src="/assets/image-20220427080814476-73d17ac0.png" alt="image-20220427080814476" style="zoom:50%;"><h4 id="å†…å­˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#å†…å­˜ç»“æ„" aria-hidden="true">#</a> å†…å­˜ç»“æ„</h4><p>åœ¨å·¦ä¾§çš„å†…å­˜ç»“æ„ä¸­ï¼Œä¸»è¦åˆ†ä¸ºè¿™ä¹ˆå››å¤§å—å„¿ï¼š Buffer Poolã€Change Bufferã€AdaptiveHash Indexã€Log Bufferã€‚ æ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹è¿™å››ä¸ªéƒ¨åˆ†ã€‚</p><h5 id="buffer-pool" tabindex="-1"><a class="header-anchor" href="#buffer-pool" aria-hidden="true">#</a> Buffer Pool</h5><p>InnoDBå­˜å‚¨å¼•æ“åŸºäºç£ç›˜æ–‡ä»¶å­˜å‚¨ï¼Œè®¿é—®ç‰©ç†ç¡¬ç›˜å’Œåœ¨å†…å­˜ä¸­è¿›è¡Œè®¿é—®ï¼Œé€Ÿåº¦ç›¸å·®å¾ˆå¤§ï¼Œä¸ºäº†å°½å¯èƒ½å¼¥è¡¥è¿™ä¸¤è€…ä¹‹é—´çš„I/Oæ•ˆç‡çš„å·®å€¼ï¼Œå°±éœ€è¦æŠŠç»å¸¸ä½¿ç”¨çš„æ•°æ®åŠ è½½åˆ°ç¼“å†²æ± ä¸­ï¼Œé¿å…æ¯æ¬¡è®¿é—®éƒ½è¿›è¡Œç£ç›˜I/Oã€‚</p><p>åœ¨InnoDBçš„ç¼“å†²æ± ä¸­ä¸ä»…ç¼“å­˜äº†ç´¢å¼•é¡µå’Œæ•°æ®é¡µï¼Œè¿˜åŒ…å«äº†undoé¡µã€æ’å…¥ç¼“å­˜ã€è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ä»¥åŠInnoDBçš„é”ä¿¡æ¯ç­‰ç­‰ã€‚</p><p>ç¼“å†²æ±  Buffer Poolï¼Œæ˜¯ä¸»å†…å­˜ä¸­çš„ä¸€ä¸ªåŒºåŸŸï¼Œé‡Œé¢å¯ä»¥ç¼“å­˜ç£ç›˜ä¸Šç»å¸¸æ“ä½œçš„çœŸå®æ•°æ®ï¼Œåœ¨æ‰§è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œæ—¶ï¼Œå…ˆæ“ä½œç¼“å†²æ± ä¸­çš„æ•°æ®ï¼ˆè‹¥ç¼“å†²æ± æ²¡æœ‰æ•°æ®ï¼Œåˆ™ä»ç£ç›˜åŠ è½½å¹¶ç¼“å­˜ï¼‰ï¼Œç„¶åå†ä»¥ä¸€å®šé¢‘ç‡åˆ·æ–°åˆ°ç£ç›˜ï¼Œä»è€Œå‡å°‘ç£ç›˜IOï¼ŒåŠ å¿«å¤„ç†é€Ÿåº¦ã€‚</p><p>ç¼“å†²æ± ä»¥Pageé¡µä¸ºå•ä½ï¼Œåº•å±‚é‡‡ç”¨é“¾è¡¨æ•°æ®ç»“æ„ç®¡ç†Pageã€‚æ ¹æ®çŠ¶æ€ï¼Œå°†Pageåˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š</p><ul><li><p>free pageï¼šç©ºé—²pageï¼Œæœªè¢«ä½¿ç”¨ã€‚</p></li><li><p>clean pageï¼šè¢«ä½¿ç”¨pageï¼Œæ•°æ®æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚</p></li><li><p>dirty pageï¼šè„é¡µï¼Œè¢«ä½¿ç”¨pageï¼Œæ•°æ®è¢«ä¿®æ”¹è¿‡ï¼Œä¹Ÿä¸­æ•°æ®ä¸ç£ç›˜çš„æ•°æ®äº§ç”Ÿäº†ä¸ä¸€è‡´ã€‚</p></li></ul><p>åœ¨ä¸“ç”¨æœåŠ¡å™¨ä¸Šï¼Œé€šå¸¸å°†å¤šè¾¾80ï¼…çš„ç‰©ç†å†…å­˜åˆ†é…ç»™ç¼“å†²æ±  ã€‚å‚æ•°è®¾ç½®ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code> show variables like &#39;innodb_buffer_pool_size&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220427081105843-1c6c4ef8.png" alt="image-20220427081105843" style="zoom:50%;"><h5 id="change-buffer" tabindex="-1"><a class="header-anchor" href="#change-buffer" aria-hidden="true">#</a> Change Buffer</h5><p>Change Bufferï¼Œæ›´æ”¹ç¼“å†²åŒºï¼ˆé’ˆå¯¹äºéå”¯ä¸€äºŒçº§ç´¢å¼•é¡µï¼‰ï¼Œåœ¨æ‰§è¡ŒDMLè¯­å¥æ—¶ï¼Œå¦‚æœè¿™äº›æ•°æ®Pageæ²¡æœ‰åœ¨Buffer Poolä¸­ï¼Œä¸ä¼šç›´æ¥æ“ä½œç£ç›˜ï¼Œè€Œä¼šå°†æ•°æ®å˜æ›´å­˜åœ¨æ›´æ”¹ç¼“å†²åŒº Change Bufferä¸­ï¼Œåœ¨æœªæ¥æ•°æ®è¢«è¯»å–æ—¶ï¼Œå†å°†æ•°æ®åˆå¹¶æ¢å¤åˆ°Buffer Poolä¸­ï¼Œå†å°†åˆå¹¶åçš„æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ä¸­ã€‚</p><p>Change Bufferçš„æ„ä¹‰æ˜¯ä»€ä¹ˆå‘¢?</p><p>å…ˆæ¥çœ‹ä¸€å¹…å›¾ï¼Œè¿™ä¸ªæ˜¯äºŒçº§ç´¢å¼•çš„ç»“æ„å›¾ï¼š</p><img src="/assets/image-20220427081201997-5beed8e3.png" alt="image-20220427081201997" style="zoom:50%;"><p>ä¸èšé›†ç´¢å¼•ä¸åŒï¼ŒäºŒçº§ç´¢å¼•é€šå¸¸æ˜¯éå”¯ä¸€çš„ï¼Œå¹¶ä¸”ä»¥ç›¸å¯¹éšæœºçš„é¡ºåºæ’å…¥äºŒçº§ç´¢å¼•ã€‚åŒæ ·ï¼Œåˆ é™¤å’Œæ›´æ–°å¯èƒ½ä¼šå½±å“ç´¢å¼•æ ‘ä¸­ä¸ç›¸é‚»çš„äºŒçº§ç´¢å¼•é¡µï¼Œå¦‚æœæ¯ä¸€æ¬¡éƒ½æ“ä½œç£ç›˜ï¼Œä¼šé€ æˆå¤§é‡çš„ç£ç›˜IOã€‚æœ‰äº†ChangeBufferä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¼“å†²æ± ä¸­è¿›è¡Œåˆå¹¶å¤„ç†ï¼Œå‡å°‘ç£ç›˜IOã€‚</p><h5 id="adaptive-hash-index" tabindex="-1"><a class="header-anchor" href="#adaptive-hash-index" aria-hidden="true">#</a> Adaptive Hash Index</h5><p>è‡ªé€‚åº”hashç´¢å¼•ï¼Œç”¨äºä¼˜åŒ–å¯¹Buffer Poolæ•°æ®çš„æŸ¥è¯¢ã€‚MySQLçš„innoDBå¼•æ“ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥æ”¯æŒhashç´¢å¼•ï¼Œä½†æ˜¯ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯è¿™ä¸ªè‡ªé€‚åº”hashç´¢å¼•ã€‚å› ä¸ºå‰é¢æˆ‘ä»¬è®²åˆ°è¿‡ï¼Œhashç´¢å¼•åœ¨è¿›è¡Œç­‰å€¼åŒ¹é…æ—¶ï¼Œä¸€èˆ¬æ€§èƒ½æ˜¯è¦é«˜äºB+æ ‘çš„ï¼Œå› ä¸ºhashç´¢å¼•ä¸€èˆ¬åªéœ€è¦ä¸€æ¬¡IOå³å¯ï¼Œè€ŒB+æ ‘ï¼Œå¯èƒ½éœ€è¦å‡ æ¬¡åŒ¹é…ï¼Œæ‰€ä»¥hashç´¢å¼•çš„æ•ˆç‡è¦é«˜ï¼Œä½†æ˜¯hashç´¢å¼•åˆä¸é€‚åˆåšèŒƒå›´æŸ¥è¯¢ã€æ¨¡ç³ŠåŒ¹é…ç­‰ã€‚</p><p>InnoDBå­˜å‚¨å¼•æ“ä¼šç›‘æ§å¯¹è¡¨ä¸Šå„ç´¢å¼•é¡µçš„æŸ¥è¯¢ï¼Œå¦‚æœè§‚å¯Ÿåˆ°åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹hashç´¢å¼•å¯ä»¥æå‡é€Ÿåº¦ï¼Œåˆ™å»ºç«‹hashç´¢å¼•ï¼Œç§°ä¹‹ä¸ºè‡ªé€‚åº”hashç´¢å¼•ã€‚</p><p><strong>è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼Œæ— éœ€äººå·¥å¹²é¢„ï¼Œæ˜¯ç³»ç»Ÿæ ¹æ®æƒ…å†µè‡ªåŠ¨å®Œæˆã€‚</strong></p><p>å‚æ•°ï¼š adaptive_hash_index</p><h5 id="log-buffer" tabindex="-1"><a class="header-anchor" href="#log-buffer" aria-hidden="true">#</a> Log Buffer</h5><p>Log Bufferï¼šæ—¥å¿—ç¼“å†²åŒºï¼Œç”¨æ¥ä¿å­˜è¦å†™å…¥åˆ°ç£ç›˜ä¸­çš„logæ—¥å¿—æ•°æ®ï¼ˆredo log ã€undo logï¼‰ï¼Œé»˜è®¤å¤§å°ä¸º 16MBï¼Œæ—¥å¿—ç¼“å†²åŒºçš„æ—¥å¿—ä¼šå®šæœŸåˆ·æ–°åˆ°ç£ç›˜ä¸­ã€‚å¦‚æœéœ€è¦æ›´æ–°ã€æ’å…¥æˆ–åˆ é™¤è®¸å¤šè¡Œçš„äº‹åŠ¡ï¼Œå¢åŠ æ—¥å¿—ç¼“å†²åŒºçš„å¤§å°å¯ä»¥èŠ‚çœç£ç›˜ I/Oã€‚</p><p>å‚æ•°:</p><p>innodb_log_buffer_sizeï¼šç¼“å†²åŒºå¤§å°</p><p>innodb_flush_log_at_trx_commitï¼šæ—¥å¿—åˆ·æ–°åˆ°ç£ç›˜æ—¶æœºï¼Œå–å€¼ä¸»è¦åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªï¼š</p><ul><li><p>1: æ—¥å¿—åœ¨æ¯æ¬¡äº‹åŠ¡æäº¤æ—¶å†™å…¥å¹¶åˆ·æ–°åˆ°ç£ç›˜ï¼Œé»˜è®¤å€¼ã€‚</p></li><li><p>0: æ¯ç§’å°†æ—¥å¿—å†™å…¥å¹¶åˆ·æ–°åˆ°ç£ç›˜ä¸€æ¬¡ã€‚</p></li><li><p>2: æ—¥å¿—åœ¨æ¯æ¬¡äº‹åŠ¡æäº¤åå†™å…¥ï¼Œå¹¶æ¯ç§’åˆ·æ–°åˆ°ç£ç›˜ä¸€æ¬¡ã€‚</p></li></ul><img src="/assets/image-20220427081356587-f46411f3.png" alt="image-20220427081356587" style="zoom:50%;"><h4 id="ç£ç›˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç£ç›˜ç»“æ„" aria-hidden="true">#</a> ç£ç›˜ç»“æ„</h4><p>æ¥ä¸‹æ¥ï¼Œå†æ¥çœ‹çœ‹InnoDBä½“ç³»ç»“æ„çš„å³è¾¹éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯ç£ç›˜ç»“æ„ï¼š</p><img src="/assets/image-20220427081505911-9052900a.png" alt="image-20220427081505911" style="zoom:50%;"><h5 id="system-tablespace" tabindex="-1"><a class="header-anchor" href="#system-tablespace" aria-hidden="true">#</a> System Tablespace</h5><p>ç³»ç»Ÿè¡¨ç©ºé—´æ˜¯æ›´æ”¹ç¼“å†²åŒºçš„å­˜å‚¨åŒºåŸŸã€‚å¦‚æœè¡¨æ˜¯åœ¨ç³»ç»Ÿè¡¨ç©ºé—´è€Œä¸æ˜¯æ¯ä¸ªè¡¨æ–‡ä»¶æˆ–é€šç”¨è¡¨ç©ºé—´ä¸­åˆ›å»ºçš„ï¼Œå®ƒä¹Ÿå¯èƒ½åŒ…å«è¡¨å’Œç´¢å¼•æ•°æ®ã€‚(åœ¨MySQL5.xç‰ˆæœ¬ä¸­è¿˜åŒ…å«InnoDBæ•°æ®å­—å…¸ã€undologç­‰)</p><p>å‚æ•°ï¼šinnodb_data_file_path</p><img src="/assets/image-20220427081601090-2a929b6b.png" alt="image-20220427081601090" style="zoom:50%;"><p>ç³»ç»Ÿè¡¨ç©ºé—´ï¼Œé»˜è®¤çš„æ–‡ä»¶åå« ibdata1ã€‚</p><h5 id="file-per-table-tablespaces" tabindex="-1"><a class="header-anchor" href="#file-per-table-tablespaces" aria-hidden="true">#</a> File-Per-Table Tablespaces</h5><p>å¦‚æœå¼€å¯äº†innodb_file_per_tableå¼€å…³ ï¼Œåˆ™æ¯ä¸ªè¡¨çš„æ–‡ä»¶è¡¨ç©ºé—´åŒ…å«å•ä¸ªInnoDBè¡¨çš„æ•°æ®å’Œç´¢å¼• ï¼Œå¹¶å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„å•ä¸ªæ•°æ®æ–‡ä»¶ä¸­ã€‚</p><p>å¼€å…³å‚æ•°ï¼šinnodb_file_per_table ï¼Œè¯¥å‚æ•°é»˜è®¤å¼€å¯ã€‚</p><img src="/assets/image-20220427081942107-70ee484d.png" alt="image-20220427081942107" style="zoom:50%;"><p>é‚£ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ¯åˆ›å»ºä¸€ä¸ªè¡¨ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªè¡¨ç©ºé—´æ–‡ä»¶ï¼Œå¦‚å›¾ï¼š</p><img src="/assets/image-20220427082018336-074b1042.png" alt="image-20220427082018336" style="zoom:50%;"><h5 id="general-tablespaces" tabindex="-1"><a class="header-anchor" href="#general-tablespaces" aria-hidden="true">#</a> General Tablespaces</h5><p>é€šç”¨è¡¨ç©ºé—´ï¼Œéœ€è¦é€šè¿‡ CREATE TABLESPACE è¯­æ³•åˆ›å»ºé€šç”¨è¡¨ç©ºé—´ï¼Œåœ¨åˆ›å»ºè¡¨æ—¶ï¼Œå¯ä»¥æŒ‡å®šè¯¥è¡¨ç©ºé—´ã€‚</p><p>A. åˆ›å»ºè¡¨ç©ºé—´</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>CREATE TABLESPACE ts_name ADD DATAFILE &#39;file_name&#39; ENGINE = engine_name;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220427082223707-af19f700.png" alt="image-20220427082223707" style="zoom:50%;"><p>B. åˆ›å»ºè¡¨æ—¶æŒ‡å®šè¡¨ç©ºé—´</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>CREATE TABLE xxx ... TABLESPACE ts_name;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="/assets/image-20220427082337252-80662ff9.png" alt="image-20220427082337252" style="zoom:50%;"><h5 id="undo-tablespaces" tabindex="-1"><a class="header-anchor" href="#undo-tablespaces" aria-hidden="true">#</a> Undo Tablespaces</h5><p>æ’¤é”€è¡¨ç©ºé—´ï¼ŒMySQLå®ä¾‹åœ¨åˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸¤ä¸ªé»˜è®¤çš„undoè¡¨ç©ºé—´ï¼ˆåˆå§‹å¤§å°16Mï¼‰ï¼Œç”¨äºå­˜å‚¨undo logæ—¥å¿—ã€‚</p><p>è¿™é‡Œè¦éœ€è¦è¯´æ˜ä¸€ä¸‹ï¼Œåœ¨MySQL5.6.3ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ª<code>undo tablespace</code>æ˜¯å’Œ<code>system tablespace</code>ç³»ç»Ÿè¡¨ç©ºé—´å­˜æ”¾åœ¨ä¸€èµ·çš„ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å•ç‹¬çš„<code>undo log</code>æ–‡ä»¶ï¼Œç›´æ¥å­˜æ”¾åœ¨<code>ibdata1</code>æ–‡ä»¶é‡Œè¾¹ï¼Œåœ¨<code>MySQL5.6.3</code>ä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼ŒMySQLæ”¯æŒå°†undo log tablespaceå•ç‹¬å‰¥ç¦»å‡ºæ¥ï¼Œä½†è¿™ä¸ªç‰¹æ€§ä¾ç„¶å¾ˆé¸¡è‚‹ï¼š</p><ol><li>è¦åœ¨å®‰è£…æ•°æ®åº“çš„æ—¶å€™ï¼Œå°±æŒ‡å®šå¥½ç‹¬ç«‹undo tablespaceï¼Œåœ¨å®‰è£…å®Œæˆåä¸å¯æ›´æ”¹ï¼›</li><li>undo tablespaceçš„space idå¿…é¡»ä»1å¼€å§‹ï¼Œæ— æ³•å¢åŠ æˆ–è€…åˆ é™¤undo tablespaceï¼›</li></ol><p>åˆ°äº†<code>MySQL5.7</code>ç‰ˆæœ¬ï¼Œç»ˆäºå¼•å…¥æœŸå¾…å·²ä¹…çš„åŠŸèƒ½ï¼šå³åœ¨çº¿truncate undo tablespaceï¼ˆè§£å†³äº†ç¬¬ä¸€ä¸ªé¸¡è‚‹ç‚¹ï¼Œå¯ä»¥åœ¨å®‰è£…æ•°æ®åº“ä¹‹åæ›´æ”¹undo tablespaceï¼‰</p><p>åœ¨<code>MySQL8.0</code>ä¸­ï¼ŒInnoDBå†è¿›ä¸€æ­¥ï¼Œå¯¹undo logåšäº†è¿›ä¸€æ­¥çš„æ”¹è¿›ï¼š</p><ol><li><strong>ä»8.0.3ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤undo tablespaceçš„ä¸ªæ•°ä»0è°ƒæ•´ä¸º2</strong>ï¼Œä¹Ÿå°±æ˜¯åœ¨8.0ç‰ˆæœ¬ä¸­ï¼Œç‹¬ç«‹undo tablespaceè¢«é»˜è®¤æ‰“å¼€ã€‚ä¿®æ”¹è¯¥å‚æ•°ä¸º0ä¼šæŠ¥warningå¹¶åœ¨æœªæ¥ä¸å†æ”¯æŒï¼›</li><li>æ— éœ€ä»space_id 1å¼€å§‹åˆ›å»ºundo tablespaceï¼Œè¿™æ ·è§£å†³äº†In-place upgradeæˆ–è€…ç‰©ç†æ¢å¤åˆ°ä¸€ä¸ªæ‰“å¼€äº†Undo tablespaceçš„å®ä¾‹æ‰€äº§ç”Ÿçš„space idå†²çªã€‚ä¸è¿‡ä¾ç„¶è¦æ±‚undo tablespaceçš„space idæ˜¯è¿ç»­åˆ†é…çš„ï¼›</li></ol><h5 id="temporary-tablespaces" tabindex="-1"><a class="header-anchor" href="#temporary-tablespaces" aria-hidden="true">#</a> Temporary Tablespaces</h5><p>InnoDB ä½¿ç”¨ä¼šè¯ä¸´æ—¶è¡¨ç©ºé—´å’Œå…¨å±€ä¸´æ—¶è¡¨ç©ºé—´ã€‚å­˜å‚¨ç”¨æˆ·åˆ›å»ºçš„ä¸´æ—¶è¡¨ç­‰æ•°æ®ã€‚</p><h5 id="doublewrite-buffer-files" tabindex="-1"><a class="header-anchor" href="#doublewrite-buffer-files" aria-hidden="true">#</a> Doublewrite Buffer Files</h5><p>åŒå†™ç¼“å†²åŒºï¼ŒinnoDBå¼•æ“å°†æ•°æ®é¡µä»Buffer Poolåˆ·æ–°åˆ°ç£ç›˜å‰ï¼Œå…ˆå°†æ•°æ®é¡µå†™å…¥åŒå†™ç¼“å†²åŒºæ–‡ä»¶ä¸­ï¼Œä¾¿äºç³»ç»Ÿå¼‚å¸¸æ—¶æ¢å¤æ•°æ®ã€‚</p><img src="/assets/image-20220427082511506-78106681.png" alt="image-20220427082511506" style="zoom:50%;"><h5 id="redo-log" tabindex="-1"><a class="header-anchor" href="#redo-log" aria-hidden="true">#</a> Redo Log</h5><p>é‡åšæ—¥å¿—ï¼Œæ˜¯ç”¨æ¥å®ç°äº‹åŠ¡çš„æŒä¹…æ€§ã€‚è¯¥æ—¥å¿—æ–‡ä»¶ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šé‡åšæ—¥å¿—ç¼“å†²ï¼ˆredo log bufferï¼‰ä»¥åŠé‡åšæ—¥å¿—æ–‡ä»¶ï¼ˆredo logï¼‰,å‰è€…æ˜¯åœ¨å†…å­˜ä¸­ï¼Œåè€…åœ¨ç£ç›˜ä¸­ã€‚å½“äº‹åŠ¡æäº¤ä¹‹åä¼šæŠŠæ‰€æœ‰ä¿®æ”¹ä¿¡æ¯éƒ½ä¼šå­˜åˆ°è¯¥æ—¥å¿—ä¸­, ç”¨äºåœ¨åˆ·æ–°è„é¡µåˆ°ç£ç›˜æ—¶,å‘ç”Ÿé”™è¯¯æ—¶, è¿›è¡Œæ•°æ®æ¢å¤ä½¿ç”¨ã€‚</p><p>ä»¥å¾ªç¯æ–¹å¼å†™å…¥é‡åšæ—¥å¿—æ–‡ä»¶ï¼Œæ¶‰åŠä¸¤ä¸ªæ–‡ä»¶ï¼š</p><img src="/assets/image-20220427082652621-bc1dbc8a.png" alt="image-20220427082652621" style="zoom:50%;"><h4 id="åå°çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#åå°çº¿ç¨‹" aria-hidden="true">#</a> åå°çº¿ç¨‹</h4><p>å‰é¢æˆ‘ä»¬ä»‹ç»äº†InnoDBçš„å†…å­˜ç»“æ„ï¼Œä»¥åŠç£ç›˜ç»“æ„ï¼Œé‚£ä¹ˆå†…å­˜ä¸­æˆ‘ä»¬æ‰€æ›´æ–°çš„æ•°æ®ï¼Œåˆæ˜¯å¦‚ä½•åˆ°ç£ç›˜ä¸­çš„å‘¢ï¼Ÿ æ­¤æ—¶ï¼Œå°±æ¶‰åŠåˆ°ä¸€ç»„åå°çº¿ç¨‹ï¼Œæ¥ä¸‹æ¥ï¼Œå°±æ¥ä»‹ç»ä¸€äº›InnoDBä¸­æ¶‰åŠåˆ°çš„åå°çº¿ç¨‹ã€‚</p><img src="/assets/image-20220427082857707-5fe1f2a2.png" alt="image-20220427082857707" style="zoom:50%;"><p>åœ¨InnoDBçš„åå°çº¿ç¨‹ä¸­ï¼Œåˆ†ä¸º4ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼šMaster Thread ã€IO Threadã€Purge Threadã€Page Cleaner Threadã€‚</p><p>1). Master Thread</p><p>æ ¸å¿ƒåå°çº¿ç¨‹ï¼Œè´Ÿè´£è°ƒåº¦å…¶ä»–çº¿ç¨‹ï¼Œè¿˜è´Ÿè´£å°†ç¼“å†²æ± ä¸­çš„æ•°æ®å¼‚æ­¥åˆ·æ–°åˆ°ç£ç›˜ä¸­, ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ï¼Œè¿˜åŒ…æ‹¬è„é¡µçš„åˆ·æ–°ã€åˆå¹¶æ’å…¥ç¼“å­˜ã€undoé¡µçš„å›æ”¶ ã€‚</p><p>2). IO Thread</p><p>åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­å¤§é‡ä½¿ç”¨äº†AIOæ¥å¤„ç†IOè¯·æ±‚, è¿™æ ·å¯ä»¥æå¤§åœ°æé«˜æ•°æ®åº“çš„æ€§èƒ½ï¼Œè€ŒIOThreadä¸»è¦è´Ÿè´£è¿™äº›IOè¯·æ±‚çš„å›è°ƒã€‚</p><p>TODO</p><h3 id="äº‹åŠ¡åŸç†" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡åŸç†" aria-hidden="true">#</a> äº‹åŠ¡åŸç†</h3><h4 id="äº‹åŠ¡åŸºç¡€" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡åŸºç¡€" aria-hidden="true">#</a> äº‹åŠ¡åŸºç¡€</h4><p>1). äº‹åŠ¡</p><p>äº‹åŠ¡ æ˜¯ä¸€ç»„æ“ä½œçš„é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¼šæŠŠæ‰€æœ‰çš„æ“ä½œä½œä¸ºä¸€ä¸ªæ•´ä½“ä¸€èµ·å‘ç³»ç»Ÿæäº¤æˆ–æ’¤é”€æ“ä½œè¯·æ±‚ï¼Œå³è¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚</p><p>2). ç‰¹æ€§</p><ul><li><p>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡æ˜¯ä¸å¯åˆ†å‰²çš„æœ€å°æ“ä½œå•å…ƒï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚</p></li><li><p>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡å®Œæˆæ—¶ï¼Œå¿…é¡»ä½¿æ‰€æœ‰çš„æ•°æ®éƒ½ä¿æŒä¸€è‡´çŠ¶æ€ã€‚</p></li><li><p>éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šæ•°æ®åº“ç³»ç»Ÿæä¾›çš„éš”ç¦»æœºåˆ¶ï¼Œä¿è¯äº‹åŠ¡åœ¨ä¸å—å¤–éƒ¨å¹¶å‘æ“ä½œå½±å“çš„ç‹¬ç«‹ç¯å¢ƒä¸‹è¿è¡Œã€‚</p></li><li><p>æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤æˆ–å›æ»šï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…çš„ã€‚</p></li></ul><p>é‚£å®é™…ä¸Šï¼Œæˆ‘ä»¬ç ”ç©¶äº‹åŠ¡çš„åŸç†ï¼Œå°±æ˜¯ç ”ç©¶MySQLçš„InnoDBå¼•æ“æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„è¿™å››å¤§ç‰¹æ€§çš„ã€‚</p><img src="/assets/image-20220427083211638-2e93c3a7.png" alt="image-20220427083211638" style="zoom:50%;"><p>è€Œå¯¹äºè¿™å››å¤§ç‰¹æ€§ï¼Œå®é™…ä¸Šåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ã€‚ å…¶ä¸­çš„åŸå­æ€§ã€ä¸€è‡´æ€§ã€æŒä¹…åŒ–ï¼Œå®é™…ä¸Šæ˜¯ç”±InnoDBä¸­çš„ä¸¤ä»½æ—¥å¿—æ¥ä¿è¯çš„ï¼Œä¸€ä»½æ˜¯redo logæ—¥å¿—ï¼Œä¸€ä»½æ˜¯undo logæ—¥å¿—ã€‚ è€Œéš”ç¦»æ€§æ˜¯é€šè¿‡æ•°æ®åº“çš„é”ï¼ŒåŠ ä¸ŠMVCCæ¥ä¿è¯çš„ã€‚</p><img src="/assets/image-20220427083250837-bcdf99ae.png" alt="image-20220427083250837" style="zoom:50%;"><p>æˆ‘ä»¬åœ¨è®²è§£äº‹åŠ¡åŸç†çš„æ—¶å€™ï¼Œä¸»è¦å°±æ˜¯æ¥ç ”ç©¶ä¸€ä¸‹redologï¼Œundologä»¥åŠMVCCã€‚</p><h4 id="redo-log-1" tabindex="-1"><a class="header-anchor" href="#redo-log-1" aria-hidden="true">#</a> redo log</h4><p>é‡åšæ—¥å¿—ï¼Œè®°å½•çš„æ˜¯äº‹åŠ¡æäº¤æ—¶æ•°æ®é¡µçš„ç‰©ç†ä¿®æ”¹ï¼Œæ˜¯ç”¨æ¥å®ç°äº‹åŠ¡çš„æŒä¹…æ€§ã€‚</p><p>è¯¥æ—¥å¿—æ–‡ä»¶ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šé‡åšæ—¥å¿—ç¼“å†²ï¼ˆredo log bufferï¼‰ä»¥åŠé‡åšæ—¥å¿—æ–‡ä»¶ï¼ˆredo logfileï¼‰,å‰è€…æ˜¯åœ¨å†…å­˜ä¸­ï¼Œåè€…åœ¨ç£ç›˜ä¸­ã€‚å½“äº‹åŠ¡æäº¤ä¹‹åä¼šæŠŠæ‰€æœ‰ä¿®æ”¹ä¿¡æ¯éƒ½å­˜åˆ°è¯¥æ—¥å¿—æ–‡ä»¶ä¸­, ç”¨äºåœ¨åˆ·æ–°è„é¡µåˆ°ç£ç›˜,å‘ç”Ÿé”™è¯¯æ—¶, è¿›è¡Œæ•°æ®æ¢å¤ä½¿ç”¨ã€‚</p><p>å¦‚æœæ²¡æœ‰redologï¼Œå¯èƒ½ä¼šå­˜åœ¨ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ æˆ‘ä»¬ä¸€èµ·æ¥åˆ†æä¸€ä¸‹ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨InnoDBå¼•æ“ä¸­çš„å†…å­˜ç»“æ„ä¸­ï¼Œä¸»è¦çš„å†…å­˜åŒºåŸŸå°±æ˜¯ç¼“å†²æ± ï¼Œåœ¨ç¼“å†²æ± ä¸­ç¼“å­˜äº†å¾ˆå¤šçš„æ•°æ®é¡µã€‚ å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ‰§è¡Œå¤šä¸ªå¢åˆ æ”¹çš„æ“ä½œæ—¶ï¼ŒInnoDBå¼•æ“ä¼šå…ˆæ“ä½œç¼“å†²æ± ä¸­çš„æ•°æ®ï¼Œå¦‚æœç¼“å†²åŒºæ²¡æœ‰å¯¹åº”çš„æ•°æ®ï¼Œä¼šé€šè¿‡åå°çº¿ç¨‹å°†ç£ç›˜ä¸­çš„æ•°æ®åŠ è½½å‡ºæ¥ï¼Œå­˜æ”¾åœ¨ç¼“å†²åŒºä¸­ï¼Œç„¶åå°†ç¼“å†²æ± ä¸­çš„æ•°æ®ä¿®æ”¹ï¼Œä¿®æ”¹åçš„æ•°æ®é¡µæˆ‘ä»¬ç§°ä¸ºè„é¡µã€‚ è€Œè„é¡µåˆ™ä¼šåœ¨ä¸€å®šçš„æ—¶æœºï¼Œé€šè¿‡åå°çº¿ç¨‹åˆ·æ–°åˆ°ç£ç›˜ä¸­ï¼Œä»è€Œä¿è¯ç¼“å†²åŒºä¸ç£ç›˜çš„æ•°æ®ä¸€è‡´ã€‚ è€Œç¼“å†²åŒºçš„è„é¡µæ•°æ®å¹¶ä¸æ˜¯å®æ—¶åˆ·æ–°çš„ï¼Œè€Œæ˜¯ä¸€æ®µæ—¶é—´ä¹‹åå°†ç¼“å†²åŒºçš„æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ä¸­ï¼Œå‡å¦‚åˆ·æ–°åˆ°ç£ç›˜çš„è¿‡ç¨‹å‡ºé”™äº†ï¼Œè€Œæç¤ºç»™ç”¨æˆ·äº‹åŠ¡æäº¤æˆåŠŸï¼Œè€Œæ•°æ®å´æ²¡æœ‰æŒä¹…åŒ–ä¸‹æ¥ï¼Œè¿™å°±å‡ºç°é—®é¢˜äº†ï¼Œæ²¡æœ‰ä¿è¯äº‹åŠ¡çš„æŒä¹…æ€§ã€‚</p><img src="/assets/image-20220427083538516-0e444d5d.png" alt="image-20220427083538516" style="zoom:50%;"><p>é‚£ä¹ˆï¼Œå¦‚ä½•è§£å†³ä¸Šè¿°çš„é—®é¢˜å‘¢ï¼Ÿ åœ¨InnoDBä¸­æä¾›äº†ä¸€ä»½æ—¥å¿— redo logï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥åˆ†æä¸€ä¸‹ï¼Œé€šè¿‡redologå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><img src="/assets/image-20220427083611859-ae614232.png" alt="image-20220427083611859" style="zoom:50%;"><p>æœ‰äº†redologä¹‹åï¼Œå½“å¯¹ç¼“å†²åŒºçš„æ•°æ®è¿›è¡Œå¢åˆ æ”¹ä¹‹åï¼Œä¼šé¦–å…ˆå°†æ“ä½œçš„æ•°æ®é¡µçš„å˜åŒ–ï¼Œè®°å½•åœ¨redolog bufferä¸­ã€‚åœ¨äº‹åŠ¡æäº¤æ—¶ï¼Œä¼šå°†redo log bufferä¸­çš„æ•°æ®åˆ·æ–°åˆ°redo logç£ç›˜æ–‡ä»¶ä¸­ã€‚è¿‡ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå¦‚æœåˆ·æ–°ç¼“å†²åŒºçš„è„é¡µåˆ°ç£ç›˜æ—¶ï¼Œå‘ç”Ÿé”™è¯¯ï¼Œæ­¤æ—¶å°±å¯ä»¥å€ŸåŠ©äºredo logè¿›è¡Œæ•°æ®æ¢å¤ï¼Œè¿™æ ·å°±ä¿è¯äº†äº‹åŠ¡çš„æŒä¹…æ€§ã€‚ è€Œå¦‚æœè„é¡µæˆåŠŸåˆ·æ–°åˆ°ç£ç›˜ æˆ– æˆ–è€…æ¶‰åŠåˆ°çš„æ•°æ®å·²ç»è½ç›˜ï¼Œæ­¤æ—¶redologå°±æ²¡æœ‰ä½œç”¨äº†ï¼Œå°±å¯ä»¥åˆ é™¤äº†ï¼Œæ‰€ä»¥å­˜åœ¨çš„ä¸¤ä¸ªredologæ–‡ä»¶æ˜¯å¾ªç¯å†™çš„ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆæ¯ä¸€æ¬¡æäº¤äº‹åŠ¡ï¼Œè¦åˆ·æ–°redo log åˆ°ç£ç›˜ä¸­å‘¢ï¼Œè€Œä¸æ˜¯ç›´æ¥å°†buffer poolä¸­çš„è„é¡µåˆ·æ–°åˆ°ç£ç›˜å‘¢ ?</p><p>å› ä¸ºåœ¨ä¸šåŠ¡æ“ä½œä¸­ï¼Œæˆ‘ä»¬æ“ä½œæ•°æ®ä¸€èˆ¬éƒ½æ˜¯éšæœºè¯»å†™ç£ç›˜çš„ï¼Œè€Œä¸æ˜¯é¡ºåºè¯»å†™ç£ç›˜ã€‚ è€Œredo logåœ¨å¾€ç£ç›˜æ–‡ä»¶ä¸­å†™å…¥æ•°æ®ï¼Œç”±äºæ˜¯æ—¥å¿—æ–‡ä»¶ï¼Œæ‰€ä»¥éƒ½æ˜¯é¡ºåºå†™çš„ã€‚é¡ºåºå†™çš„æ•ˆç‡ï¼Œè¦è¿œå¤§äºéšæœºå†™ã€‚ è¿™ç§å…ˆå†™æ—¥å¿—çš„æ–¹å¼ï¼Œç§°ä¹‹ä¸º WALï¼ˆWrite-Ahead Loggingï¼‰ã€‚</p><h4 id="undo-log" tabindex="-1"><a class="header-anchor" href="#undo-log" aria-hidden="true">#</a> undo log</h4><p>å›æ»šæ—¥å¿—ï¼Œç”¨äºè®°å½•æ•°æ®è¢«ä¿®æ”¹å‰çš„ä¿¡æ¯ , ä½œç”¨åŒ…å«ä¸¤ä¸ª : æä¾›å›æ»š(ä¿è¯äº‹åŠ¡çš„åŸå­æ€§) å’ŒMVCC(å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶) ã€‚</p><p>undo logå’Œredo logè®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯é€»è¾‘æ—¥å¿—ã€‚å¯ä»¥è®¤ä¸ºå½“deleteä¸€æ¡è®°å½•æ—¶ï¼Œundo logä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„insertè®°å½•ï¼Œåä¹‹äº¦ç„¶ï¼Œå½“updateä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åº”çš„updateè®°å½•ã€‚å½“æ‰§è¡Œrollbackæ—¶ï¼Œå°±å¯ä»¥ä»undo logä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å†…å®¹å¹¶è¿›è¡Œå›æ»šã€‚</p><p>Undo logé”€æ¯ï¼šundo logåœ¨äº‹åŠ¡æ‰§è¡Œæ—¶äº§ç”Ÿï¼Œäº‹åŠ¡æäº¤æ—¶ï¼Œå¹¶ä¸ä¼šç«‹å³åˆ é™¤undo logï¼Œå› ä¸ºè¿™äº›æ—¥å¿—å¯èƒ½è¿˜ç”¨äºMVCCã€‚</p><p>Undo logå­˜å‚¨ï¼šundo logé‡‡ç”¨æ®µçš„æ–¹å¼è¿›è¡Œç®¡ç†å’Œè®°å½•ï¼Œå­˜æ”¾åœ¨å‰é¢ä»‹ç»çš„ rollback segmentå›æ»šæ®µä¸­ï¼Œå†…éƒ¨åŒ…å«1024ä¸ªundo log segmentã€‚</p><h3 id="mvcc" tabindex="-1"><a class="header-anchor" href="#mvcc" aria-hidden="true">#</a> MVCC</h3><h4 id="åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ" aria-hidden="true">#</a> åŸºæœ¬æ¦‚å¿µ</h4><h5 id="å½“å‰è¯»" tabindex="-1"><a class="header-anchor" href="#å½“å‰è¯»" aria-hidden="true">#</a> å½“å‰è¯»</h5><p>è¯»å–çš„æ˜¯è®°å½•çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¯»å–æ—¶è¿˜è¦ä¿è¯å…¶ä»–å¹¶å‘äº‹åŠ¡ä¸èƒ½ä¿®æ”¹å½“å‰è®°å½•ï¼Œä¼šå¯¹è¯»å–çš„è®°å½•è¿›è¡ŒåŠ é”ã€‚å¯¹äºæˆ‘ä»¬æ—¥å¸¸çš„æ“ä½œï¼Œå¦‚ï¼šselect ... lock in share mode(å…±äº«é”)ï¼Œselect ... for updateã€updateã€insertã€delete(æ’ä»–é”)éƒ½æ˜¯ä¸€ç§å½“å‰è¯»ã€‚</p><p>æµ‹è¯•ï¼š</p><img src="/assets/image-20220427084241423-08fb6704.png" alt="image-20220427084241423" style="zoom:50%;"><p>åœ¨æµ‹è¯•ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿æ˜¯åœ¨é»˜è®¤çš„RRéš”ç¦»çº§åˆ«ä¸‹ï¼Œäº‹åŠ¡Aä¸­ä¾ç„¶å¯ä»¥è¯»å–åˆ°äº‹åŠ¡Bæœ€æ–°æäº¤çš„å†…å®¹ï¼Œå› ä¸ºåœ¨æŸ¥è¯¢è¯­å¥åé¢åŠ ä¸Šäº† lock in share mode å…±äº«é”ï¼Œæ­¤æ—¶æ˜¯å½“å‰è¯»æ“ä½œã€‚å½“ç„¶ï¼Œå½“æˆ‘ä»¬åŠ æ’ä»–é”çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å½“å‰è¯»æ“ä½œã€‚</p><h5 id="å¿«ç…§è¯»" tabindex="-1"><a class="header-anchor" href="#å¿«ç…§è¯»" aria-hidden="true">#</a> å¿«ç…§è¯»</h5><p>ç®€å•çš„selectï¼ˆä¸åŠ é”ï¼‰å°±æ˜¯å¿«ç…§è¯»ï¼Œå¿«ç…§è¯»ï¼Œè¯»å–çš„æ˜¯è®°å½•æ•°æ®çš„å¯è§ç‰ˆæœ¬ï¼Œæœ‰å¯èƒ½æ˜¯å†å²æ•°æ®ï¼Œä¸åŠ é”ï¼Œæ˜¯éé˜»å¡è¯»ã€‚</p><ul><li><p>Read Committedï¼šæ¯æ¬¡selectï¼Œéƒ½ç”Ÿæˆä¸€ä¸ªå¿«ç…§è¯»ã€‚</p></li><li><p>Repeatable Readï¼šå¼€å¯äº‹åŠ¡åç¬¬ä¸€ä¸ªselectè¯­å¥æ‰æ˜¯å¿«ç…§è¯»çš„åœ°æ–¹ã€‚</p></li><li><p>Serializableï¼šå¿«ç…§è¯»ä¼šé€€åŒ–ä¸ºå½“å‰è¯»ã€‚</p></li></ul><p>æµ‹è¯•:</p><img src="/assets/image-20220427084502280-e13ef5e0.png" alt="image-20220427084502280" style="zoom:50%;"><p>åœ¨æµ‹è¯•ä¸­,æˆ‘ä»¬çœ‹åˆ°å³ä½¿äº‹åŠ¡Bæäº¤äº†æ•°æ®,äº‹åŠ¡Aä¸­ä¹ŸæŸ¥è¯¢ä¸åˆ°ã€‚ åŸå› å°±æ˜¯å› ä¸ºæ™®é€šçš„selectæ˜¯å¿«ç…§è¯»ï¼Œè€Œåœ¨å½“å‰é»˜è®¤çš„RRéš”ç¦»çº§åˆ«ä¸‹ï¼Œå¼€å¯äº‹åŠ¡åç¬¬ä¸€ä¸ªselectè¯­å¥æ‰æ˜¯å¿«ç…§è¯»çš„åœ°æ–¹ï¼Œåé¢æ‰§è¡Œç›¸åŒçš„selectè¯­å¥éƒ½æ˜¯ä»å¿«ç…§ä¸­è·å–æ•°æ®ï¼Œå¯èƒ½ä¸æ˜¯å½“å‰çš„æœ€æ–°æ•°æ®ï¼Œè¿™æ ·ä¹Ÿå°±ä¿è¯äº†å¯é‡å¤è¯»ã€‚</p><h5 id="mvcc-1" tabindex="-1"><a class="header-anchor" href="#mvcc-1" aria-hidden="true">#</a> MVCC</h5><p>å…¨ç§° Multi-Version Concurrency Controlï¼Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ã€‚æŒ‡ç»´æŠ¤ä¸€ä¸ªæ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ï¼Œä½¿å¾—è¯»å†™æ“ä½œæ²¡æœ‰å†²çªï¼Œå¿«ç…§è¯»ä¸ºMySQLå®ç°MVCCæä¾›äº†ä¸€ä¸ªéé˜»å¡è¯»åŠŸèƒ½ã€‚MVCCçš„å…·ä½“å®ç°ï¼Œè¿˜éœ€è¦ä¾èµ–äºæ•°æ®åº“è®°å½•ä¸­çš„ä¸‰ä¸ªéšå¼å­—æ®µã€undo logæ—¥å¿—ã€readViewã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥ä»‹ç»ä¸€ä¸‹InnoDBå¼•æ“çš„è¡¨ä¸­æ¶‰åŠåˆ°çš„éšè—å­—æ®µ ã€undolog ä»¥åŠ readviewï¼Œä»è€Œæ¥ä»‹ç»ä¸€ä¸‹MVCCçš„åŸç†ã€‚</p><h4 id="éšè—å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#éšè—å­—æ®µ" aria-hidden="true">#</a> éšè—å­—æ®µ</h4><h5 id="ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#ä»‹ç»" aria-hidden="true">#</a> ä»‹ç»</h5><img src="/assets/image-20220427084719578-a9c15b28.png" alt="image-20220427084719578" style="zoom:50%;"><p>å½“æˆ‘ä»¬åˆ›å»ºäº†ä¸Šé¢çš„è¿™å¼ è¡¨ï¼Œæˆ‘ä»¬åœ¨æŸ¥çœ‹è¡¨ç»“æ„çš„æ—¶å€™ï¼Œå°±å¯ä»¥æ˜¾å¼çš„çœ‹åˆ°è¿™ä¸‰ä¸ªå­—æ®µã€‚ å®é™…ä¸Šé™¤äº†è¿™ä¸‰ä¸ªå­—æ®µä»¥å¤–ï¼ŒInnoDBè¿˜ä¼šè‡ªåŠ¨çš„ç»™æˆ‘ä»¬æ·»åŠ ä¸‰ä¸ªéšè—å­—æ®µåŠå…¶å«ä¹‰åˆ†åˆ«æ˜¯ï¼š</p><table><thead><tr><th><strong>éšè—å­—æ®µ</strong></th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>DB_TRX_ID</td><td>æœ€è¿‘ä¿®æ”¹äº‹åŠ¡IDï¼Œè®°å½•æ’å…¥è¿™æ¡è®°å½•æˆ–æœ€åä¸€æ¬¡ä¿®æ”¹è¯¥è®°å½•çš„äº‹åŠ¡IDã€‚</td></tr><tr><td>DB_ROLL_PTR</td><td>å›æ»šæŒ‡é’ˆï¼ŒæŒ‡å‘è¿™æ¡è®°å½•çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œç”¨äºé…åˆundo logï¼ŒæŒ‡å‘ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚</td></tr><tr><td>DB_ROW_ID</td><td>éšè—ä¸»é”®ï¼Œå¦‚æœè¡¨ç»“æ„æ²¡æœ‰æŒ‡å®šä¸»é”®ï¼Œå°†ä¼šç”Ÿæˆè¯¥éšè—å­—æ®µã€‚</td></tr></tbody></table><p>è€Œä¸Šè¿°çš„å‰ä¸¤ä¸ªå­—æ®µæ˜¯è‚¯å®šä¼šæ·»åŠ çš„ï¼Œ æ˜¯å¦æ·»åŠ æœ€åä¸€ä¸ªå­—æ®µDB_ROW_IDï¼Œå¾—çœ‹å½“å‰è¡¨æœ‰æ²¡æœ‰ä¸»é”®ï¼Œå¦‚æœæœ‰ä¸»é”®ï¼Œåˆ™ä¸ä¼šæ·»åŠ è¯¥éšè—å­—æ®µã€‚</p><h5 id="æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•" aria-hidden="true">#</a> æµ‹è¯•</h5><p>æŸ¥çœ‹æœ‰ä¸»é”®çš„è¡¨ stu</p><p>è¿›å…¥æœåŠ¡å™¨ä¸­çš„ /var/lib/mysql/itcast/ , æŸ¥çœ‹stuçš„è¡¨ç»“æ„ä¿¡æ¯, é€šè¿‡å¦‚ä¸‹æŒ‡ä»¤:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ibd2sdi stu.ibd 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æŸ¥çœ‹åˆ°çš„è¡¨ç»“æ„ä¿¡æ¯ä¸­ï¼Œæœ‰ä¸€æ  columnsï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬ä¼šçœ‹åˆ°å¤„ç†æˆ‘ä»¬å»ºè¡¨æ—¶æŒ‡å®šçš„å­—æ®µä»¥å¤–ï¼Œè¿˜æœ‰é¢å¤–çš„ä¸¤ä¸ªå­—æ®µ åˆ†åˆ«æ˜¯ï¼šDB_TRX_ID ã€ DB_ROLL_PTR ï¼Œå› ä¸ºè¯¥è¡¨æœ‰ä¸»é”®ï¼Œæ‰€ä»¥æ²¡æœ‰DB_ROW_IDéšè—å­—æ®µã€‚</p><img src="/assets/image-20220427090457189-2ee6540d.png" alt="image-20220427090457189" style="zoom:50%;"><img src="/assets/image-20220427090527928-9be50345.png" alt="image-20220427090527928" style="zoom:50%;"><p>æŸ¥çœ‹æ²¡æœ‰ä¸»é”®çš„è¡¨ employee</p><p>å»ºè¡¨è¯­å¥ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>create table employee (id int , name varchar(10));
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å†é€šè¿‡ä»¥ä¸‹æŒ‡ä»¤æ¥æŸ¥çœ‹è¡¨ç»“æ„åŠå…¶å…¶ä¸­çš„å­—æ®µä¿¡æ¯ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ibd2sdi employee.ibd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æŸ¥çœ‹åˆ°çš„è¡¨ç»“æ„ä¿¡æ¯ä¸­ï¼Œæœ‰ä¸€æ  columnsï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬ä¼šçœ‹åˆ°å¤„ç†æˆ‘ä»¬å»ºè¡¨æ—¶æŒ‡å®šçš„å­—æ®µä»¥å¤–ï¼Œè¿˜æœ‰é¢å¤–çš„ä¸‰ä¸ªå­—æ®µ åˆ†åˆ«æ˜¯ï¼šDB_TRX_ID ã€ DB_ROLL_PTR ã€DB_ROW_IDï¼Œå› ä¸ºemployeeè¡¨æ˜¯æ²¡æœ‰æŒ‡å®šä¸»é”®çš„ã€‚</p><h4 id="undolog" tabindex="-1"><a class="header-anchor" href="#undolog" aria-hidden="true">#</a> undolog</h4><p>å›æ»šæ—¥å¿—ï¼Œåœ¨insertã€updateã€deleteçš„æ—¶å€™äº§ç”Ÿçš„ä¾¿äºæ•°æ®å›æ»šçš„æ—¥å¿—ã€‚</p><p>å½“insertçš„æ—¶å€™ï¼Œäº§ç”Ÿçš„undo logæ—¥å¿—åªåœ¨å›æ»šæ—¶éœ€è¦ï¼Œåœ¨äº‹åŠ¡æäº¤åï¼Œå¯è¢«ç«‹å³åˆ é™¤ã€‚ è€Œupdateã€deleteçš„æ—¶å€™ï¼Œäº§ç”Ÿçš„undo logæ—¥å¿—ä¸ä»…åœ¨å›æ»šæ—¶éœ€è¦ï¼Œåœ¨å¿«ç…§è¯»æ—¶ä¹Ÿéœ€è¦ï¼Œä¸ä¼šç«‹å³è¢«åˆ é™¤ã€‚</p><h5 id="ç‰ˆæœ¬é“¾" tabindex="-1"><a class="header-anchor" href="#ç‰ˆæœ¬é“¾" aria-hidden="true">#</a> ç‰ˆæœ¬é“¾</h5><p>æœ‰ä¸€å¼ è¡¨åŸå§‹æ•°æ®ä¸ºï¼š</p><img src="/assets/image-20220427090814049-0448562a.png" alt="image-20220427090814049" style="zoom:50%;"><blockquote><p>DB_TRX_ID : ä»£è¡¨æœ€è¿‘ä¿®æ”¹äº‹åŠ¡IDï¼Œè®°å½•æ’å…¥è¿™æ¡è®°å½•æˆ–æœ€åä¸€æ¬¡ä¿®æ”¹è¯¥è®°å½•çš„äº‹åŠ¡IDï¼Œæ˜¯è‡ªå¢çš„ã€‚</p><p>DB_ROLL_PTR ï¼š ç”±äºè¿™æ¡æ•°æ®æ˜¯æ‰æ’å…¥çš„ï¼Œæ²¡æœ‰è¢«æ›´æ–°è¿‡ï¼Œæ‰€ä»¥è¯¥å­—æ®µå€¼ä¸ºnullã€‚</p></blockquote><p>ç„¶åï¼Œæœ‰å››ä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶åœ¨è®¿é—®è¿™å¼ è¡¨ã€‚</p><p>A. ç¬¬ä¸€æ­¥</p><img src="/assets/image-20220427090918139-7e0ea374.png" alt="image-20220427090918139" style="zoom:50%;"><p>å½“äº‹åŠ¡2æ‰§è¡Œç¬¬ä¸€æ¡ä¿®æ”¹è¯­å¥æ—¶ï¼Œä¼šè®°å½•undo logæ—¥å¿—ï¼Œè®°å½•æ•°æ®å˜æ›´ä¹‹å‰çš„æ ·å­; ç„¶åæ›´æ–°è®°å½•ï¼Œå¹¶ä¸”è®°å½•æœ¬æ¬¡æ“ä½œçš„äº‹åŠ¡IDï¼Œå›æ»šæŒ‡é’ˆï¼Œå›æ»šæŒ‡é’ˆç”¨æ¥æŒ‡å®šå¦‚æœå‘ç”Ÿå›æ»šï¼Œå›æ»šåˆ°å“ªä¸€ä¸ªç‰ˆæœ¬ã€‚</p><img src="/assets/image-20220427091020709-1f5e011e.png" alt="image-20220427091020709" style="zoom:50%;"><p>B.ç¬¬äºŒæ­¥</p><img src="/assets/image-20220427091058108-791f5b90.png" alt="image-20220427091058108" style="zoom:50%;"><p>å½“äº‹åŠ¡3æ‰§è¡Œç¬¬ä¸€æ¡ä¿®æ”¹è¯­å¥æ—¶ï¼Œä¹Ÿä¼šè®°å½•undo logæ—¥å¿—ï¼Œè®°å½•æ•°æ®å˜æ›´ä¹‹å‰çš„æ ·å­; ç„¶åæ›´æ–°è®°å½•ï¼Œå¹¶ä¸”è®°å½•æœ¬æ¬¡æ“ä½œçš„äº‹åŠ¡IDï¼Œå›æ»šæŒ‡é’ˆï¼Œå›æ»šæŒ‡é’ˆç”¨æ¥æŒ‡å®šå¦‚æœå‘ç”Ÿå›æ»šï¼Œå›æ»šåˆ°å“ªä¸€ä¸ªç‰ˆæœ¬ã€‚</p><img src="/assets/image-20220427091138980-8754656f.png" alt="image-20220427091138980" style="zoom:50%;"><p>C. ç¬¬ä¸‰æ­¥</p><img src="/assets/image-20220427091218848-5b55e075.png" alt="image-20220427091218848" style="zoom:50%;"><p>å½“äº‹åŠ¡4æ‰§è¡Œç¬¬ä¸€æ¡ä¿®æ”¹è¯­å¥æ—¶ï¼Œä¹Ÿä¼šè®°å½•undo logæ—¥å¿—ï¼Œè®°å½•æ•°æ®å˜æ›´ä¹‹å‰çš„æ ·å­; ç„¶åæ›´æ–°è®°å½•ï¼Œå¹¶ä¸”è®°å½•æœ¬æ¬¡æ“ä½œçš„äº‹åŠ¡IDï¼Œå›æ»šæŒ‡é’ˆï¼Œå›æ»šæŒ‡é’ˆç”¨æ¥æŒ‡å®šå¦‚æœå‘ç”Ÿå›æ»šï¼Œå›æ»šåˆ°å“ªä¸€ä¸ªç‰ˆæœ¬ã€‚</p><img src="/assets/image-20220427091253293-19e1526e.png" alt="image-20220427091253293" style="zoom:50%;"><blockquote><p>æœ€ç»ˆæˆ‘ä»¬å‘ç°ï¼Œä¸åŒäº‹åŠ¡æˆ–ç›¸åŒäº‹åŠ¡å¯¹åŒä¸€æ¡è®°å½•è¿›è¡Œä¿®æ”¹ï¼Œä¼šå¯¼è‡´è¯¥è®°å½•çš„undologç”Ÿæˆä¸€æ¡</p><p>è®°å½•ç‰ˆæœ¬é“¾è¡¨ï¼Œé“¾è¡¨çš„å¤´éƒ¨æ˜¯æœ€æ–°çš„æ—§è®°å½•ï¼Œé“¾è¡¨å°¾éƒ¨æ˜¯æœ€æ—©çš„æ—§è®°å½•ã€‚</p></blockquote><h4 id="readview" tabindex="-1"><a class="header-anchor" href="#readview" aria-hidden="true">#</a> readview</h4><p>ReadViewï¼ˆè¯»è§†å›¾ï¼‰æ˜¯ å¿«ç…§è¯» SQLæ‰§è¡Œæ—¶MVCCæå–æ•°æ®çš„ä¾æ®ï¼Œè®°å½•å¹¶ç»´æŠ¤ç³»ç»Ÿå½“å‰æ´»è·ƒçš„äº‹åŠ¡ï¼ˆæœªæäº¤çš„ï¼‰idã€‚</p><p>ReadViewä¸­åŒ…å«äº†å››ä¸ªæ ¸å¿ƒå­—æ®µï¼š</p><table><thead><tr><th>å­—æ®µ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>m_ids</td><td>å½“å‰æ´»è·ƒçš„äº‹åŠ¡IDé›†åˆ</td></tr><tr><td>min_trx_id</td><td>æœ€å°æ´»è·ƒäº‹åŠ¡ID</td></tr><tr><td>max_trx_id</td><td>é¢„åˆ†é…äº‹åŠ¡IDï¼Œå½“å‰æœ€å¤§äº‹åŠ¡ID+1ï¼ˆå› ä¸ºäº‹åŠ¡IDæ˜¯è‡ªå¢çš„ï¼‰</td></tr><tr><td>creator_trx_id</td><td>ReadViewåˆ›å»ºè€…çš„äº‹åŠ¡ID</td></tr></tbody></table><p>è€Œåœ¨readviewä¸­å°±è§„å®šäº†ç‰ˆæœ¬é“¾æ•°æ®çš„è®¿é—®è§„åˆ™ï¼š</p><p>trx_id ä»£è¡¨å½“å‰undologç‰ˆæœ¬é“¾å¯¹åº”äº‹åŠ¡IDã€‚</p><table><thead><tr><th>æ¡ä»¶</th><th>æ˜¯å¦å¯ä»¥è®¿é—®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>trx_id ==creator_trx_id</td><td>å¯ä»¥è®¿é—®è¯¥ç‰ˆæœ¬</td><td>æˆç«‹ï¼Œè¯´æ˜æ•°æ®æ˜¯å½“å‰è¿™ä¸ªäº‹åŠ¡æ›´æ”¹çš„ã€‚</td></tr><tr><td>trx_id &lt; min_trx_id</td><td>å¯ä»¥è®¿é—®è¯¥ç‰ˆæœ¬</td><td>æˆç«‹ï¼Œè¯´æ˜æ•°æ®å·²ç»æäº¤äº†ã€‚</td></tr><tr><td>trx_id &gt; max_trx_id</td><td>ä¸å¯ä»¥è®¿é—®è¯¥ç‰ˆæœ¬</td><td>æˆç«‹ï¼Œè¯´æ˜è¯¥äº‹åŠ¡æ˜¯åœ¨ReadViewç”Ÿæˆåæ‰å¼€å¯ã€‚</td></tr><tr><td>min_trx_id &lt;= trx_id &lt;= max_trx_id</td><td>å¦‚æœtrx_idä¸åœ¨m_idsä¸­ï¼Œæ˜¯å¯ä»¥è®¿é—®è¯¥ç‰ˆæœ¬çš„</td><td>æˆç«‹ï¼Œè¯´æ˜æ•°æ®å·²ç»æäº¤ã€‚</td></tr></tbody></table><p>ä¸åŒçš„éš”ç¦»çº§åˆ«ï¼Œç”ŸæˆReadViewçš„æ—¶æœºä¸åŒï¼š</p><ul><li><p>READ COMMITTED ï¼šåœ¨äº‹åŠ¡ä¸­æ¯ä¸€æ¬¡æ‰§è¡Œå¿«ç…§è¯»æ—¶ç”ŸæˆReadViewã€‚</p></li><li><p>REPEATABLE READï¼šä»…åœ¨äº‹åŠ¡ä¸­ç¬¬ä¸€æ¬¡æ‰§è¡Œå¿«ç…§è¯»æ—¶ç”ŸæˆReadViewï¼Œåç»­å¤ç”¨è¯¥ReadViewã€‚</p></li></ul><h4 id="åŸç†åˆ†æ" tabindex="-1"><a class="header-anchor" href="#åŸç†åˆ†æ" aria-hidden="true">#</a> åŸç†åˆ†æ</h4><h5 id="rcéš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#rcéš”ç¦»çº§åˆ«" aria-hidden="true">#</a> RCéš”ç¦»çº§åˆ«</h5><p>RCéš”ç¦»çº§åˆ«ä¸‹ï¼Œåœ¨äº‹åŠ¡ä¸­æ¯ä¸€æ¬¡æ‰§è¡Œå¿«ç…§è¯»æ—¶éƒ½ä¼šç”ŸæˆReadViewã€‚</p><p>æˆ‘ä»¬å°±æ¥åˆ†æäº‹åŠ¡5ä¸­ï¼Œä¸¤æ¬¡å¿«ç…§è¯»è¯»å–æ•°æ®ï¼Œæ˜¯å¦‚ä½•è·å–æ•°æ®çš„?</p><p>åœ¨äº‹åŠ¡5ä¸­ï¼ŒæŸ¥è¯¢äº†ä¸¤æ¬¡idä¸º30çš„è®°å½•ï¼Œç”±äºéš”ç¦»çº§åˆ«ä¸ºRead Committedï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡è¿›è¡Œå¿«ç…§è¯»éƒ½ä¼šç”Ÿæˆä¸€ä¸ªReadViewï¼Œé‚£ä¹ˆä¸¤æ¬¡ç”Ÿæˆçš„ReadViewå¦‚ä¸‹ã€‚</p><img src="/assets/image-20220427093322038-d65aa84b.png" alt="image-20220427093322038" style="zoom:50%;"><p>é‚£ä¹ˆè¿™ä¸¤æ¬¡å¿«ç…§è¯»åœ¨è·å–æ•°æ®æ—¶ï¼Œå°±éœ€è¦æ ¹æ®æ‰€ç”Ÿæˆçš„ReadViewä»¥åŠReadViewçš„ç‰ˆæœ¬é“¾è®¿é—®è§„åˆ™ï¼Œåˆ°undologç‰ˆæœ¬é“¾ä¸­åŒ¹é…æ•°æ®ï¼Œæœ€ç»ˆå†³å®šæ­¤æ¬¡å¿«ç…§è¯»è¿”å›çš„æ•°æ®ã€‚</p><p>å…ˆæ¥çœ‹ç¬¬ä¸€æ¬¡å¿«ç…§è¯»å…·ä½“çš„è¯»å–è¿‡ç¨‹ï¼š</p><img src="/assets/image-20220427093417945-63875f58.png" alt="image-20220427093417945" style="zoom:50%;"><img src="/assets/image-20220427093449949-45d23b43.png" alt="image-20220427093449949" style="zoom:50%;"><p>åœ¨è¿›è¡ŒåŒ¹é…æ—¶ï¼Œä¼šä»undo logçš„ç‰ˆæœ¬é“¾ï¼Œä»ä¸Šåˆ°ä¸‹è¿›è¡ŒæŒ¨ä¸ªåŒ¹é…ï¼Œåœ¨é‡åˆ°ç¬¬ä¸€æ¡å¤åˆçš„è®°å½•åï¼Œå°±ç›´æ¥è¿”å›äº†</p><p>è¿™é‡Œè¿”å›çš„æ˜¯0x00002å¯¹åº”çš„è®°å½•</p><blockquote><p>è¿™ä¹ˆå¤šåˆ¤æ–­å°±æ˜¯ä¸ºäº†åˆ¤æ–­ä¸€ä»¶äº‹ï¼š</p><p><strong>å½“å‰è®°å½•å¯¹åº”çš„äº‹ç‰©idæ˜¯å¦æ˜¯æ´»è·ƒçš„äº‹ç‰©idï¼Œå¦‚æœæ´»è·ƒï¼Œå°±ä¸å¯ä»¥è®¿é—®ï¼Œåä¹‹ï¼Œå¯ä»¥è®¿é—®</strong></p></blockquote><p>B. å†æ¥çœ‹ç¬¬äºŒæ¬¡å¿«ç…§è¯»å…·ä½“çš„è¯»å–è¿‡ç¨‹:</p><img src="/assets/image-20220427093417945-63875f58.png" alt="image-20220427093417945" style="zoom:50%;"><img src="/assets/image-20220427093449949-45d23b43.png" alt="image-20220427093449949" style="zoom:50%;"><p>åœ¨è¿›è¡ŒåŒ¹é…æ—¶ï¼Œä¼šä»undo logçš„ç‰ˆæœ¬é“¾ï¼Œä»ä¸Šåˆ°ä¸‹è¿›è¡ŒæŒ¨ä¸ªåŒ¹é…ï¼Œåœ¨é‡åˆ°ç¬¬ä¸€æ¡å¤åˆçš„è®°å½•åï¼Œå°±ç›´æ¥è¿”å›äº†</p><p>è¿™é‡Œè¿”å›çš„æ˜¯0x00003å¯¹åº”çš„è®°å½•</p><h5 id="rréš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#rréš”ç¦»çº§åˆ«" aria-hidden="true">#</a> RRéš”ç¦»çº§åˆ«</h5><p>RRéš”ç¦»çº§åˆ«ä¸‹ï¼Œä»…åœ¨äº‹åŠ¡ä¸­ç¬¬ä¸€æ¬¡æ‰§è¡Œå¿«ç…§è¯»æ—¶ç”ŸæˆReadViewï¼Œåç»­å¤ç”¨è¯¥ReadViewã€‚ è€ŒRR æ˜¯å¯é‡å¤è¯»ï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ‰§è¡Œä¸¤æ¬¡ç›¸åŒçš„selectè¯­å¥ï¼ŒæŸ¥è¯¢åˆ°çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p><p>é‚£MySQLæ˜¯å¦‚ä½•åšåˆ°å¯é‡å¤è¯»çš„å‘¢? æˆ‘ä»¬ç®€å•åˆ†æä¸€ä¸‹å°±çŸ¥é“äº†</p><img src="/assets/image-20220427095606457-16bc627c.png" alt="image-20220427095606457" style="zoom:50%;"><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨RRéš”ç¦»çº§åˆ«ä¸‹ï¼Œåªæ˜¯åœ¨äº‹åŠ¡ä¸­ç¬¬ä¸€æ¬¡å¿«ç…§è¯»æ—¶ç”ŸæˆReadViewï¼Œåç»­éƒ½æ˜¯å¤ç”¨è¯¥ReadViewï¼Œé‚£ä¹ˆæ—¢ç„¶ReadViewéƒ½ä¸€æ ·ï¼Œ ReadViewçš„ç‰ˆæœ¬é“¾åŒ¹é…è§„åˆ™ä¹Ÿä¸€æ ·ï¼Œ é‚£ä¹ˆæœ€ç»ˆå¿«ç…§è¯»è¿”å›çš„ç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p><p>æ‰€ä»¥å‘¢ï¼ŒMVCCçš„å®ç°åŸç†å°±æ˜¯é€šè¿‡ InnoDBè¡¨çš„éšè—å­—æ®µã€UndoLog ç‰ˆæœ¬é“¾ã€ReadViewæ¥å®ç°çš„ã€‚è€ŒMVCC + é”ï¼Œåˆ™å®ç°äº†äº‹åŠ¡çš„éš”ç¦»æ€§ã€‚ è€Œä¸€è‡´æ€§åˆ™æ˜¯ç”±redolog ä¸ undologä¿è¯ã€‚</p><img src="/assets/image-20220427095709975-72ac66a5.png" alt="image-20220427095709975" style="zoom:50%;"><h2 id="è¿›é˜¶ç¯‡-mysqlç®¡ç†" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶ç¯‡-mysqlç®¡ç†" aria-hidden="true">#</a> è¿›é˜¶ç¯‡-MySQLç®¡ç†</h2><h3 id="ç³»ç»Ÿæ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#ç³»ç»Ÿæ•°æ®åº“" aria-hidden="true">#</a> ç³»ç»Ÿæ•°æ®åº“</h3><p>Mysqlæ•°æ®åº“å®‰è£…å®Œæˆåï¼Œè‡ªå¸¦äº†ä¸€ä¸‹å››ä¸ªæ•°æ®åº“ï¼Œå…·ä½“ä½œç”¨å¦‚ä¸‹ï¼š</p><table><thead><tr><th>æ•°æ®åº“</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>mysql</td><td>å­˜å‚¨MySQLæœåŠ¡å™¨æ­£å¸¸è¿è¡Œæ‰€éœ€è¦çš„å„ç§ä¿¡æ¯ ï¼ˆæ—¶åŒºã€ä¸»ä»ã€ç”¨æˆ·ã€æƒé™ç­‰ï¼‰</td></tr><tr><td>information_schema</td><td>æä¾›äº†è®¿é—®æ•°æ®åº“å…ƒæ•°æ®çš„å„ç§è¡¨å’Œè§†å›¾ï¼ŒåŒ…å«æ•°æ®åº“ã€è¡¨ã€å­—æ®µç±»å‹åŠè®¿é—®æƒé™ç­‰</td></tr><tr><td>performance_schema</td><td>ä¸ºMySQLæœåŠ¡å™¨è¿è¡Œæ—¶çŠ¶æ€æä¾›äº†ä¸€ä¸ªåº•å±‚ç›‘æ§åŠŸèƒ½ï¼Œä¸»è¦ç”¨äºæ”¶é›†æ•°æ®åº“æœåŠ¡å™¨æ€§èƒ½å‚æ•°</td></tr><tr><td>sys</td><td>åŒ…å«äº†ä¸€ç³»åˆ—æ–¹ä¾¿ DBA å’Œå¼€å‘äººå‘˜åˆ©ç”¨ performance_schemaæ€§èƒ½æ•°æ®åº“è¿›è¡Œæ€§èƒ½è°ƒä¼˜å’Œè¯Šæ–­çš„è§†å›¾</td></tr></tbody></table><h3 id="å¸¸ç”¨å·¥å…·" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨å·¥å…·" aria-hidden="true">#</a> å¸¸ç”¨å·¥å…·</h3><h4 id="nysql" tabindex="-1"><a class="header-anchor" href="#nysql" aria-hidden="true">#</a> nysql</h4><p>è¯¥mysqlä¸æ˜¯æŒ‡mysqlæœåŠ¡ï¼Œè€Œæ˜¯æŒ‡mysqlçš„å®¢æˆ·ç«¯å·¥å…·ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>è¯­æ³• ï¼š
	mysql [options] [database] 
é€‰é¡¹ ï¼š
	-u, --user=name #æŒ‡å®šç”¨æˆ·å 
	-p, --password[=name] #æŒ‡å®šå¯†ç  
	-h, --host=name #æŒ‡å®šæœåŠ¡å™¨IPæˆ–åŸŸå 
	-P, --port=port #æŒ‡å®šè¿æ¥ç«¯å£ 
	-e, --execute=name #æ‰§è¡ŒSQLè¯­å¥å¹¶é€€å‡º
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>-eé€‰é¡¹å¯ä»¥åœ¨Mysqlå®¢æˆ·ç«¯æ‰§è¡ŒSQLè¯­å¥ï¼Œè€Œä¸ç”¨è¿æ¥åˆ°MySQLæ•°æ®åº“å†æ‰§è¡Œï¼Œå¯¹äºä¸€äº›æ‰¹å¤„ç†è„šæœ¬ï¼Œè¿™ç§æ–¹å¼å°¤å…¶æ–¹ä¾¿ã€‚</p><h4 id="mysqladmin" tabindex="-1"><a class="header-anchor" href="#mysqladmin" aria-hidden="true">#</a> mysqladmin</h4><p>mysqladmin æ˜¯ä¸€ä¸ªæ‰§è¡Œç®¡ç†æ“ä½œçš„å®¢æˆ·ç«¯ç¨‹åºã€‚å¯ä»¥ç”¨å®ƒæ¥æ£€æŸ¥æœåŠ¡å™¨çš„é…ç½®å’Œå½“å‰çŠ¶æ€ã€åˆ›å»ºå¹¶åˆ é™¤æ•°æ®åº“ç­‰ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>é€šè¿‡å¸®åŠ©æ–‡æ¡£æŸ¥çœ‹é€‰é¡¹ï¼š 
mysqladmin --help
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220427101337195-b4f0c23e.png" alt="image-20220427101337195" style="zoom:50%;"><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>è¯­æ³•:
	mysqladmin [options] command ... 

é€‰é¡¹:
	-u, --user=name #æŒ‡å®šç”¨æˆ·å 
	-p, --password[=name] #æŒ‡å®šå¯†ç  
	-h, --host=name #æŒ‡å®šæœåŠ¡å™¨IPæˆ–åŸŸå 
	-P, --port=port #æŒ‡å®šè¿æ¥ç«¯å£ 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mysqlbinlog" tabindex="-1"><a class="header-anchor" href="#mysqlbinlog" aria-hidden="true">#</a> mysqlbinlog</h4><p>ç”±äºæœåŠ¡å™¨ç”Ÿæˆçš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ä»¥äºŒè¿›åˆ¶æ ¼å¼ä¿å­˜ï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦æ£€æŸ¥è¿™äº›æ–‡æœ¬çš„æ–‡æœ¬æ ¼å¼ï¼Œå°±ä¼šä½¿ç”¨åˆ°mysqlbinlog æ—¥å¿—ç®¡ç†å·¥å…·ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>è¯­æ³• ï¼š
	mysqlbinlog [options] log-files1 log-files2 ... 
é€‰é¡¹ ï¼š
	-d, --database=name æŒ‡å®šæ•°æ®åº“åç§°ï¼Œåªåˆ—å‡ºæŒ‡å®šçš„æ•°æ®åº“ç›¸å…³æ“ä½œã€‚ 
	-o, --offset=# å¿½ç•¥æ‰æ—¥å¿—ä¸­çš„å‰nè¡Œå‘½ä»¤ã€‚ 
	-r,--result-file=name å°†è¾“å‡ºçš„æ–‡æœ¬æ ¼å¼æ—¥å¿—è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ã€‚ 
	-s, --short-form æ˜¾ç¤ºç®€å•æ ¼å¼ï¼Œ çœç•¥æ‰ä¸€äº›ä¿¡æ¯ã€‚ 
	--start-datatime=date1 --stop-datetime=date2 æŒ‡å®šæ—¥æœŸé—´éš”å†…çš„æ‰€æœ‰æ—¥å¿—ã€‚ 
	--start-position=pos1 --stop-position=pos2 æŒ‡å®šä½ç½®é—´éš”å†…çš„æ‰€æœ‰æ—¥å¿—ã€‚
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mysqlshow" tabindex="-1"><a class="header-anchor" href="#mysqlshow" aria-hidden="true">#</a> mysqlshow</h4><p>mysqlshow å®¢æˆ·ç«¯å¯¹è±¡æŸ¥æ‰¾å·¥å…·ï¼Œç”¨æ¥å¾ˆå¿«åœ°æŸ¥æ‰¾å­˜åœ¨å“ªäº›æ•°æ®åº“ã€æ•°æ®åº“ä¸­çš„è¡¨ã€è¡¨ä¸­çš„åˆ—æˆ–è€…ç´¢å¼•ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>è¯­æ³• ï¼š
	mysqlshow <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>db_name <span class="token punctuation">[</span>table_name <span class="token punctuation">[</span>col_name<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> 

é€‰é¡¹ ï¼š
	<span class="token comment">--count æ˜¾ç¤ºæ•°æ®åº“åŠè¡¨çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ•°æ®åº“ï¼Œè¡¨ å‡å¯ä»¥ä¸æŒ‡å®šï¼‰ </span>
	<span class="token operator">-</span>i æ˜¾ç¤ºæŒ‡å®šæ•°æ®åº“æˆ–è€…æŒ‡å®šè¡¨çš„çŠ¶æ€ä¿¡æ¯ 

ç¤ºä¾‹ï¼š
	<span class="token comment">#æŸ¥è¯¢teståº“ä¸­æ¯ä¸ªè¡¨ä¸­çš„å­—æ®µä¹¦ï¼ŒåŠè¡Œæ•° </span>
	mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p2143 test <span class="token comment">--count </span>
	
	<span class="token comment">#æŸ¥è¯¢teståº“ä¸­bookè¡¨çš„è¯¦ç»†æƒ…å†µ </span>
	mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p2143 test book <span class="token comment">--count</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mysqldump" tabindex="-1"><a class="header-anchor" href="#mysqldump" aria-hidden="true">#</a> mysqldump</h4><p>mysqldump å®¢æˆ·ç«¯å·¥å…·ç”¨æ¥å¤‡ä»½æ•°æ®åº“æˆ–åœ¨ä¸åŒæ•°æ®åº“ä¹‹é—´è¿›è¡Œæ•°æ®è¿ç§»ã€‚å¤‡ä»½å†…å®¹åŒ…å«åˆ›å»ºè¡¨ï¼ŒåŠæ’å…¥è¡¨çš„SQLè¯­å¥ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>è¯­æ³• ï¼š
	mysqldump [options] db_name [tables] 
	mysqldump [options] --database/-B db1 [db2 db3...] 
	mysqldump [options] --all-databases/-A 
	
è¿æ¥é€‰é¡¹ ï¼š 
	-u, --user=name æŒ‡å®šç”¨æˆ·å 
	-p, --password[=name] æŒ‡å®šå¯†ç  
	-h, --host=name æŒ‡å®šæœåŠ¡å™¨ipæˆ–åŸŸå 
	-P, --port=# æŒ‡å®šè¿æ¥ç«¯å£ 

è¾“å‡ºé€‰é¡¹ï¼š 
	--add-drop-database åœ¨æ¯ä¸ªæ•°æ®åº“åˆ›å»ºè¯­å¥å‰åŠ ä¸Š drop database è¯­å¥ 
	--add-drop-table åœ¨æ¯ä¸ªè¡¨åˆ›å»ºè¯­å¥å‰åŠ ä¸Š drop table è¯­å¥ , é»˜è®¤å¼€å¯ ; ä¸ å¼€å¯ (--skip-add-drop-table) 
	-n, --no-create-db ä¸åŒ…å«æ•°æ®åº“çš„åˆ›å»ºè¯­å¥ 
	-t, --no-create-info ä¸åŒ…å«æ•°æ®è¡¨çš„åˆ›å»ºè¯­å¥ 
	-d --no-data ä¸åŒ…å«æ•°æ® 
	-T, --tab=name è‡ªåŠ¨ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼šä¸€ä¸ª.sqlæ–‡ä»¶ï¼Œåˆ›å»ºè¡¨ç»“æ„çš„è¯­å¥ï¼›ä¸€ ä¸ª.txtæ–‡ä»¶ï¼Œæ•°æ®æ–‡ä»¶
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mysqlimport-source" tabindex="-1"><a class="header-anchor" href="#mysqlimport-source" aria-hidden="true">#</a> mysqlimport/source</h4><p><strong>mysqlimport</strong>ï¼š æ˜¯å®¢æˆ·ç«¯æ•°æ®å¯¼å…¥å·¥å…·ï¼Œç”¨æ¥å¯¼å…¥mysqldump åŠ  -T å‚æ•°åå¯¼å‡ºçš„æ–‡æœ¬æ–‡ä»¶ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>è¯­æ³• ï¼š
	mysqlimport <span class="token punctuation">[</span>options<span class="token punctuation">]</span> db_name textfile1 <span class="token punctuation">[</span>textfile2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> 
ç¤ºä¾‹ ï¼š
	mysqlimport <span class="token operator">-</span>uroot <span class="token operator">-</span>p2143 test <span class="token operator">/</span>tmp<span class="token operator">/</span>city<span class="token punctuation">.</span>txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>source</strong>ï¼šå¦‚æœéœ€è¦å¯¼å…¥sqlæ–‡ä»¶,å¯ä»¥ä½¿ç”¨mysqlä¸­çš„source æŒ‡ä»¤ :</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>è¯­æ³• ï¼š
	source <span class="token operator">/</span>root<span class="token operator">/</span>xxxxx<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><!----><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 895252461@qq.com">xuliang</span>,<!--]--><!--[--><span class="contributor" title="email: 895252461@qq.com">è¯—äººéƒ½è—åœ¨æ°´åº•</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/database/mysql/mysql-base.html" class="nav-link prev" aria-label="MySQL åŸºç¡€ç¯‡"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->MySQL åŸºç¡€ç¯‡</div></a><a href="/database/mysql/mysql-devops.html" class="nav-link next" aria-label="MySQL è¿ç»´ç¯‡"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">MySQL è¿ç»´ç¯‡<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-c593f505.js" defer></script>
  </body>
</html>
